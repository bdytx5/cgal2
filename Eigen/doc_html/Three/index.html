<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="canonical" href="https://doc.cgal.org/latest/Three/index.html"/>

<link rel="icon" type="image/png" href="../Manual/g-196x196-doc.png" />
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8" />
<meta http-equiv="X-UA-Compatible" content="IE=9" />
<meta name="generator" content="Doxygen 1.8.13" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>CGAL 4.13 - Three: User Manual</title>
<!-- <link href="../Manual/tabs.css" rel="stylesheet" type="text/css"/> -->
<script type="text/javascript" src="../Manual/jquery.js"></script>
<script type="text/javascript" src="../Manual/dynsections.js"></script>
<!-- Manually include treeview and search to avoid bloat and to fix
     paths to the directory Manual . -->
<!-- $.treeview -->
<!-- $.search -->
<link href="navtree.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="../Manual/resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="../Manual/search/search.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="../Manual/search/searchdata.js"></script>
<script type="text/javascript" src="../Manual/search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="../Manual/search/search.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="../Manual/search/search.js"></script>
<!-- Manually done below. -->
<link href="../Manual/stylesheet.css" rel="stylesheet" type="text/css" />
<!-- This should probably be an extrastylesheet instead of hardcoded. -->
<link href="../Manual/cgal_stylesheet.css" rel="stylesheet" type="text/css" />
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js"></script>
<script src="../Manual/hacks.js" type="text/javascript"></script>
<script src="modules.js" type="text/javascript"></script>
</head>
<body>
<!-- Custom mathjax -->
<!-- TODO: Remove this with MATHJAX_CODEFILE -->
<span style="display:none">\( \newcommand{\E}{\mathrm{E}} \) \( \newcommand{\A}{\mathrm{A}} \)
\( \newcommand{\R}{\mathrm{R}} \) \( \newcommand{\N}{\mathrm{N}} \) \( \newcommand{\Q}{\mathrm{Q}} \) \( \newcommand{\Z}{\mathrm{Z}} \)
\(
\def\ccSum #1#2#3{
  \sum_{#1}^{#2}{#3}
}
\def\ccProd #1#2#3{
  \sum_{#1}^{#2}{#3}
}\)
</span>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="back-nav">
  <ul>
    <li><a href="https://www.cgal.org/">cgal.org</a></li>
    <li><a href="../Manual/index.html">Top</a></li>
    <li><a href="../Manual/general_intro.html">Getting Started</a></li>
    <li><a href="../Manual/tutorials.html">Tutorials</a></li>
    <li><a href="../Manual/packages.html">Package Overview</a></li>
    <li><a href="../Manual/how_to_cite_cgal.html">Acknowledging CGAL</a></li>
  </ul>
  <!-- In a package SEARCHENGINE = false, so we cannot use 
       insertion. That's why we have to do it manually here. Notice
       that we also take pngs from the Manual. -->
  <div id="MSearchBox" class="MSearchBoxInactive">
    <span class="left">
      <img id="MSearchSelect" src="../Manual/search/mag_sel.png" onmouseover="return searchBox.OnSearchSelectShow()" onmouseout="return searchBox.OnSearchSelectHide()" alt="" />
      <input type="text" id="MSearchField" value="Search" accesskey="S" onfocus="searchBox.OnSearchFieldFocus(true)" onblur="searchBox.OnSearchFieldFocus(false)" onkeyup="searchBox.OnSearchFieldChange(event)" />
    </span><span class="right">
      <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../Manual/search/close.png" alt="" /></a>
    </span>
  </div>
</div>
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">CGAL 4.13 - Three
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- Code below is usually inserted by doxygen when SEARCHENGINE =
     true. Notice that the path to the search directory is adjusted to
     the top-level.-->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../Manual/search",false,'Search');
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow" onmouseover="return searchBox.OnSearchSelectShow()" onmouseout="return searchBox.OnSearchSelectHide()" onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>
<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" name="MSearchResults" id="MSearchResults">
</iframe>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync" style="display: none"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('index.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">User Manual </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="Chapter_Three"></a> </p><div id="autotoc" class="toc"></div>  <dl class="section author"><dt>Author</dt><dd>Laurent Rineau, Sebastien Loriot, Andreas Fabri, Maxime Gimeno</dd></dl>
<p>This package regroups the files making the API for creating and adding a new plugin to the Polyhedron_demo. <br />
</p>
<h1><a class="anchor" id="intro"></a>
Understanding the Polyhedron Demo</h1>
<p>There are several levels in this demo.</p>
<ul>
<li>The <code>MainWindow</code>, which contains the UI elements.</li>
<li>Among these elements is the <code>Viewer</code>, which is the drawable surface that handles all the drawing and all the keyboard and mouse events.</li>
<li>The <code>Viewer</code> has a reference to a <code><a class="el" href="classCGAL_1_1Three_1_1Scene__interface.html" title="This is the class given to the plugins to interact with the scene. ">CGAL::Three::Scene_interface</a></code>, which contains a list of all the items (the drawn elements).</li>
</ul>
<p>A plugin usually make use of objects that inherit from <code><a class="el" href="classCGAL_1_1Three_1_1Scene__item.html" title="This class represents an object in the OpenGL scene. ">CGAL::Three::Scene_item</a></code> or uses some of them to demonstrate a <span style="font-variant: small-caps;">CGAL</span> feature, so it might have to deal with the above elements.</p>
<h1><a class="anchor" id="examplePlugin"></a>
Creating a Simple Plugin</h1>
<h2><a class="anchor" id="examplePluginItself"></a>
The Plugin Itself</h2>
<p>A basic plugin will inherit from <code><a class="el" href="classCGAL_1_1Three_1_1Polyhedron__demo__plugin__interface.html" title="This virtual class provides the basic functions used for making a plugin. ">CGAL::Three::Polyhedron_demo_plugin_interface</a></code>. It must be created in the corresponding folder named after its package, and containing all the files created for the plugin, and a CMakeLists.txt file. Its name must be of the form Xxxx_yyyy_plugin. <br />
</p>
<p>The class must contain the following lines :<br />
 </p><div class="fragment"><div class="line">Q_OBJECT</div><div class="line">Q_INTERFACES(<a class="code" href="classCGAL_1_1Three_1_1Polyhedron__demo__plugin__interface.html">CGAL::Three::Polyhedron_demo_plugin_interface</a>)</div><div class="line">Q_PLUGIN_METADATA(IID <span class="stringliteral">"com.geometryfactory.PolyhedronDemo.PluginInterface/1.0"</span>)</div></div><!-- fragment --><p>Your plugin must override the three pure virtual functions inherited from Polyhedron_demo_plugin_interface : <br />
</p><ul>
<li><a class="el" href="classCGAL_1_1Three_1_1Polyhedron__demo__plugin__interface.html#a5cf5516af2b3dce023c1057d6a36c5b0">actions()</a> that will hold the actions of the plugin</li>
<li><a class="el" href="classCGAL_1_1Three_1_1Polyhedron__demo__plugin__interface.html#a9c6dc0e2cc17dc017fbc22d287265330">applicable()</a> that will decide if the plugin can be used with the current selection of items</li>
<li><a class="el" href="classCGAL_1_1Three_1_1Polyhedron__demo__plugin__interface.html#ae133715200b7bdcf756c04ec1732971e">init()</a> that will declare and link the actions of the plugin</li>
</ul>
<p>The function <a class="el" href="classCGAL_1_1Three_1_1Polyhedron__demo__plugin__interface.html#ae133715200b7bdcf756c04ec1732971e">init()</a> is used just like a constructor. This is where you will connect all the actions, signals and slots of your plugin. <br />
This is also where you will declare the submenu of Operations in which your actions will be displayed.</p>
<p>As a plugin is a QObject, it uses automoc and therefore must contain the line:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include "Xxxx_yyyy_plugin.moc"</span></div></div><!-- fragment --><p><b>Example : </b> </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;CGAL/Three/Polyhedron_demo_plugin_interface.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;QApplication&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;QObject&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;QAction&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;QMainWindow&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;QInputDialog&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;QMessageBox&gt;</span></div><div class="line"><span class="preprocessor">#include "Messages_interface.h"</span></div></div><!-- fragment --><div class="fragment"><div class="line"></div><div class="line"><span class="comment">//This plugin creates an action in Operations depending on EXAMPLE_COMPLEXITY.</span></div><div class="line"><span class="keyword">class </span>BasicPlugin :</div><div class="line">    <span class="keyword">public</span> QObject,</div><div class="line">    <span class="keyword">public</span> <a class="code" href="classCGAL_1_1Three_1_1Polyhedron__demo__plugin__interface.html">CGAL::Three::Polyhedron_demo_plugin_interface</a></div><div class="line">{</div><div class="line">  Q_OBJECT</div><div class="line">  Q_INTERFACES(<a class="code" href="classCGAL_1_1Three_1_1Polyhedron__demo__plugin__interface.html">CGAL::Three::Polyhedron_demo_plugin_interface</a>)</div><div class="line">  Q_PLUGIN_METADATA(IID <span class="stringliteral">"com.geometryfactory.PolyhedronDemo.PluginInterface/1.0"</span>)</div><div class="line"><span class="keyword">public</span>:</div><div class="line">  <span class="comment">//decides if the plugin's actions will be displayed or not.</span></div><div class="line">  <span class="keywordtype">bool</span> applicable(QAction*) <span class="keyword">const</span> Q_DECL_OVERRIDE</div><div class="line">  {</div><div class="line">    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line">  }</div><div class="line">  <span class="comment">//the list of the actions of the plugin.</span></div><div class="line">  QList&lt;QAction*&gt; actions() const Q_DECL_OVERRIDE</div><div class="line">  {</div><div class="line">    <span class="keywordflow">return</span> _actions;</div><div class="line">  }</div><div class="line">  <span class="comment">//this acts like a constructor for the plugin. It gets the references to the main window and the scene, and connects the action.</span></div><div class="line">  <span class="keywordtype">void</span> init(QMainWindow* mainWindow, <a class="code" href="classCGAL_1_1Three_1_1Scene__interface.html">CGAL::Three::Scene_interface</a>* sc, Messages_interface* mi) Q_DECL_OVERRIDE</div><div class="line">  {</div><div class="line">    <span class="comment">//gets the reference to the message interface, to display text in the console widget</span></div><div class="line">    this-&gt;messageInterface = mi;</div><div class="line">    <span class="comment">//get the references</span></div><div class="line">    this-&gt;scene = sc;</div><div class="line">    this-&gt;mw = mainWindow;</div><div class="line"></div><div class="line">    <span class="comment">//creates the action</span></div><div class="line">    QAction *actionHelloWorld= <span class="keyword">new</span> QAction(QString(<span class="stringliteral">"Hello World"</span>), mw);</div><div class="line">    <span class="comment">//specifies the subMenu</span></div><div class="line">    actionHelloWorld-&gt;setProperty(<span class="stringliteral">"submenuName"</span>, <span class="stringliteral">"Basic"</span>);</div><div class="line">    <span class="comment">//links the action</span></div><div class="line">    <span class="keywordflow">if</span>(actionHelloWorld) {</div><div class="line">      connect(actionHelloWorld, SIGNAL(triggered()),</div><div class="line">              <span class="keyword">this</span>, SLOT(helloWorld()));</div><div class="line">      _actions &lt;&lt; actionHelloWorld;</div><div class="line">    }</div><div class="line">  }</div><div class="line"><span class="keyword">private</span> Q_SLOTS:</div><div class="line"></div></div><!-- fragment --><div class="fragment"><div class="line">  <span class="keywordtype">void</span> helloWorld()</div><div class="line">  {</div><div class="line">    messageInterface-&gt;information(QString(<span class="stringliteral">"Hello World!"</span>));</div><div class="line">  }</div></div><!-- fragment --><div class="fragment"><div class="line"><span class="keyword">private</span>:</div><div class="line">  QList&lt;QAction*&gt; _actions;</div><div class="line">  Messages_interface* messageInterface;</div><div class="line">  <span class="comment">//The reference to the scene</span></div><div class="line">  <a class="code" href="classCGAL_1_1Three_1_1Scene__interface.html">CGAL::Three::Scene_interface</a>* scene;</div><div class="line">  <span class="comment">//The reference to the main window</span></div><div class="line">  QMainWindow* mw;</div><div class="line">};</div><div class="line"></div><div class="line"><span class="preprocessor">#include "Basic_plugin.moc"</span></div></div><!-- fragment --><p> Once you have written your plugin, you must add it to the project using the CMakeLists.txt file. <br />
If you created your plugin in an existing directory, the CMakeLists.txt file already exists. If you created a new directory, you must create it.</p>
<p><b>The CMakeLists.txt file :</b> </p><pre class="fragment">include( polyhedron_demo_macros )
polyhedron_demo_plugin(basic_plugin Basic_plugin)
</pre><h2><a class="anchor" id="basicPluginDialog"></a>
Adding a Dialog to Your Plugin</h2>
<p>This section describes how to add a dialog when an action is triggered.</p>
<p>For a minimalist dialog intended, for instance, to get a single parameter, you can create a <code>QInputDialog</code>:</p>
<div class="fragment"><div class="line">  <span class="keywordtype">void</span> helloWorld()</div><div class="line">  {</div><div class="line">    <span class="keywordtype">bool</span> ok = <span class="keyword">false</span>;</div><div class="line">    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> parameter =</div><div class="line">        QInputDialog::getInt((QWidget*)mw,</div><div class="line">                             tr(<span class="stringliteral">"Hello World"</span>), <span class="comment">// dialog title</span></div><div class="line">                             tr(<span class="stringliteral">"Hello dear user! What integer would you want me to display for you ? "</span>), <span class="comment">// field label</span></div><div class="line">                             10, <span class="comment">// default value = fast</span></div><div class="line">                             0, <span class="comment">// min</span></div><div class="line">                             100, <span class="comment">// max</span></div><div class="line">                             1, <span class="comment">// step</span></div><div class="line">                             &amp;ok);</div><div class="line">    <span class="keywordflow">if</span>(!ok) <span class="keywordflow">return</span>;</div><div class="line">    messageInterface-&gt;information(QString(<span class="stringliteral">"You asked me to display %1, so here it is : %1"</span>).arg(parameter));</div><div class="line">  }</div></div><!-- fragment --><p>For a more elaborate interface, you will have to use the designer tool of QtCreator. Create a new Qt Designer form (file-&gt;New file or Project-&gt;Qt-&gt;). </p><div class="image">
<img src="menu_1.png" alt="menu_1.png" />
</div>
 <div class="image">
<img src="menu_2.png" alt="menu_2.png" />
</div>
<p> Then select among the template/form choices. </p><div class="image">
<img src="menu_3.png" alt="menu_3.png" />
</div>
<p> Name it Xxxx_yyyy_dialog.ui (you may have to rename it once it is created as QtCreator tends to forget the capital letters), and add it to the project in the CMakeLists : </p><pre class="fragment">qt5_wrap_ui( basicUI_FILES Basic_dialog.ui )
polyhedron_demo_plugin(basic_plugin Basic_plugin ${basicUI_FILES})
</pre><p>Add a layout to the dialog with a drag and drop and lay it out. </p><div class="image">
<img src="menu_4.png" alt="menu_4.png" />
</div>
<p>Edit the ui file with the editor. </p><div class="image">
<img src="menu_5.png" alt="menu_5.png" />
</div>
<p> then add the following line to your plugin file: </p><div class="fragment"><div class="line"><span class="preprocessor">#include "ui_Xxxx_yyyy_plugin.h"</span></div></div><!-- fragment --><p>You can then add a new class to your cpp file, inheriting from <code>QDialog</code> and your own dialog, accessible with "Ui::". <br />
Add the macro <code>Q_OBJECT</code> and the line <code>setupUi(this)</code> in your constructor. </p><div class="fragment"><div class="line"><span class="keyword">class </span>ComplexDialog :</div><div class="line">    <span class="keyword">public</span> QDialog,</div><div class="line">    <span class="keyword">public</span> Ui::BasicDialog</div><div class="line">{</div><div class="line">  Q_OBJECT</div><div class="line"><span class="keyword">public</span>:</div><div class="line">  ComplexDialog(QWidget* =0)</div><div class="line">  {</div><div class="line">    setupUi(<span class="keyword">this</span>);</div><div class="line"></div><div class="line">  }</div><div class="line"></div><div class="line">};</div></div><!-- fragment --><p> You can populate the dialog in the action, using <code>dialog.show()</code> or <code>dialog.exec()</code>.</p>
<div class="fragment"><div class="line">  <span class="keywordtype">void</span> helloWorld()</div><div class="line">  {</div><div class="line">    <span class="comment">//creates a new dialog</span></div><div class="line">    ComplexDialog *dialog = <span class="keyword">new</span> ComplexDialog();</div><div class="line">    <span class="comment">//opens the dialog</span></div><div class="line">    <span class="keywordflow">if</span>(!dialog-&gt;exec())</div><div class="line">      <span class="keywordflow">return</span>;</div><div class="line">    QString result = dialog-&gt;lineEdit-&gt;text();</div><div class="line">    <span class="keywordtype">bool</span> ok = <span class="keyword">false</span>;</div><div class="line">    <span class="keywordtype">int</span> int_res = result.toInt(&amp;ok);</div><div class="line">    <span class="keywordflow">if</span>(!ok)</div><div class="line">    {</div><div class="line">      QMessageBox::warning(mw,</div><div class="line">                           <span class="stringliteral">"ERROR"</span>,</div><div class="line">                           tr(<span class="stringliteral">"This is not an integer !"</span>)</div><div class="line">                           );</div><div class="line">      <span class="keywordflow">return</span>;</div><div class="line">    }</div><div class="line">    messageInterface-&gt;information(QString(<span class="stringliteral">"You asked me to display %1, so here it is : %1"</span>).arg(int_res));</div><div class="line">  }</div></div><!-- fragment --> <h2><a class="anchor" id="WarningBoxDialog"></a>
Adding a Warning/Error Box to Your Plugin</h2>
<p>It is really simple to add a pop-up box with Qt. Use a QMessageBox and give it some arguments : </p><div class="fragment"><div class="line">    QString result = dialog-&gt;lineEdit-&gt;text();</div><div class="line">    <span class="keywordtype">bool</span> ok = <span class="keyword">false</span>;</div><div class="line">    <span class="keywordtype">int</span> int_res = result.toInt(&amp;ok);</div><div class="line">    <span class="keywordflow">if</span>(!ok)</div><div class="line">    {</div><div class="line">      QMessageBox::warning(mw,</div><div class="line">                           <span class="stringliteral">"ERROR"</span>,</div><div class="line">                           tr(<span class="stringliteral">"This is not an integer !"</span>)</div><div class="line">                           );</div><div class="line">      <span class="keywordflow">return</span>;</div><div class="line">    }</div></div><!-- fragment --> <h2><a class="anchor" id="examplePluginDockWidget"></a>
Adding a Dock Widget</h2>
<p>This section describes how to add a dock widget to the application.<br />
You can make your plugin inherit from <a class="el" href="classCGAL_1_1Three_1_1Polyhedron__demo__plugin__helper.html" title="Provides convenient functions for a plugin. ">CGAL::Three::Polyhedron_demo_plugin_helper</a>, which gives acces to the function <a class="el" href="classCGAL_1_1Three_1_1Polyhedron__demo__plugin__helper.html#a6ac7d37c5c9bc1d2db7bef3055fc7acf" title="Adds a dock widget to the interface. ">CGAL::Three::Polyhedron_demo_plugin_helper::addDockWidget</a>. This will manage automatically the position and tabification of a dock widget. <br />
Just like with the Dialog, create a new Qt Designer form (file-&gt;New file or Project-&gt;Qt-&gt;Qt Designer Form), choose `QDockWidget in Widgets </p><div class="image">
<img src="menu_6.png" alt="menu_6.png" />
</div>
<p> Add it to the project in the CMakeLists.txt : </p><pre class="fragment">qt5_wrap_ui( dockUI_FILES Basic_dock_widget.ui )
polyhedron_demo_plugin(dock_widget_plugin Dock_widget_plugin ${dockUI_FILES})
</pre><p>Edit the ui file with the editor, then add the following line to your plugin file: </p><div class="fragment"><div class="line"><span class="preprocessor">#include "ui_Basic_dock_widget.h"</span></div></div><!-- fragment --><p> As for the Dialog, create a new class for your widget </p><div class="fragment"><div class="line"><span class="keyword">class </span>DockWidget :</div><div class="line">    <span class="keyword">public</span> QDockWidget,</div><div class="line">    <span class="keyword">public</span> Ui::BasicDockWidget</div><div class="line">{</div><div class="line"><span class="keyword">public</span>:</div><div class="line">  DockWidget(QString name, QWidget *parent)</div><div class="line">    :QDockWidget(name,parent)</div><div class="line">  {</div><div class="line">   setupUi(<span class="keyword">this</span>);</div><div class="line">  }</div><div class="line">};</div></div><!-- fragment --><p> and add a reference to an object of this type as private members of your plugin: </p><div class="fragment"><div class="line"><span class="keyword">private</span>:</div><div class="line">  DockWidget* dock_widget;</div></div><!-- fragment --><p> and initialize it in the init function, where you will also use signal/slots to connect it to the plugin:</p>
<div class="fragment"><div class="line">  <span class="comment">//this acts like a constructor for the plugin. It gets the references to the mainwindow and the scene, and connects the action.</span></div><div class="line">  <span class="keywordtype">void</span> init(QMainWindow* mw, <a class="code" href="classCGAL_1_1Three_1_1Scene__interface.html">CGAL::Three::Scene_interface</a>* sc, Messages_interface* mi) Q_DECL_OVERRIDE</div><div class="line">  {</div><div class="line">    <span class="comment">//gets the reference to the message interface, to display text in the console widget</span></div><div class="line">    this-&gt;messageInterface = mi;</div><div class="line">    <span class="comment">//get the references</span></div><div class="line">    this-&gt;scene = sc;</div><div class="line">    this-&gt;mw = mw;</div><div class="line"></div><div class="line">    <span class="comment">//creates the action</span></div><div class="line">    QAction *actionHelloWorld= <span class="keyword">new</span> QAction(QString(<span class="stringliteral">"Open Dock Widget"</span>), mw);</div><div class="line">    <span class="comment">//specifies the subMenu</span></div><div class="line">    actionHelloWorld-&gt;setProperty(<span class="stringliteral">"submenuName"</span>, <span class="stringliteral">"Basic"</span>);</div><div class="line">    <span class="comment">//links the action</span></div><div class="line">    <span class="keywordflow">if</span>(actionHelloWorld) {</div><div class="line">      connect(actionHelloWorld, SIGNAL(triggered()),</div><div class="line">              <span class="keyword">this</span>, SLOT(helloWorld()));</div><div class="line">      _actions &lt;&lt; actionHelloWorld;</div><div class="line">    }</div><div class="line"></div><div class="line">    dock_widget = <span class="keyword">new</span> DockWidget(<span class="stringliteral">"Print a number"</span>, mw);</div><div class="line">    dock_widget-&gt;setVisible(<span class="keyword">false</span>); <span class="comment">// do not show at the beginning</span></div><div class="line"></div><div class="line">    addDockWidget(dock_widget);</div><div class="line"></div><div class="line">    connect(dock_widget-&gt;pushButton, SIGNAL(clicked(<span class="keywordtype">bool</span>)),</div><div class="line">            <span class="keyword">this</span>, SLOT(on_dock_button_clicked()));</div><div class="line">  }</div></div><!-- fragment --><p>You can use the functions <code>show()</code>/<code>hide()</code> to make your dock widget visible or not. </p><div class="fragment"><div class="line">  <span class="keywordtype">void</span> helloWorld()</div><div class="line">  {</div><div class="line">    <span class="comment">// dock widget should be instancied in init()</span></div><div class="line">    <span class="keywordflow">if</span>(dock_widget-&gt;isVisible()) { dock_widget-&gt;hide(); }</div><div class="line">    <span class="keywordflow">else</span>                         { dock_widget-&gt;show(); }</div><div class="line">  }</div><div class="line"></div><div class="line">  <span class="keywordtype">void</span> on_dock_button_clicked()</div><div class="line">  {</div><div class="line">      messageInterface-&gt;information(QString(<span class="stringliteral">"Here is your number :%1"</span>).arg(dock_widget-&gt;spinBox-&gt;value()));</div><div class="line"></div><div class="line">  }</div></div><!-- fragment --><p> By default, a dock widget will remain visible next time the demo is launched if it has not been closed. If you want to avoid that behavior, override the function <code>closure()</code> in you plugin, and simply call <code>hide()</code> on your dock widget in it. </p><div class="fragment"><div class="line">  <span class="keywordtype">void</span> closure()Q_DECL_OVERRIDE</div><div class="line">  {</div><div class="line">    dock_widget-&gt;hide();</div><div class="line">  }</div></div><!-- fragment --> <h2><a class="anchor" id="exampleUsingAnItem"></a>
Using a Scene_item</h2>
<h3><a class="anchor" id="exampleUsingASelectedItem"></a>
Using an existing item</h3>
<p>You can get a reference to the items present in the scene in your plugin. To do so, you will need to use the reference to the scene that you can get in the <a class="el" href="classCGAL_1_1Three_1_1Polyhedron__demo__plugin__interface.html#ae133715200b7bdcf756c04ec1732971e">init()</a> function : </p><div class="fragment"><div class="line"><span class="keywordtype">void</span> init(QMainWindow* mainWindow, <a class="code" href="classCGAL_1_1Three_1_1Scene__interface.html">CGAL::Three::Scene_interface</a>* sc  )</div><div class="line">{</div><div class="line">  <span class="comment">//get the references</span></div><div class="line">  this-&gt;scene = sc;</div><div class="line">}</div></div><!-- fragment --><p> This Scene_interface will give you access to the following functions :</p><ul>
<li><a class="el" href="classCGAL_1_1Three_1_1Scene__interface.html#a08565259baefb42241060285689c7197">mainSelectionIndex()</a></li>
<li><a class="el" href="classCGAL_1_1Three_1_1Scene__interface.html#a7983fecaaf2d05ceafecbc483f809b51">selectionIndices()</a></li>
<li><a class="el" href="classCGAL_1_1Three_1_1Scene__interface.html#a1e03431e194b7598fc053ceec35fe24d">item()</a></li>
<li><a class="el" href="classCGAL_1_1Three_1_1Scene__interface.html#a7c64ef901d51f90dd4fe17a815ec97a9">item_id()</a></li>
</ul>
<p>that give you access to any item in the scene.</p>
<p>Example of use : </p><div class="fragment"><div class="line">    <span class="comment">//get a reference to the selected item.</span></div><div class="line">    <a class="code" href="classCGAL_1_1Three_1_1Scene__item.html">CGAL::Three::Scene_item</a> *item = scene-&gt;item(scene-&gt;mainSelectionIndex());</div><div class="line">    messageInterface-&gt;information(QString(<span class="stringliteral">"The selected item's name is  : %1"</span>).arg(item-&gt;name()));</div></div><!-- fragment --><p> Don't forget to adapt your <a class="el" href="classCGAL_1_1Three_1_1Polyhedron__demo__plugin__interface.html#a9c6dc0e2cc17dc017fbc22d287265330">applicable()</a> function : </p><div class="fragment"><div class="line">  <span class="comment">//This plugin is only applicable if there is exactly one selected item.</span></div><div class="line">  <span class="keywordtype">bool</span> applicable(QAction*) <span class="keyword">const</span> Q_DECL_OVERRIDE</div><div class="line">  {</div><div class="line">    <span class="keywordflow">return</span> scene-&gt;selectionIndices().size() ==1;</div><div class="line">  }</div></div><!-- fragment --> <h3><a class="anchor" id="exampleCreatingAnItem"></a>
Creating an item of an existing type</h3>
<p>You might want your plugin to create a new item. This is possible thanks to the scene.</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> init(QMainWindow* mainWindow, <a class="code" href="classCGAL_1_1Three_1_1Scene__interface.html">CGAL::Three::Scene_interface</a>* sc  )</div><div class="line">{</div><div class="line">  <span class="comment">//get the references</span></div><div class="line">  this-&gt;scene = sc;</div><div class="line">}</div></div><!-- fragment --><p>Simply create a new instance of the item you want and call the function <a class="el" href="classCGAL_1_1Three_1_1Scene__interface.html#a7373a0da1155443122239b69d38409fd" title="Adds an item to the Geometric Objects list. ">CGAL::Three::Scene_interface::addItem</a> :</p>
<div class="fragment"><div class="line">    <span class="comment">//creates a plane item</span></div><div class="line">    Scene_plane_item *new_item = <span class="keyword">new</span> Scene_plane_item(scene);</div><div class="line">    new_item-&gt;setName(<span class="stringliteral">"Trivial Plane"</span>);</div><div class="line">    new_item-&gt;setColor(Qt::blue);</div><div class="line">    new_item-&gt;setNormal(0.0,0.0,1.0);</div><div class="line">    scene-&gt;addItem(new_item);</div></div><!-- fragment --><p>Once your code is written, you will need to link the item's library to your plugin thanks to the CMakeLists, using the command <b>target_link_library</b> : </p><pre class="fragment">polyhedron_demo_plugin(basic_item_plugin Basic_item_plugin)
#  links the library containing the scene_plane_item with the plugin
target_link_libraries(basic_item_plugin scene_basic_objects)
</pre><h3><a class="anchor" id="exampleCreatingANewTypeItem"></a>
Creating a new type of item</h3>
<p>If you cannot use an existing type of item, like the Scene_polyhedron_item or the Scene_c3t3_item for your plugin, you will have to create one, by deriving <a class="el" href="classCGAL_1_1Three_1_1Scene__item.html" title="This class represents an object in the OpenGL scene. ">CGAL::Three::Scene_item</a>.<br />
An item is simply a graphic representation of a geometric data set. You need to compute this data, and to display it in <a class="el" href="classCGAL_1_1Three_1_1Scene__item.html#a884cc1ab209133f3a615ceda7e566a74" title="Deprecated. Does nothing. ">CGAL::Three::Scene_item::draw</a>.</p>
<div class="fragment"><div class="line"><span class="comment">// The special Scene_item only for triangles</span></div><div class="line"></div><div class="line"><span class="comment">//this is used by the Qt's MOC system to manage the metadata.</span></div><div class="line"><span class="preprocessor">#ifdef scene_triangle_item_EXPORTS</span></div><div class="line"><span class="preprocessor">#  define SCENE_TRIANGLE_ITEM_EXPORT Q_DECL_EXPORT</span></div><div class="line"><span class="preprocessor">#else</span></div><div class="line"><span class="preprocessor">#  define SCENE_TRIANGLE_ITEM_EXPORT Q_DECL_IMPORT</span></div><div class="line"><span class="preprocessor">#endif</span></div><div class="line"></div><div class="line"><span class="keyword">class </span>Scene_triangle_item : <span class="keyword">public</span> <a class="code" href="classCGAL_1_1Three_1_1Scene__item.html">CGAL::Three::Scene_item</a></div><div class="line">{</div><div class="line"></div><div class="line">  Q_OBJECT</div><div class="line">public :</div><div class="line">  Scene_triangle_item(<span class="keywordtype">double</span> ax,<span class="keywordtype">double</span> ay, <span class="keywordtype">double</span> az,</div><div class="line">                      <span class="keywordtype">double</span> bx,<span class="keywordtype">double</span> by, <span class="keywordtype">double</span> bz,</div><div class="line">                      <span class="keywordtype">double</span> cx,<span class="keywordtype">double</span> cy, <span class="keywordtype">double</span> cz);</div><div class="line"></div><div class="line">  <span class="comment">// Indicates if rendering mode is supported</span></div><div class="line">  <span class="keywordtype">bool</span> supportsRenderingMode(<a class="code" href="group__PkgThree.html#ga87cafe63badc45546f2eb940f2a94d70">RenderingMode</a> m) <span class="keyword">const</span> Q_DECL_OVERRIDE {</div><div class="line">    <span class="keywordflow">return</span> (m == <a class="code" href="group__PkgThree.html#gga87cafe63badc45546f2eb940f2a94d70a5a9e3347876551cd38b961213ff1ccde">Flat</a>);</div><div class="line">  }</div><div class="line"></div><div class="line">  <span class="comment">//Displays the item</span></div><div class="line">  <span class="keywordtype">void</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Polyhedron.tag:../Polyhedron/" href="../Polyhedron/group__PkgDrawPolyhedron.html#ga3ca458ed11c9fb052476b00227d93584">draw</a>(<a class="code" href="classCGAL_1_1Three_1_1Viewer__interface.html">CGAL::Three::Viewer_interface</a>* viewer) <span class="keyword">const</span> Q_DECL_OVERRIDE;</div><div class="line"></div><div class="line">  <span class="comment">//Specifies that the buffers need to be initialized again.</span></div><div class="line">  <span class="comment">//Is mostly called after a change of geometry in the data.</span></div><div class="line">  <span class="keywordtype">void</span> invalidateOpenGLBuffers() Q_DECL_OVERRIDE;</div><div class="line"></div><div class="line">  <span class="comment">//fills the std::vector</span></div><div class="line">  <span class="keywordtype">void</span> computeElements(<span class="keywordtype">double</span> ax,<span class="keywordtype">double</span> ay, <span class="keywordtype">double</span> az,</div><div class="line">                        <span class="keywordtype">double</span> bx,<span class="keywordtype">double</span> by, <span class="keywordtype">double</span> bz,</div><div class="line">                        <span class="keywordtype">double</span> cx,<span class="keywordtype">double</span> cy, <span class="keywordtype">double</span> cz) const Q_DECL_OVERRIDE;</div><div class="line"></div><div class="line">  Scene_item* clone() const Q_DECL_OVERRIDE {<span class="keywordflow">return</span> 0;}</div><div class="line">  QString toolTip() const Q_DECL_OVERRIDE {<span class="keywordflow">return</span> QString();}</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">private</span>:</div><div class="line">  <span class="comment">//contains the data</span></div><div class="line">  <span class="keyword">mutable</span> std::vector&lt;float&gt; vertices;</div><div class="line">  <span class="keyword">mutable</span> <span class="keywordtype">int</span> nb_pos;</div><div class="line">  <span class="keyword">mutable</span> QOpenGLShaderProgram *program;</div><div class="line">  <span class="keyword">using</span> <a class="code" href="classCGAL_1_1Three_1_1Scene__item.html#a216833a5b2c7b82e7ae23ad4bd3684cb">CGAL::Three::Scene_item::initializeBuffers</a>;</div><div class="line">  <span class="comment">//Fills the buffers with data. The buffers allow us to give data to the shaders.</span></div><div class="line">  <span class="keywordtype">void</span> initializeBuffers(<a class="code" href="classCGAL_1_1Three_1_1Viewer__interface.html">CGAL::Three::Viewer_interface</a> *viewer)<span class="keyword">const</span> Q_DECL_OVERRIDE;</div><div class="line">}; <span class="comment">//end of class Scene_triangle_item</span></div></div><!-- fragment --><p> The minimalist item above is designed to draw a simple triangle. There are several steps that need to be followed when creating an item :</p>
<p><b> - Computing the data </b></p>
<p>One way to store the data you computed is to use member std::vector. It must be done every time a change occurs in the item's geometry (usually done in a function called invalidateOpenGLBuffers).</p>
<div class="fragment"><div class="line"><span class="comment">//Fills the position vector with data.</span></div><div class="line"><span class="keywordtype">void</span> Scene_triangle_item::computeElements(<span class="keywordtype">double</span> ax, <span class="keywordtype">double</span> ay, <span class="keywordtype">double</span> az,</div><div class="line">                                           <span class="keywordtype">double</span> bx, <span class="keywordtype">double</span> by, <span class="keywordtype">double</span> bz,</div><div class="line">                                           <span class="keywordtype">double</span> cx, <span class="keywordtype">double</span> cy, <span class="keywordtype">double</span> cz)<span class="keyword">const</span></div><div class="line"><span class="keyword"></span>{</div><div class="line">  vertices.resize(9);</div><div class="line">  vertices[0] = ax; vertices[1] = ay; vertices[2] = az;</div><div class="line">  vertices[3] = bx; vertices[4] = by; vertices[5] = bz;</div><div class="line">  vertices[6] = cx; vertices[7] = cy; vertices[8] = cz;</div><div class="line">}</div><div class="line"></div></div><!-- fragment --><p> <b> - Filling the OpenGL buffers </b></p>
<p>The application uses OpenGL VBOs to display the geometry. Those are buffers that will stream their data to the GPU. This step consists to put the data stored in the std::vector in those buffers. In this exemple, we only need one VBO and one VAO, as we are only storing one kind of data. But if we wanted to store normals and colors, for instance, we would need as much VBOs, and if there were several types of display, let's say multiple RenderingMode, we would need as much VAOs. (See OpenGL doc about VBOs/VAOs for more details).</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> Scene_triangle_item::initializeBuffers(<a class="code" href="classCGAL_1_1Three_1_1Viewer__interface.html">CGAL::Three::Viewer_interface</a> *viewer)<span class="keyword">const</span></div><div class="line"><span class="keyword"></span>{</div><div class="line"></div><div class="line">  <span class="comment">//vao containing the data for the facets</span></div><div class="line">  {</div><div class="line">    program = getShaderProgram(PROGRAM_WITH_LIGHT, viewer);</div><div class="line">    program-&gt;bind();</div><div class="line"></div><div class="line">    vaos[0]-&gt;bind();</div><div class="line">    buffers[0].bind();</div><div class="line">    buffers[0].allocate(vertices.data(),</div><div class="line">                        <span class="keyword">static_cast&lt;</span>GLsizei<span class="keyword">&gt;</span>(vertices.size()*<span class="keyword">sizeof</span>(float)));</div><div class="line">    program-&gt;enableAttributeArray(<span class="stringliteral">"vertex"</span>);</div><div class="line">    program-&gt;setAttributeBuffer(<span class="stringliteral">"vertex"</span>,GL_FLOAT,0,3);</div><div class="line">    buffers[0].release();</div><div class="line"></div><div class="line">    vaos[0]-&gt;release();</div><div class="line">    program-&gt;release();</div><div class="line"></div><div class="line">  }</div><div class="line"></div><div class="line"><span class="comment">//once the buffers are fill, we can empty the vectors to optimize memory consumption</span></div><div class="line">  nb_pos = vertices.size();</div><div class="line">  vertices.resize(0);</div><div class="line">  <span class="comment">//"Swap trick" insures that the memory is indeed freed and not kept available</span></div><div class="line">  std::vector&lt;float&gt;(vertices).swap(vertices);</div><div class="line">  are_buffers_filled = <span class="keyword">true</span>;</div><div class="line">}</div></div><!-- fragment --><p> The code above gets a ShaderProgram, that holds the characteristics of the display (here a basic lighting), binds its VAO and VBO and gives it the data.</p>
<p><b> - Displaying the data </b></p>
<p>Originally, it's the viewer that requires displaying. It calls the scene, that calls each visible item's <a class="el" href="classCGAL_1_1Three_1_1Scene__item.html#a884cc1ab209133f3a615ceda7e566a74">draw()</a>,<a class="el" href="classCGAL_1_1Three_1_1Scene__item.html#a9f9c6fbb1eab8b063c083ea61830436c">drawEdges()</a> and <a class="el" href="classCGAL_1_1Three_1_1Scene__item.html#a0b5bec42c1569625c42294af492e0a89">drawPoints()</a> functions individually. Therefore, this is in those functions that the display of the data must be handled :</p>
<div class="fragment"><div class="line"></div><div class="line"><span class="keywordtype">void</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Polyhedron.tag:../Polyhedron/" href="../Polyhedron/group__PkgDrawPolyhedron.html#ga3ca458ed11c9fb052476b00227d93584">Scene_triangle_item::draw</a>(<a class="code" href="classCGAL_1_1Three_1_1Viewer__interface.html">CGAL::Three::Viewer_interface</a>* viewer)<span class="keyword"> const</span></div><div class="line"><span class="keyword"></span>{</div><div class="line">  <span class="comment">//The filling of the buffers should be performed in this function, because it needs a valid openGL context, and we are certain to have one in this function.</span></div><div class="line">  <span class="keywordflow">if</span>(!are_buffers_filled)</div><div class="line">  {</div><div class="line">    computeElements(0, 0, 0,</div><div class="line">                     1, 0, 0,</div><div class="line">                     0.5, 0.5, 0);</div><div class="line">    initializeBuffers(viewer);</div><div class="line">  }</div><div class="line">  <span class="comment">//Binds the vao corresponding to the type of data we are drawing.</span></div><div class="line">  vaos[0]-&gt;bind();</div><div class="line">  <span class="comment">//Gets the program corresponding to the type of data we are drawing.</span></div><div class="line">  <span class="comment">//Here we want triangles with light effects.</span></div><div class="line">  program = getShaderProgram(PROGRAM_WITH_LIGHT);</div><div class="line">  <span class="comment">//Gives most of the uniform values to the shaders.</span></div><div class="line">  attribBuffers(viewer, PROGRAM_WITH_LIGHT);</div><div class="line">  <span class="comment">//Binds the program chosen before to use the right shaders.</span></div><div class="line">  program-&gt;bind();</div><div class="line">  <span class="comment">//Gives the wanted color to the fragment shader as uniform value.</span></div><div class="line">  program-&gt;setAttributeValue(<span class="stringliteral">"colors"</span>, this-&gt;color());</div><div class="line">  <span class="comment">//Draws the items</span></div><div class="line">  viewer-&gt;glDrawArrays(GL_TRIANGLES, 0, static_cast&lt;GLsizei&gt;(nb_pos/3));</div><div class="line">  <span class="comment">//clean up</span></div><div class="line">  vaos[0]-&gt;release();</div><div class="line">  program-&gt;release();</div><div class="line"></div><div class="line">}</div></div><!-- fragment --><p> To display, you need to call the same program that got configured previously, and to bind it before you call the OpenGL drawing function. <br />
If you created your item in a specific file and you need to use it outside your plugin (like in another plugin), it is recommended to put it in the demo's root directory, and you will have to define your item in the general Polyhedron_demo's CMakeLists.txt by using the macro add_item : </p><pre class="fragment">add_item(scene_trivial_item Scene_trivial_item.cpp)
target_link_libraries(scene_trivial_item scene_dependances_item)
</pre><h2><a class="anchor" id="exampleUsingAGroupItem"></a>
Using a Scene_group_item</h2>
<p>This section will explain how to use a group item in a plugin.</p>
<p>A group item is a virtual item that is not seen in the viewer, nor drawn, but acts as a parent for a list of actual items. Its main goal lies within the interaction with the <code>SceneView</code> (which is the list of items on the left of the viewer). With group items, this view becomes hierarchic, which allows to interact with several objects at the same time, and organize this view.</p>
<p>To use a group item in your plugin, you will need a <code><a class="el" href="classCGAL_1_1Three_1_1Scene__group__item.html" title="A Scene_group_item is a special Scene_item that does not draw anything, but regroups other items as i...">CGAL::Three::Scene_group_item</a></code>, of course, and a <code><a class="el" href="classCGAL_1_1Three_1_1Scene__interface.html" title="This is the class given to the plugins to interact with the scene. ">CGAL::Three::Scene_interface</a></code>.<br />
 Create a new <code>Scene_group_item</code>, add it to the scene with <code><a class="el" href="classCGAL_1_1Three_1_1Scene__interface.html#a7373a0da1155443122239b69d38409fd" title="Adds an item to the Geometric Objects list. ">CGAL::Three::Scene_interface::addItem()</a></code> and give it the items you want to regroup with <code><a class="el" href="classCGAL_1_1Three_1_1Scene__interface.html#acac2c469852a07791156a1a5072f2cbd" title="Moves item to the targeted group. ">CGAL::Three::Scene_interface::changeGroup()</a></code>.<br />
 Keep in mind that you must pass items to a group only if those items are already in the scene.<br />
You also have the possibility to "lock" a child of a group with <code><a class="el" href="classCGAL_1_1Three_1_1Scene__group__item.html#a18e02de98e6ca40586f91e5adbfda083" title="Locks a child. ">CGAL::Three::Scene_group_item::lockChild()</a></code> to prevent it from being moved or erased.</p>
<div class="fragment"><div class="line">    <span class="comment">//Create a new group</span></div><div class="line">    Scene_group_item *group = <span class="keyword">new</span> Scene_group_item(<span class="stringliteral">"New group"</span>);</div><div class="line">    <span class="comment">//add it to the scene</span></div><div class="line">    scene-&gt;addItem(group);</div><div class="line">    <span class="comment">//Then give it its children</span></div><div class="line">    scene-&gt;changeGroup(item, group);</div><div class="line">    scene-&gt;changeGroup(new_item,group);</div></div><!-- fragment --> <h1><a class="anchor" id="exampleIOPlugin"></a>
Creating an IO Plugin</h1>
<p>An <a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Stream_support.tag:../Stream_support/" href="../Stream_support/namespaceCGAL_1_1IO.html">IO</a> plugin is a plugin desined to load from and save to a certain type of file. Its name is generally of the form Xxxx_yyyy_io_plugin <br />
It inherits from the <a class="el" href="classCGAL_1_1Three_1_1Polyhedron__demo__io__plugin__interface.html" title="This class provides a base for creating a new IO plugin. ">CGAL::Three::Polyhedron_demo_io_plugin_interface</a>. It must implement the following functions :</p><ul>
<li><a class="el" href="classCGAL_1_1Three_1_1Polyhedron__demo__io__plugin__interface.html#a6f2791a4c8bfe7bee3b1f2aba0ad23b6" title="Returns the name of the plugin It is used by the loading system. ">CGAL::Three::Polyhedron_demo_io_plugin_interface::name</a> which returns the plugin's name. <div class="fragment"><div class="line">QString name()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <span class="stringliteral">"Xxxx_yyyy_io_plugin"</span>; }</div></div><!-- fragment --></li>
<li><a class="el" href="classCGAL_1_1Three_1_1Polyhedron__demo__io__plugin__interface.html#a35b762222ba57217fe2b367ba777e4e8" title="The filters for the names of the files that can be used by the plugin. ">CGAL::Three::Polyhedron_demo_io_plugin_interface::nameFilters</a> which returns a list of extensions of the files the plugin can read : <div class="fragment"><div class="line">QString nameFilters()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <span class="stringliteral">"Text files (*.txt)"</span>; }</div></div><!-- fragment --></li>
<li><a class="el" href="classCGAL_1_1Three_1_1Polyhedron__demo__io__plugin__interface.html#a2905241376ff11ac14f99e069a4fcef6" title="Specifies if the io_plugin is able to load an item or not. ">CGAL::Three::Polyhedron_demo_io_plugin_interface::canLoad</a> which returns true if the plugin is able to load : <div class="fragment"><div class="line"><span class="keywordtype">bool</span> canLoad()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <span class="keyword">true</span>; }</div></div><!-- fragment --></li>
<li><a class="el" href="classCGAL_1_1Three_1_1Polyhedron__demo__io__plugin__interface.html#a942e883f6d0889c2a38d348bb2eaaede" title="Loads an item from a file. ">CGAL::Three::Polyhedron_demo_io_plugin_interface::load</a> : which fills the data of an object from a file : <div class="fragment"><div class="line"><a class="code" href="classCGAL_1_1Three_1_1Scene__item.html">CGAL::Three::Scene_item</a>* load(QFileInfo fileinfo) {</div><div class="line">    <span class="keywordflow">if</span>(fileinfo.suffix().toLower() != <span class="stringliteral">"txt"</span>) <span class="keywordflow">return</span> 0;</div><div class="line">    Scene_trivial_item* item = <span class="keyword">new</span> Scene_trivial_item();</div><div class="line">    <span class="keywordflow">if</span>(!item-&gt;load(fileinfo.filePath().toStdString())) {</div><div class="line">        <span class="keyword">delete</span> item;</div><div class="line">        <span class="keywordflow">return</span> NULL;</div><div class="line">    }</div><div class="line">    <span class="keywordflow">return</span> item;</div><div class="line">}</div></div><!-- fragment --></li>
<li><a class="el" href="classCGAL_1_1Three_1_1Polyhedron__demo__io__plugin__interface.html#ac8ca848fb2268358ce34c1a3a41df878" title="Specifies if the io_plugin can save the item or not. ">CGAL::Three::Polyhedron_demo_io_plugin_interface::canSave</a> which returns true if the plugin is able to save : <div class="fragment"><div class="line"><span class="keywordtype">bool</span> canSave(<span class="keyword">const</span> <a class="code" href="classCGAL_1_1Three_1_1Scene__item.html">CGAL::Three::Scene_item</a>* scene_item) {</div><div class="line">    <span class="keywordflow">return</span> qobject_cast&lt;<span class="keyword">const</span> Scene_trivial_item*&gt;(scene_item);</div><div class="line">}</div></div><!-- fragment --></li>
<li><a class="el" href="classCGAL_1_1Three_1_1Polyhedron__demo__io__plugin__interface.html#aab65f38815acf558583f3f7f56921ba8" title="Saves the item in the file corresponding to the path contained in fileinfo. ">CGAL::Three::Polyhedron_demo_io_plugin_interface::save</a> which fills a file with the data of an item <div class="fragment"><div class="line"><span class="keywordtype">bool</span> save(<span class="keyword">const</span> <a class="code" href="classCGAL_1_1Three_1_1Scene__item.html">CGAL::Three::Scene_item</a>* scene_item, QFileInfo fileinfo) {</div><div class="line">    <span class="keyword">const</span> Scene_trivial_item* item = qobject_cast&lt;<span class="keyword">const</span> Scene_trivial_item*&gt;(scene_item);</div><div class="line">    <span class="keywordflow">if</span>(item == NULL) { <span class="keywordflow">return</span> <span class="keyword">false</span>; }</div><div class="line"></div><div class="line">    <span class="keywordflow">return</span> item-&gt;save(fileinfo.filePath().toStdString());</div><div class="line">}</div></div><!-- fragment --></li>
</ul>
<h1><a class="anchor" id="exampleexternalPlugin"></a>
Creating an External Plugin</h1>
<p>An external plugin is a plugin that is written in any directory but the official Plugin directory, and which will not be automatically loaded along with the others. To create an external plugin, you must make a new Cmake project.<br />
</p><pre class="fragment">project( Example_plugin )
</pre><p>Configure CMake as you desire and fetch the right Qt5 packages : </p><pre class="fragment"># Find includes in corresponding build directories
set(CMAKE_INCLUDE_CURRENT_DIR ON)
# Instruct CMake to run moc automatically when needed.
set(CMAKE_AUTOMOC ON)
cmake_minimum_required(VERSION 3.1)

#Find CGAL
find_package(CGAL COMPONENTS Qt5)
include( ${CGAL_USE_FILE} )
# Find Qt5 itself
find_package(Qt5
             QUIET
             COMPONENTS            OpenGL Script Svg Xml
             OPTIONAL_COMPONENTS   ScriptTools)
</pre><p>You will probably have to fetch the libraries exported by the Polyhedron_demo, like the Scene_items. </p><pre class="fragment">find_package(CGAL_polyhedron_demo
HINTS "${CGAL_DIR}" "${CGAL_DIR}/Polyhedron/demo/Polyhedron-build"
)
include( ${CGAL_POLYHEDRON_DEMO_USE_FILE} )
</pre><p>Finally, you can declare your plugin </p><pre class="fragment">polyhedron_demo_plugin(example_plugin Example_plugin)
</pre><p>If you need targets from the Polyhedron_demo, you will have to add the prefix 'Polyhedron_' to the target's name, as the exported targets belong to the namespace Polyhedron_ </p><pre class="fragment">polyhedron_demo_plugin(basic_item_plugin Basic_item_plugin)
target_link_libraries(basic_item_plugin Polyhedron_scene_basic_objects)
</pre><p>Notice that an external plugin will not be automatically loaded in the Polyhedron demo. It must be built in its own project.</p>
<p><b> Complete CMakeLists :</b></p>
<pre class="fragment">project( Example_plugin )
# Find includes in corresponding build directories
set(CMAKE_INCLUDE_CURRENT_DIR ON)
# Instruct CMake to run moc automatically when needed.
set(CMAKE_AUTOMOC ON)
cmake_minimum_required(VERSION 3.1)

#Find CGAL
find_package(CGAL COMPONENTS Qt5)
include( ${CGAL_USE_FILE} )
# Find Qt5 itself
find_package(Qt5
             QUIET
             COMPONENTS            OpenGL Script Svg Xml
             OPTIONAL_COMPONENTS   ScriptTools)

if(Qt5_FOUND AND CGAL_FOUND)
  find_package(CGAL_polyhedron_demo)

include( ${CGAL_POLYHEDRON_DEMO_USE_FILE} )
# Let plugins be compiled in the same directory as the executable.
set(CMAKE_LIBRARY_OUTPUT_DIRECTORY "${CMAKE_RUNTIME_OUTPUT_DIRECTORY}")


  polyhedron_demo_plugin(example_plugin Example_plugin)

endif()
</pre><h1><a class="anchor" id="example"></a>
Examples</h1>
<p>All the examples have been constructed as external plugins in CGAL/Three/demo/Three/Example_plugin. You will have to use "Load plugin" in the File menu if you want to test it. </p>
<h2><a class="anchor" id="example1"></a>
Creating a Basic Plugin</h2>
<p><br />
<b>File</b> <a class="el" href="Three_2Example_plugin_2Basic_plugin_8cpp-example.html">Three/Example_plugin/Basic_plugin.cpp</a> </p><div class="fragment"><div class="line"><span class="comment">/*</span></div><div class="line"><span class="comment">Change the value of EXAMPLE_COMPLEXITY in the first line to change the behavior :</span></div><div class="line"><span class="comment">  - 0 : prints "Hello World!" in the Info and console widgets</span></div><div class="line"><span class="comment">  - 1 : pops-up a simple dialog asking to enter an integer , then prints it in the Info and console widgets</span></div><div class="line"><span class="comment">  - 2 : pops-up a little more elaborated dialog asking to enter an integer , then prints it in the Info and console widgets if it was indeed an integer, else pops-up an error message box.</span></div><div class="line"><span class="comment">  */</span></div><div class="line"><span class="preprocessor">#define EXAMPLE_COMPLEXITY 0</span></div><div class="line"><span class="preprocessor">#include "ui_Basic_dialog.h"</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Three/Polyhedron_demo_plugin_interface.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;QApplication&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;QObject&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;QAction&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;QMainWindow&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;QInputDialog&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;QMessageBox&gt;</span></div><div class="line"><span class="preprocessor">#include "Messages_interface.h"</span></div><div class="line"><span class="keyword">class </span>ComplexDialog :</div><div class="line">    <span class="keyword">public</span> QDialog,</div><div class="line">    <span class="keyword">public</span> Ui::BasicDialog</div><div class="line">{</div><div class="line">  Q_OBJECT</div><div class="line"><span class="keyword">public</span>:</div><div class="line">  ComplexDialog(QWidget* =0)</div><div class="line">  {</div><div class="line">    setupUi(<span class="keyword">this</span>);</div><div class="line"></div><div class="line">  }</div><div class="line"></div><div class="line">};</div><div class="line"></div><div class="line"><span class="comment">//This plugin creates an action in Operations depending on EXAMPLE_COMPLEXITY.</span></div><div class="line"><span class="keyword">class </span>BasicPlugin :</div><div class="line">    <span class="keyword">public</span> QObject,</div><div class="line">    <span class="keyword">public</span> <a class="code" href="classCGAL_1_1Three_1_1Polyhedron__demo__plugin__interface.html">CGAL::Three::Polyhedron_demo_plugin_interface</a></div><div class="line">{</div><div class="line">  Q_OBJECT</div><div class="line">  Q_INTERFACES(<a class="code" href="classCGAL_1_1Three_1_1Polyhedron__demo__plugin__interface.html">CGAL::Three::Polyhedron_demo_plugin_interface</a>)</div><div class="line">  Q_PLUGIN_METADATA(IID <span class="stringliteral">"com.geometryfactory.PolyhedronDemo.PluginInterface/1.0"</span>)</div><div class="line"><span class="keyword">public</span>:</div><div class="line">  <span class="comment">//decides if the plugin's actions will be displayed or not.</span></div><div class="line">  <span class="keywordtype">bool</span> applicable(QAction*) <span class="keyword">const</span> Q_DECL_OVERRIDE</div><div class="line">  {</div><div class="line">    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line">  }</div><div class="line">  <span class="comment">//the list of the actions of the plugin.</span></div><div class="line">  QList&lt;QAction*&gt; actions() const Q_DECL_OVERRIDE</div><div class="line">  {</div><div class="line">    <span class="keywordflow">return</span> _actions;</div><div class="line">  }</div><div class="line">  <span class="comment">//this acts like a constructor for the plugin. It gets the references to the main window and the scene, and connects the action.</span></div><div class="line">  <span class="keywordtype">void</span> init(QMainWindow* mainWindow, <a class="code" href="classCGAL_1_1Three_1_1Scene__interface.html">CGAL::Three::Scene_interface</a>* sc, Messages_interface* mi) Q_DECL_OVERRIDE</div><div class="line">  {</div><div class="line">    <span class="comment">//gets the reference to the message interface, to display text in the console widget</span></div><div class="line">    this-&gt;messageInterface = mi;</div><div class="line">    <span class="comment">//get the references</span></div><div class="line">    this-&gt;scene = sc;</div><div class="line">    this-&gt;mw = mainWindow;</div><div class="line"></div><div class="line">    <span class="comment">//creates the action</span></div><div class="line">    QAction *actionHelloWorld= <span class="keyword">new</span> QAction(QString(<span class="stringliteral">"Hello World"</span>), mw);</div><div class="line">    <span class="comment">//specifies the subMenu</span></div><div class="line">    actionHelloWorld-&gt;setProperty(<span class="stringliteral">"submenuName"</span>, <span class="stringliteral">"Basic"</span>);</div><div class="line">    <span class="comment">//links the action</span></div><div class="line">    <span class="keywordflow">if</span>(actionHelloWorld) {</div><div class="line">      connect(actionHelloWorld, SIGNAL(triggered()),</div><div class="line">              <span class="keyword">this</span>, SLOT(helloWorld()));</div><div class="line">      _actions &lt;&lt; actionHelloWorld;</div><div class="line">    }</div><div class="line">  }</div><div class="line"><span class="keyword">private</span> Q_SLOTS:</div><div class="line"></div><div class="line"><span class="preprocessor">#if EXAMPLE_COMPLEXITY == 0</span></div><div class="line">  <span class="keywordtype">void</span> helloWorld()</div><div class="line">  {</div><div class="line">    messageInterface-&gt;information(QString(<span class="stringliteral">"Hello World!"</span>));</div><div class="line">  }</div><div class="line"><span class="preprocessor">#elif EXAMPLE_COMPLEXITY == 1</span></div><div class="line">  <span class="keywordtype">void</span> helloWorld()</div><div class="line">  {</div><div class="line">    <span class="keywordtype">bool</span> ok = <span class="keyword">false</span>;</div><div class="line">    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> parameter =</div><div class="line">        QInputDialog::getInt((QWidget*)mw,</div><div class="line">                             tr(<span class="stringliteral">"Hello World"</span>), <span class="comment">// dialog title</span></div><div class="line">                             tr(<span class="stringliteral">"Hello dear user! What integer would you want me to display for you ? "</span>), <span class="comment">// field label</span></div><div class="line">                             10, <span class="comment">// default value = fast</span></div><div class="line">                             0, <span class="comment">// min</span></div><div class="line">                             100, <span class="comment">// max</span></div><div class="line">                             1, <span class="comment">// step</span></div><div class="line">                             &amp;ok);</div><div class="line">    <span class="keywordflow">if</span>(!ok) <span class="keywordflow">return</span>;</div><div class="line">    messageInterface-&gt;information(QString(<span class="stringliteral">"You asked me to display %1, so here it is : %1"</span>).arg(parameter));</div><div class="line">  }</div><div class="line"><span class="preprocessor">#elif EXAMPLE_COMPLEXITY == 2</span></div><div class="line">  <span class="keywordtype">void</span> helloWorld()</div><div class="line">  {</div><div class="line">    <span class="comment">//creates a new dialog</span></div><div class="line">    ComplexDialog *dialog = <span class="keyword">new</span> ComplexDialog();</div><div class="line">    <span class="comment">//opens the dialog</span></div><div class="line">    <span class="keywordflow">if</span>(!dialog-&gt;exec())</div><div class="line">      <span class="keywordflow">return</span>;</div><div class="line">    QString result = dialog-&gt;lineEdit-&gt;text();</div><div class="line">    <span class="keywordtype">bool</span> ok = <span class="keyword">false</span>;</div><div class="line">    <span class="keywordtype">int</span> int_res = result.toInt(&amp;ok);</div><div class="line">    <span class="keywordflow">if</span>(!ok)</div><div class="line">    {</div><div class="line">      QMessageBox::warning(mw,</div><div class="line">                           <span class="stringliteral">"ERROR"</span>,</div><div class="line">                           tr(<span class="stringliteral">"This is not an integer !"</span>)</div><div class="line">                           );</div><div class="line">      <span class="keywordflow">return</span>;</div><div class="line">    }</div><div class="line">    messageInterface-&gt;information(QString(<span class="stringliteral">"You asked me to display %1, so here it is : %1"</span>).arg(int_res));</div><div class="line">  }</div><div class="line"><span class="preprocessor">#endif</span></div><div class="line"><span class="keyword">private</span>:</div><div class="line">  QList&lt;QAction*&gt; _actions;</div><div class="line">  Messages_interface* messageInterface;</div><div class="line">  <span class="comment">//The reference to the scene</span></div><div class="line">  <a class="code" href="classCGAL_1_1Three_1_1Scene__interface.html">CGAL::Three::Scene_interface</a>* scene;</div><div class="line">  <span class="comment">//The reference to the main window</span></div><div class="line">  QMainWindow* mw;</div><div class="line">};</div><div class="line"></div><div class="line"><span class="preprocessor">#include "Basic_plugin.moc"</span></div><div class="line"></div></div><!-- fragment --><h2><a class="anchor" id="example2"></a>
Creating a DockWidget</h2>
<p><br />
<b>File</b> <a class="el" href="Three_2Example_plugin_2Dock_widget_plugin_8cpp-example.html">Three/Example_plugin/Dock_widget_plugin.cpp</a> </p><div class="fragment"><div class="line"><span class="preprocessor">#include "ui_Basic_dock_widget.h"</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Three/Polyhedron_demo_plugin_helper.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;QApplication&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;QObject&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;QAction&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;QMainWindow&gt;</span></div><div class="line"><span class="preprocessor">#include "Messages_interface.h"</span></div><div class="line"></div><div class="line"><span class="keyword">class </span>DockWidget :</div><div class="line">    <span class="keyword">public</span> QDockWidget,</div><div class="line">    <span class="keyword">public</span> Ui::BasicDockWidget</div><div class="line">{</div><div class="line"><span class="keyword">public</span>:</div><div class="line">  DockWidget(QString name, QWidget *parent)</div><div class="line">    :QDockWidget(name,parent)</div><div class="line">  {</div><div class="line">   setupUi(<span class="keyword">this</span>);</div><div class="line">  }</div><div class="line">};</div><div class="line"><span class="comment">//This plugin crates an action in Operations that creates a DOckWidget to display a number in the 'console' dockwidet.</span></div><div class="line"><span class="keyword">class </span>BasicPlugin :</div><div class="line">    <span class="keyword">public</span> QObject,</div><div class="line">    <span class="keyword">public</span> <a class="code" href="classCGAL_1_1Three_1_1Polyhedron__demo__plugin__helper.html">CGAL::Three::Polyhedron_demo_plugin_helper</a></div><div class="line">{</div><div class="line">  Q_OBJECT</div><div class="line">  Q_INTERFACES(<a class="code" href="classCGAL_1_1Three_1_1Polyhedron__demo__plugin__interface.html">CGAL::Three::Polyhedron_demo_plugin_interface</a>)</div><div class="line">  Q_PLUGIN_METADATA(IID <span class="stringliteral">"com.geometryfactory.PolyhedronDemo.PluginInterface/1.0"</span>)</div><div class="line"><span class="keyword">public</span>:</div><div class="line">  <span class="comment">//decides if the plugin's actions will be displayed or not.</span></div><div class="line">  <span class="keywordtype">bool</span> applicable(QAction*) <span class="keyword">const</span> Q_DECL_OVERRIDE</div><div class="line">  {</div><div class="line">    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line">  }</div><div class="line">  <span class="comment">//the list of the actions of the plugin.</span></div><div class="line">  QList&lt;QAction*&gt; actions() const Q_DECL_OVERRIDE</div><div class="line">  {</div><div class="line">    <span class="keywordflow">return</span> _actions;</div><div class="line">  }</div><div class="line">  <span class="comment">//this acts like a constructor for the plugin. It gets the references to the mainwindow and the scene, and connects the action.</span></div><div class="line">  <span class="keywordtype">void</span> init(QMainWindow* mw, <a class="code" href="classCGAL_1_1Three_1_1Scene__interface.html">CGAL::Three::Scene_interface</a>* sc, Messages_interface* mi) Q_DECL_OVERRIDE</div><div class="line">  {</div><div class="line">    <span class="comment">//gets the reference to the message interface, to display text in the console widget</span></div><div class="line">    this-&gt;messageInterface = mi;</div><div class="line">    <span class="comment">//get the references</span></div><div class="line">    this-&gt;scene = sc;</div><div class="line">    this-&gt;mw = mw;</div><div class="line"></div><div class="line">    <span class="comment">//creates the action</span></div><div class="line">    QAction *actionHelloWorld= <span class="keyword">new</span> QAction(QString(<span class="stringliteral">"Open Dock Widget"</span>), mw);</div><div class="line">    <span class="comment">//specifies the subMenu</span></div><div class="line">    actionHelloWorld-&gt;setProperty(<span class="stringliteral">"submenuName"</span>, <span class="stringliteral">"Basic"</span>);</div><div class="line">    <span class="comment">//links the action</span></div><div class="line">    <span class="keywordflow">if</span>(actionHelloWorld) {</div><div class="line">      connect(actionHelloWorld, SIGNAL(triggered()),</div><div class="line">              <span class="keyword">this</span>, SLOT(helloWorld()));</div><div class="line">      _actions &lt;&lt; actionHelloWorld;</div><div class="line">    }</div><div class="line"></div><div class="line">    dock_widget = <span class="keyword">new</span> DockWidget(<span class="stringliteral">"Print a number"</span>, mw);</div><div class="line">    dock_widget-&gt;setVisible(<span class="keyword">false</span>); <span class="comment">// do not show at the beginning</span></div><div class="line"></div><div class="line">    addDockWidget(dock_widget);</div><div class="line"></div><div class="line">    connect(dock_widget-&gt;pushButton, SIGNAL(clicked(<span class="keywordtype">bool</span>)),</div><div class="line">            <span class="keyword">this</span>, SLOT(on_dock_button_clicked()));</div><div class="line">  }</div><div class="line"></div><div class="line"><span class="keyword">private</span> Q_SLOTS:</div><div class="line">  <span class="keywordtype">void</span> helloWorld()</div><div class="line">  {</div><div class="line">    <span class="comment">// dock widget should be instancied in init()</span></div><div class="line">    <span class="keywordflow">if</span>(dock_widget-&gt;isVisible()) { dock_widget-&gt;hide(); }</div><div class="line">    <span class="keywordflow">else</span>                         { dock_widget-&gt;show(); }</div><div class="line">  }</div><div class="line"></div><div class="line">  <span class="keywordtype">void</span> on_dock_button_clicked()</div><div class="line">  {</div><div class="line">      messageInterface-&gt;information(QString(<span class="stringliteral">"Here is your number :%1"</span>).arg(dock_widget-&gt;spinBox-&gt;value()));</div><div class="line"></div><div class="line">  }</div><div class="line">  <span class="keywordtype">void</span> closure()Q_DECL_OVERRIDE</div><div class="line">  {</div><div class="line">    dock_widget-&gt;hide();</div><div class="line">  }</div><div class="line"><span class="keyword">private</span>:</div><div class="line">  QList&lt;QAction*&gt; _actions;</div><div class="line">  Messages_interface* messageInterface;</div><div class="line">  DockWidget* dock_widget;</div><div class="line">};</div><div class="line"></div><div class="line"><span class="preprocessor">#include "Dock_widget_plugin.moc"</span></div><div class="line"></div><div class="line"></div><div class="line"></div></div><!-- fragment --><h2><a class="anchor" id="example3"></a>
Using an Existing Item and Create a New Item of an Existing Type</h2>
<p><br />
<b>File</b> <a class="el" href="Three_2Example_plugin_2Basic_item_plugin_8cpp-example.html">Three/Example_plugin/Basic_item_plugin.cpp</a> </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;CGAL/Three/Polyhedron_demo_plugin_interface.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;QApplication&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;QObject&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;QAction&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;QMainWindow&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;QInputDialog&gt;</span></div><div class="line"><span class="preprocessor">#include "Messages_interface.h"</span></div><div class="line"><span class="preprocessor">#include "CGAL/Three/Scene_group_item.h"</span></div><div class="line"><span class="preprocessor">#include "Scene_plane_item.h"</span></div><div class="line"></div><div class="line"><span class="comment">//This plugin crates an action in Operations that displays the name of the selected item,</span></div><div class="line"><span class="comment">//adds a scene_plane_item to the scene, and adds the selected item and the plane to a new group.</span></div><div class="line"><span class="keyword">class </span>BasicItemPlugin :</div><div class="line">    <span class="keyword">public</span> QObject,</div><div class="line">    <span class="keyword">public</span> <a class="code" href="classCGAL_1_1Three_1_1Polyhedron__demo__plugin__interface.html">CGAL::Three::Polyhedron_demo_plugin_interface</a></div><div class="line">{</div><div class="line">  Q_OBJECT</div><div class="line">  Q_INTERFACES(<a class="code" href="classCGAL_1_1Three_1_1Polyhedron__demo__plugin__interface.html">CGAL::Three::Polyhedron_demo_plugin_interface</a>)</div><div class="line">  Q_PLUGIN_METADATA(IID <span class="stringliteral">"com.geometryfactory.PolyhedronDemo.PluginInterface/1.0"</span>)</div><div class="line"><span class="keyword">public</span>:</div><div class="line">  <span class="comment">//This plugin is only applicable if there is exactly one selected item.</span></div><div class="line">  <span class="keywordtype">bool</span> applicable(QAction*) <span class="keyword">const</span> Q_DECL_OVERRIDE</div><div class="line">  {</div><div class="line">    <span class="keywordflow">return</span> scene-&gt;selectionIndices().size() ==1;</div><div class="line">  }</div><div class="line">  <span class="comment">//the list of the actions of the plugin.</span></div><div class="line">  QList&lt;QAction*&gt; actions() const Q_DECL_OVERRIDE</div><div class="line">  {</div><div class="line">    <span class="keywordflow">return</span> _actions;</div><div class="line">  }</div><div class="line">  <span class="comment">//this acts like a constructor for the plugin. It gets the references to the mainwindow and the scene, and connects the action.</span></div><div class="line">  <span class="keywordtype">void</span> init(QMainWindow* mw, <a class="code" href="classCGAL_1_1Three_1_1Scene__interface.html">CGAL::Three::Scene_interface</a>* sc, Messages_interface* mi) Q_DECL_OVERRIDE</div><div class="line">  {</div><div class="line">    <span class="comment">//gets the reference to the message interface, to display text in the console widget</span></div><div class="line">    this-&gt;messageInterface = mi;</div><div class="line">    <span class="comment">//get the references</span></div><div class="line">    this-&gt;scene = sc;</div><div class="line">    this-&gt;mw = mw;</div><div class="line"></div><div class="line">    <span class="comment">//creates the action</span></div><div class="line">    QAction *actionHelloWorld= <span class="keyword">new</span> QAction(QString(<span class="stringliteral">"Create a group"</span>), mw);</div><div class="line">    <span class="comment">//specifies the subMenu</span></div><div class="line">    actionHelloWorld-&gt;setProperty(<span class="stringliteral">"submenuName"</span>, <span class="stringliteral">"Basic"</span>);</div><div class="line">    <span class="comment">//links the action</span></div><div class="line">    <span class="keywordflow">if</span>(actionHelloWorld) {</div><div class="line">      connect(actionHelloWorld, SIGNAL(triggered()),</div><div class="line">              <span class="keyword">this</span>, SLOT(helloWorld()));</div><div class="line">      _actions &lt;&lt; actionHelloWorld;</div><div class="line">    }</div><div class="line">  }</div><div class="line"><span class="keyword">private</span> Q_SLOTS:</div><div class="line"></div><div class="line"></div><div class="line">  <span class="keywordtype">void</span> helloWorld()</div><div class="line">  { </div><div class="line">    <span class="comment">//get a reference to the selected item.</span></div><div class="line">    <a class="code" href="classCGAL_1_1Three_1_1Scene__item.html">CGAL::Three::Scene_item</a> *item = scene-&gt;item(scene-&gt;mainSelectionIndex());</div><div class="line">    messageInterface-&gt;information(QString(<span class="stringliteral">"The selected item's name is  : %1"</span>).arg(item-&gt;name()));</div><div class="line">    <span class="comment">//creates a plane item</span></div><div class="line">    Scene_plane_item *new_item = <span class="keyword">new</span> Scene_plane_item(scene);</div><div class="line">    new_item-&gt;setName(<span class="stringliteral">"Trivial Plane"</span>);</div><div class="line">    new_item-&gt;setColor(Qt::blue);</div><div class="line">    new_item-&gt;setNormal(0.0,0.0,1.0);</div><div class="line">    scene-&gt;addItem(new_item);</div><div class="line">    <span class="comment">//Create a new group</span></div><div class="line">    Scene_group_item *group = <span class="keyword">new</span> Scene_group_item(<span class="stringliteral">"New group"</span>);</div><div class="line">    <span class="comment">//add it to the scene</span></div><div class="line">    scene-&gt;addItem(group);</div><div class="line">    <span class="comment">//Then give it its children</span></div><div class="line">    scene-&gt;changeGroup(item, group);</div><div class="line">    scene-&gt;changeGroup(new_item,group);</div><div class="line">  }</div><div class="line"></div><div class="line"><span class="keyword">private</span>:</div><div class="line">  QList&lt;QAction*&gt; _actions;</div><div class="line">  Messages_interface* messageInterface;</div><div class="line">  <span class="comment">//The reference to the scene</span></div><div class="line">  <a class="code" href="classCGAL_1_1Three_1_1Scene__interface.html">CGAL::Three::Scene_interface</a>* scene;</div><div class="line">  <span class="comment">//The reference to the main window</span></div><div class="line">  QMainWindow* mw;</div><div class="line">};</div><div class="line"></div><div class="line"><span class="preprocessor">#include "Basic_item_plugin.moc"</span></div></div><!-- fragment --><h2><a class="anchor" id="example4"></a>
Creating a new Type of Item</h2>
<p><br />
<b>File</b> <a class="el" href="Three_2Example_plugin_2Example_plugin_8cpp-example.html">Three/Example_plugin/Example_plugin.cpp</a> </p><div class="fragment"><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;QApplication&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;QMainWindow&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;QAction&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;QVector&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Three/Scene_item.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Three/Viewer_interface.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Three/Scene_group_item.h&gt;</span></div><div class="line"></div><div class="line"><span class="comment">// The special Scene_item only for triangles</span></div><div class="line"></div><div class="line"><span class="comment">//this is used by the Qt's MOC system to manage the metadata.</span></div><div class="line"><span class="preprocessor">#ifdef scene_triangle_item_EXPORTS</span></div><div class="line"><span class="preprocessor">#  define SCENE_TRIANGLE_ITEM_EXPORT Q_DECL_EXPORT</span></div><div class="line"><span class="preprocessor">#else</span></div><div class="line"><span class="preprocessor">#  define SCENE_TRIANGLE_ITEM_EXPORT Q_DECL_IMPORT</span></div><div class="line"><span class="preprocessor">#endif</span></div><div class="line"></div><div class="line"><span class="keyword">class </span>Scene_triangle_item : <span class="keyword">public</span> <a class="code" href="classCGAL_1_1Three_1_1Scene__item.html">CGAL::Three::Scene_item</a></div><div class="line">{</div><div class="line"></div><div class="line">  Q_OBJECT</div><div class="line">public :</div><div class="line">  Scene_triangle_item(<span class="keywordtype">double</span> ax,<span class="keywordtype">double</span> ay, <span class="keywordtype">double</span> az,</div><div class="line">                      <span class="keywordtype">double</span> bx,<span class="keywordtype">double</span> by, <span class="keywordtype">double</span> bz,</div><div class="line">                      <span class="keywordtype">double</span> cx,<span class="keywordtype">double</span> cy, <span class="keywordtype">double</span> cz);</div><div class="line"></div><div class="line">  <span class="comment">// Indicates if rendering mode is supported</span></div><div class="line">  <span class="keywordtype">bool</span> supportsRenderingMode(<a class="code" href="group__PkgThree.html#ga87cafe63badc45546f2eb940f2a94d70">RenderingMode</a> m) <span class="keyword">const</span> Q_DECL_OVERRIDE {</div><div class="line">    <span class="keywordflow">return</span> (m == <a class="code" href="group__PkgThree.html#gga87cafe63badc45546f2eb940f2a94d70a5a9e3347876551cd38b961213ff1ccde">Flat</a>);</div><div class="line">  }</div><div class="line"></div><div class="line">  <span class="comment">//Displays the item</span></div><div class="line">  <span class="keywordtype">void</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Polyhedron.tag:../Polyhedron/" href="../Polyhedron/group__PkgDrawPolyhedron.html#ga3ca458ed11c9fb052476b00227d93584">draw</a>(<a class="code" href="classCGAL_1_1Three_1_1Viewer__interface.html">CGAL::Three::Viewer_interface</a>* viewer) <span class="keyword">const</span> Q_DECL_OVERRIDE;</div><div class="line"></div><div class="line">  <span class="comment">//Specifies that the buffers need to be initialized again.</span></div><div class="line">  <span class="comment">//Is mostly called after a change of geometry in the data.</span></div><div class="line">  <span class="keywordtype">void</span> invalidateOpenGLBuffers() Q_DECL_OVERRIDE;</div><div class="line"></div><div class="line">  <span class="comment">//fills the std::vector</span></div><div class="line">  <span class="keywordtype">void</span> computeElements(<span class="keywordtype">double</span> ax,<span class="keywordtype">double</span> ay, <span class="keywordtype">double</span> az,</div><div class="line">                        <span class="keywordtype">double</span> bx,<span class="keywordtype">double</span> by, <span class="keywordtype">double</span> bz,</div><div class="line">                        <span class="keywordtype">double</span> cx,<span class="keywordtype">double</span> cy, <span class="keywordtype">double</span> cz) const Q_DECL_OVERRIDE;</div><div class="line"></div><div class="line">  Scene_item* clone() const Q_DECL_OVERRIDE {<span class="keywordflow">return</span> 0;}</div><div class="line">  QString toolTip() const Q_DECL_OVERRIDE {<span class="keywordflow">return</span> QString();}</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">private</span>:</div><div class="line">  <span class="comment">//contains the data</span></div><div class="line">  <span class="keyword">mutable</span> std::vector&lt;float&gt; vertices;</div><div class="line">  <span class="keyword">mutable</span> <span class="keywordtype">int</span> nb_pos;</div><div class="line">  <span class="keyword">mutable</span> QOpenGLShaderProgram *program;</div><div class="line">  <span class="keyword">using</span> <a class="code" href="classCGAL_1_1Three_1_1Scene__item.html#a216833a5b2c7b82e7ae23ad4bd3684cb">CGAL::Three::Scene_item::initializeBuffers</a>;</div><div class="line">  <span class="comment">//Fills the buffers with data. The buffers allow us to give data to the shaders.</span></div><div class="line">  <span class="keywordtype">void</span> initializeBuffers(<a class="code" href="classCGAL_1_1Three_1_1Viewer__interface.html">CGAL::Three::Viewer_interface</a> *viewer)<span class="keyword">const</span> Q_DECL_OVERRIDE;</div><div class="line">}; <span class="comment">//end of class Scene_triangle_item</span></div><div class="line"><span class="comment"></span>Scene_triangle_item::Scene_triangle_item(<span class="keywordtype">double</span> ax,<span class="keywordtype">double</span> ay, <span class="keywordtype">double</span> az,</div><div class="line">                                         <span class="keywordtype">double</span> bx,<span class="keywordtype">double</span> by, <span class="keywordtype">double</span> bz,</div><div class="line">                                         <span class="keywordtype">double</span> cx,<span class="keywordtype">double</span> cy, <span class="keywordtype">double</span> cz)</div><div class="line">  :  <a class="code" href="namespaceCGAL.html">CGAL</a>::Three::Scene_item(1,1)</div><div class="line">{</div><div class="line">  nb_pos = 0;</div><div class="line">  are_buffers_filled = <span class="keyword">false</span>;</div><div class="line">  computeElements(ax, ay, az,</div><div class="line">                   bx, by, bz,</div><div class="line">                   cx, cy, cz);</div><div class="line">  invalidateOpenGLBuffers();</div><div class="line">}</div><div class="line"></div><div class="line"><span class="comment">//Fills the position vector with data.</span></div><div class="line"><span class="keywordtype">void</span> Scene_triangle_item::computeElements(<span class="keywordtype">double</span> ax, <span class="keywordtype">double</span> ay, <span class="keywordtype">double</span> az,</div><div class="line">                                           <span class="keywordtype">double</span> bx, <span class="keywordtype">double</span> by, <span class="keywordtype">double</span> bz,</div><div class="line">                                           <span class="keywordtype">double</span> cx, <span class="keywordtype">double</span> cy, <span class="keywordtype">double</span> cz)<span class="keyword">const</span></div><div class="line"><span class="keyword"></span>{</div><div class="line">  vertices.resize(9);</div><div class="line">  vertices[0] = ax; vertices[1] = ay; vertices[2] = az;</div><div class="line">  vertices[3] = bx; vertices[4] = by; vertices[5] = bz;</div><div class="line">  vertices[6] = cx; vertices[7] = cy; vertices[8] = cz;</div><div class="line">}</div><div class="line"></div><div class="line"></div><div class="line"><span class="keywordtype">void</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Polyhedron.tag:../Polyhedron/" href="../Polyhedron/group__PkgDrawPolyhedron.html#ga3ca458ed11c9fb052476b00227d93584">Scene_triangle_item::draw</a>(<a class="code" href="classCGAL_1_1Three_1_1Viewer__interface.html">CGAL::Three::Viewer_interface</a>* viewer)<span class="keyword"> const</span></div><div class="line"><span class="keyword"></span>{</div><div class="line">  <span class="comment">//The filling of the buffers should be performed in this function, because it needs a valid openGL context, and we are certain to have one in this function.</span></div><div class="line">  <span class="keywordflow">if</span>(!are_buffers_filled)</div><div class="line">  {</div><div class="line">    computeElements(0, 0, 0,</div><div class="line">                     1, 0, 0,</div><div class="line">                     0.5, 0.5, 0);</div><div class="line">    initializeBuffers(viewer);</div><div class="line">  }</div><div class="line">  <span class="comment">//Binds the vao corresponding to the type of data we are drawing.</span></div><div class="line">  vaos[0]-&gt;bind();</div><div class="line">  <span class="comment">//Gets the program corresponding to the type of data we are drawing.</span></div><div class="line">  <span class="comment">//Here we want triangles with light effects.</span></div><div class="line">  program = getShaderProgram(PROGRAM_WITH_LIGHT);</div><div class="line">  <span class="comment">//Gives most of the uniform values to the shaders.</span></div><div class="line">  attribBuffers(viewer, PROGRAM_WITH_LIGHT);</div><div class="line">  <span class="comment">//Binds the program chosen before to use the right shaders.</span></div><div class="line">  program-&gt;bind();</div><div class="line">  <span class="comment">//Gives the wanted color to the fragment shader as uniform value.</span></div><div class="line">  program-&gt;setAttributeValue(<span class="stringliteral">"colors"</span>, this-&gt;color());</div><div class="line">  <span class="comment">//Draws the items</span></div><div class="line">  viewer-&gt;glDrawArrays(GL_TRIANGLES, 0, static_cast&lt;GLsizei&gt;(nb_pos/3));</div><div class="line">  <span class="comment">//clean up</span></div><div class="line">  vaos[0]-&gt;release();</div><div class="line">  program-&gt;release();</div><div class="line"></div><div class="line">}</div><div class="line"><span class="comment">//Specifies that the buffers need to be initialized again.</span></div><div class="line"><span class="comment">//Is mostly called after a change of geometry in the data.</span></div><div class="line"><span class="keywordtype">void</span> Scene_triangle_item::invalidateOpenGLBuffers()</div><div class="line">{</div><div class="line">  are_buffers_filled = <span class="keyword">false</span>;</div><div class="line">}</div><div class="line"></div><div class="line"></div><div class="line"><span class="keywordtype">void</span> Scene_triangle_item::initializeBuffers(<a class="code" href="classCGAL_1_1Three_1_1Viewer__interface.html">CGAL::Three::Viewer_interface</a> *viewer)<span class="keyword">const</span></div><div class="line"><span class="keyword"></span>{</div><div class="line"></div><div class="line">  <span class="comment">//vao containing the data for the facets</span></div><div class="line">  {</div><div class="line">    program = getShaderProgram(PROGRAM_WITH_LIGHT, viewer);</div><div class="line">    program-&gt;bind();</div><div class="line"></div><div class="line">    vaos[0]-&gt;bind();</div><div class="line">    buffers[0].bind();</div><div class="line">    buffers[0].allocate(vertices.data(),</div><div class="line">                        <span class="keyword">static_cast&lt;</span>GLsizei<span class="keyword">&gt;</span>(vertices.size()*<span class="keyword">sizeof</span>(float)));</div><div class="line">    program-&gt;enableAttributeArray(<span class="stringliteral">"vertex"</span>);</div><div class="line">    program-&gt;setAttributeBuffer(<span class="stringliteral">"vertex"</span>,GL_FLOAT,0,3);</div><div class="line">    buffers[0].release();</div><div class="line"></div><div class="line">    vaos[0]-&gt;release();</div><div class="line">    program-&gt;release();</div><div class="line"></div><div class="line">  }</div><div class="line"></div><div class="line"><span class="comment">//once the buffers are fill, we can empty the vectors to optimize memory consumption</span></div><div class="line">  nb_pos = vertices.size();</div><div class="line">  vertices.resize(0);</div><div class="line">  <span class="comment">//"Swap trick" insures that the memory is indeed freed and not kept available</span></div><div class="line">  std::vector&lt;float&gt;(vertices).swap(vertices);</div><div class="line">  are_buffers_filled = <span class="keyword">true</span>;</div><div class="line">}</div><div class="line"><span class="preprocessor">#include &lt;CGAL/Three/Polyhedron_demo_plugin_helper.h&gt;</span></div><div class="line"><span class="comment">//The actual plugin</span></div><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespaceCGAL_1_1Three.html">CGAL::Three</a>;</div><div class="line"><span class="keyword">class </span>Q_DECL_EXPORT Polyhedron_demo_example_plugin :</div><div class="line">    <span class="keyword">public</span> QObject,</div><div class="line">    <span class="keyword">public</span> <a class="code" href="classCGAL_1_1Three_1_1Polyhedron__demo__plugin__helper.html">Polyhedron_demo_plugin_helper</a></div><div class="line">{</div><div class="line">  <span class="comment">//Configures CMake to use MOC correctly</span></div><div class="line">  Q_OBJECT</div><div class="line">  Q_INTERFACES(<a class="code" href="classCGAL_1_1Three_1_1Polyhedron__demo__plugin__interface.html">CGAL::Three::Polyhedron_demo_plugin_interface</a>)</div><div class="line">  Q_PLUGIN_METADATA(IID <span class="stringliteral">"com.geometryfactory.PolyhedronDemo.PluginInterface/1.0"</span>)</div><div class="line"></div><div class="line"></div><div class="line">public :</div><div class="line">  <span class="comment">// Adds an action to the menu and configures the widget</span></div><div class="line">  <span class="keywordtype">void</span> init(QMainWindow* mainWindow, <a class="code" href="classCGAL_1_1Three_1_1Scene__interface.html">CGAL::Three::Scene_interface</a>* scene_interface, Messages_interface*) Q_DECL_OVERRIDE{</div><div class="line">    <span class="comment">//get the references</span></div><div class="line">    this-&gt;scene = scene_interface;</div><div class="line">    this-&gt;mw = mainWindow;</div><div class="line"></div><div class="line">    <span class="comment">//creates and link the actions</span></div><div class="line">    QAction* actionDrawTriangle= <span class="keyword">new</span> QAction(<span class="stringliteral">"Draw Triangle"</span>, mw);</div><div class="line">    <span class="keywordflow">if</span>(actionDrawTriangle) {</div><div class="line">      connect(actionDrawTriangle, SIGNAL(triggered()),</div><div class="line">              <span class="keyword">this</span>, SLOT(draw_triangle()));</div><div class="line">      _actions &lt;&lt; actionDrawTriangle;</div><div class="line">    }</div><div class="line">  }</div><div class="line">  <span class="keywordtype">bool</span> applicable(QAction*) <span class="keyword">const</span> Q_DECL_OVERRIDE</div><div class="line">  {</div><div class="line">    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line">  }</div><div class="line">  QList&lt;QAction*&gt; actions() const Q_DECL_OVERRIDE{</div><div class="line">    <span class="keywordflow">return</span> _actions;</div><div class="line">  }</div><div class="line"></div><div class="line"><span class="keyword">public</span> Q_SLOTS:</div><div class="line"></div><div class="line"></div><div class="line">  <span class="keywordtype">void</span> draw_triangle() {</div><div class="line"></div><div class="line">    triangle = <span class="keyword">new</span> Scene_triangle_item(0, 0, 0,</div><div class="line">                                       1, 0, 0,</div><div class="line">                                       0.5, 0.5, 0);</div><div class="line">    triangle-&gt;setName(QString(<span class="stringliteral">"Basic triangle"</span>));</div><div class="line">    scene-&gt;addItem(triangle);</div><div class="line">  }</div><div class="line"><span class="keyword">private</span>:</div><div class="line">  <a class="code" href="classCGAL_1_1Three_1_1Scene__item.html">CGAL::Three::Scene_item</a>* triangle;</div><div class="line">  QList&lt;QAction*&gt; _actions;</div><div class="line"></div><div class="line">}; <span class="comment">//end of class Polyhedron_demo_example_plugin</span></div><div class="line"><span class="preprocessor">#include "Example_plugin.moc"</span></div><div class="line"></div></div><!-- fragment --> </div></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<!-- The footer div is not part of the default but we require it to
move the footer to the bottom of the page. -->
<div id="footer">
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Mon Oct 1 2018 11:59:11 for CGAL 4.13 - Three by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen" /></a> 1.8.13 </li>
  </ul>
</div>
</div>
</body>

</html>
