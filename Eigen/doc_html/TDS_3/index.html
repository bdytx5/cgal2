<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="canonical" href="https://doc.cgal.org/latest/TDS_3/index.html"/>

<link rel="icon" type="image/png" href="../Manual/g-196x196-doc.png" />
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8" />
<meta http-equiv="X-UA-Compatible" content="IE=9" />
<meta name="generator" content="Doxygen 1.8.13" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>CGAL 4.13 - 3D Triangulation Data Structure: User Manual</title>
<!-- <link href="../Manual/tabs.css" rel="stylesheet" type="text/css"/> -->
<script type="text/javascript" src="../Manual/jquery.js"></script>
<script type="text/javascript" src="../Manual/dynsections.js"></script>
<!-- Manually include treeview and search to avoid bloat and to fix
     paths to the directory Manual . -->
<!-- $.treeview -->
<!-- $.search -->
<link href="navtree.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="../Manual/resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="../Manual/search/search.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="../Manual/search/searchdata.js"></script>
<script type="text/javascript" src="../Manual/search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="../Manual/search/search.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="../Manual/search/search.js"></script>
<!-- Manually done below. -->
<link href="../Manual/stylesheet.css" rel="stylesheet" type="text/css" />
<!-- This should probably be an extrastylesheet instead of hardcoded. -->
<link href="../Manual/cgal_stylesheet.css" rel="stylesheet" type="text/css" />
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js"></script>
<script src="../Manual/hacks.js" type="text/javascript"></script>
<script src="modules.js" type="text/javascript"></script>
</head>
<body>
<!-- Custom mathjax -->
<!-- TODO: Remove this with MATHJAX_CODEFILE -->
<span style="display:none">\( \newcommand{\E}{\mathrm{E}} \) \( \newcommand{\A}{\mathrm{A}} \)
\( \newcommand{\R}{\mathrm{R}} \) \( \newcommand{\N}{\mathrm{N}} \) \( \newcommand{\Q}{\mathrm{Q}} \) \( \newcommand{\Z}{\mathrm{Z}} \)
\(
\def\ccSum #1#2#3{
  \sum_{#1}^{#2}{#3}
}
\def\ccProd #1#2#3{
  \sum_{#1}^{#2}{#3}
}\)
</span>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="back-nav">
  <ul>
    <li><a href="https://www.cgal.org/">cgal.org</a></li>
    <li><a href="../Manual/index.html">Top</a></li>
    <li><a href="../Manual/general_intro.html">Getting Started</a></li>
    <li><a href="../Manual/tutorials.html">Tutorials</a></li>
    <li><a href="../Manual/packages.html">Package Overview</a></li>
    <li><a href="../Manual/how_to_cite_cgal.html">Acknowledging CGAL</a></li>
  </ul>
  <!-- In a package SEARCHENGINE = false, so we cannot use 
       insertion. That's why we have to do it manually here. Notice
       that we also take pngs from the Manual. -->
  <div id="MSearchBox" class="MSearchBoxInactive">
    <span class="left">
      <img id="MSearchSelect" src="../Manual/search/mag_sel.png" onmouseover="return searchBox.OnSearchSelectShow()" onmouseout="return searchBox.OnSearchSelectHide()" alt="" />
      <input type="text" id="MSearchField" value="Search" accesskey="S" onfocus="searchBox.OnSearchFieldFocus(true)" onblur="searchBox.OnSearchFieldFocus(false)" onkeyup="searchBox.OnSearchFieldChange(event)" />
    </span><span class="right">
      <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../Manual/search/close.png" alt="" /></a>
    </span>
  </div>
</div>
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">CGAL 4.13 - 3D Triangulation Data Structure
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- Code below is usually inserted by doxygen when SEARCHENGINE =
     true. Notice that the path to the search directory is adjusted to
     the top-level.-->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../Manual/search",false,'Search');
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow" onmouseover="return searchBox.OnSearchSelectShow()" onmouseout="return searchBox.OnSearchSelectHide()" onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>
<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" name="MSearchResults" id="MSearchResults">
</iframe>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync" style="display: none"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('index.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">User Manual </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="Chapter_3D_Triangulation_Data_Structure"></a><a class="anchor" id="chapterTDS3"></a>  </p><div id="autotoc" class="toc"></div>  <dl class="section author"><dt>Authors</dt><dd>Cl√©ment Jamin, Sylvain Pion and Monique Teillaud</dd></dl>
<p>A geometric triangulation has two aspects: the combinatorial structure, which gives the incidence and adjacency relations between faces, and the geometric information related to the position of vertices.</p>
<p><span style="font-variant: small-caps;">CGAL</span> provides 3D geometric triangulations in which these two aspects are clearly separated. As described in Chapter <a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Triangulation_3.tag:../Triangulation_3/" href="../Triangulation_3/index.html#chapterTriangulation3">3D Triangulations</a>, a geometric triangulation of a set of points in \( \mathbb{R}^d\), \( d\leq 3\) is a partition of the whole space \( \mathbb{R}^d\) into cells having \( d+1\) vertices. Some of them are infinite, they are obtained by linking an additional vertex at infinity to each facet of the convex hull of the points (see Section <a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Triangulation_3.tag:../Triangulation_3/" href="../Triangulation_3/index.html#Triangulation3secintro">Representation</a>). The underlying combinatorial graph of such a triangulation without boundary of \( \mathbb{R}^d\) can be seen as a triangulation of the topological sphere \( S^d\) in \( \mathbb{R}^{d+1}\).</p>
<p>This chapter deals with 3D-triangulation data structures, meant to maintain the combinatorial information for 3D-geometric triangulations. The reader interested in geometric triangulations of \( \mathbb{R}^3\) is advised to read Chapter <a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Triangulation_3.tag:../Triangulation_3/" href="../Triangulation_3/index.html#chapterTriangulation3">3D Triangulations</a>.</p>
<h1><a class="anchor" id="TDS3secintro"></a>
Representation</h1>
<p>In <span style="font-variant: small-caps;">CGAL</span>, a 3D triangulation data structure is a container of cells ( \( 3\)-faces) and vertices ( \( 0\)-faces).</p>
<p>Following the standard vocabulary of simplicial complexes, an \( i\)-face \( f_i\) and a \( j\)-face \( f_j\) \( (0 \leq j &lt; i \leq 3)\) are said to be <em>incident</em> in the triangulation if \( f_j\) is a (sub)face of \( f_i\), and two \( i\)-faces \( (0 \leq i \leq 3)\) are said to be <em>adjacent</em> if they share a commun incident (sub)face.</p>
<p>Each cell gives access to its four incident vertices and to its four adjacent cells. Each vertex gives direct access to one of its incident cells, which is sufficient to retrieve all the incident cells when needed.</p>
<p>The four vertices of a cell are indexed with 0, 1, 2 and 3. The neighbors of a cell are also indexed with 0, 1, 2, 3 in such a way that the neighbor indexed by \( i\) is opposite to the vertex with the same index (see <a class="el" href="index.html#fig__TDS3figrepres">Figure 43.1</a>).</p>
<p><a class="anchor" id="fig__TDS3figrepres"></a></p><div class="image">
<img src="repres.png" alt="repres.png" />
</div>
   <div class="cgal_figure_caption">  <a class="el" href="index.html#fig__TDS3figrepres">Figure 43.1</a> Representation.  </div>  <br />

<p>Edges ( \( 1\)-faces) and facets ( \( 2\)-faces) are not explicitly represented: a facet is given by a cell and an index (the facet <code>i</code> of a cell <code>c</code> is the facet of <code>c</code> that is opposite to the vertex of index <code>i</code>) and an edge is given by a cell and two indices (the edge <code>(i,j)</code> of a cell <code>c</code> is the edge whose endpoints are the vertices of indices <code>i</code> and <code>j</code> of <code>c</code>).</p>
<p><b>Degenerate Dimensions</b></p>
<p>As <span style="font-variant: small-caps;">CGAL</span> explicitly deals with all degenerate cases, a 3D-triangulation data structure in <span style="font-variant: small-caps;">CGAL</span> can handle the cases when the dimension of the triangulation is lower than 3.</p>
<p>Thus, a 3D-triangulation data structure can store a triangulation of a topological sphere \( S^d\) of \( \mathbb{R}^{d+1}\), for any \( d \in \{-1,0,1,2,3\}\).</p>
<p>Let us give, for each dimension, the example corresponding to the triangulation data structure having a minimal number of vertices, i.e. a simplex. These examples are illustrated by presenting their usual geometric embedding. </p><ul>
<li>
<p class="startli"><em>dimension 3.</em> The triangulation data structure consists of the boundary of a 4-dimensional simplex, which has 5 vertices. A geometric embedding consists in choosing one of these vertices to be infinite, thus four of the five 3-cells become infinite: the geometric triangulation has one finite tetrahedron remaining, each of its facets being incident to an infinite cell. See <a class="el" href="index.html#fig__TDS3figtoposimplex4">Figure 43.2</a>.</p>
<p><a class="anchor" id="fig__TDS3figtoposimplex4"></a></p><div class="image">
<img src="topo-simplex4.png" alt="topo-simplex4.png" />
</div>
   <div class="cgal_figure_caption">  <a class="el" href="index.html#fig__TDS3figtoposimplex4">Figure 43.2</a> 4D simplex and a 3D geometric embedding.  </div>  <br />

<p class="endli"></p>
</li>
<li>
<p class="startli"><em>dimension 2.</em> We have 4 vertices forming one 3-dimensional simplex, i.e. the boundary of a tetrahedron. The geometric embedding in the plane results from choosing one of these vertices to be infinite, then the geometric triangulation has one finite triangle whose edges are incident to the infinite triangles. See <a class="el" href="index.html#fig__TDS3figtoposimplex3">Figure 43.3</a>.</p>
<p><a class="anchor" id="fig__TDS3figtoposimplex3"></a></p><div class="image">
<img src="topo-simplex3.png" alt="topo-simplex3.png" />
</div>
   <div class="cgal_figure_caption">  <a class="el" href="index.html#fig__TDS3figtoposimplex3">Figure 43.3</a> 3D simplex and a 2D geometric embedding.  </div>  <br />

<p class="endli"></p>
</li>
<li>
<p class="startli"><em>dimension 1.</em> A 2-dimensional simplex (a triangle) has 3 vertices. The geometric embedding is an edge whose vertices are linked to an infinite point. See <a class="el" href="index.html#fig__TDS3figtoposimplex2">Figure 43.4</a>.</p>
<p><a class="anchor" id="fig__TDS3figtoposimplex2"></a></p><div class="image">
<img src="topo-simplex2.png" alt="topo-simplex2.png" />
</div>
   <div class="cgal_figure_caption">  <a class="el" href="index.html#fig__TDS3figtoposimplex2">Figure 43.4</a> 2D simplex and a 1D geometric embedding.  </div>  <br />

<p class="endli"></p>
</li>
</ul>
<p>The last three cases are defined uniquely: </p><ul>
<li>
<em>dimension 0.</em> A 0-dimensional triangulation is combinatorially equivalent to the boundary of a 1-dimensional simplex (an edge), which consists of 2 vertices. One of them becomes infinite in the geometric embedding, and there is only one finite vertex remaining. The two vertices are adjacent. </li>
<li>
<em>dimension -1.</em> This dimension is a convention to represent a 0-dimensional simplex, that is a sole vertex, which will be geometrically embedded as an "empty" triangulation, having only one infinite vertex. </li>
<li>
<em>dimension -2.</em> This is also a convention. The triangulation data structure has no vertex. There is no associated geometric triangulation. </li>
</ul>
<p>Note that the notion of infinite vertex has no meaning for the triangulation data structure. The infinite vertex of the geometric embedding is a vertex that cannot be distinguished from the other vertices in the combinatorial triangulation.</p>
<p>The same cell class is used in all cases: triangular faces in 2D can be considered as degenerate cells, having only three vertices (resp. neighbors) numbered \( (0,1,2)\); edges in 1D have only two vertices (resp. neighbors) numbered \( 0\) and \( 1\).</p>
<p>The implicit representation of facets (resp. edges) still holds for degenerate ( \( &lt; 3\)) dimensions : in dimension 2, each cell has only one facet of index 3, and 3 edges \( (0,1)\), \( (1,2)\) and \( (2,0)\); in dimension 1, each cell has one edge \( (0,1)\).</p>
<p><b>Validity</b></p>
<p>A 3D combinatorial triangulation is said to be <code>locally valid</code> iff the following is true:</p>
<p><b>(a)</b> When a cell \( c\) has a neighbor pointer to another cell \( c'\), then reciprocally this cell \( c'\) has a neighbor pointer to \( c\), and \( c\) and \( c'\) have three vertices in common. These cells are called adjacent.</p>
<p><b>(b)</b> The cells have a coherent orientation: if two cells \( c_1\) and \( c_2\) are adjacent and share a facet with vertices \( u,v,w\), then the vertices of \( c_1\) are numbered \( (v_0^1 = u, v_1^1 = v, v_2^1 = w, v_3^1)\), and the vertices of \( c_2\) are numbered \( (v_0^2 = v, v_1^2 = u, v_2^2 = w, v_3^2)\), up to positive permutations of \( (0,1,2,3)\). In other words, if we embed the triangulation in \( \mathbb{R}^3\), then the fourth vertices \( v_3^1\) and \( v_3^2\) of \( c_1\) and \( c_2\) see the common facet in opposite orientations. See <a class="el" href="index.html#fig__TDS3figcomborient">Figure 43.5</a>.</p>
<p>The set \( \sigma\) \( _4\) of permutations of \( (0,1,2,3)\) has cardinality 24, and the set of positive permutations \( A_4\) has cardinality 12. Thus, for a given orientation, there are up to 12 different orderings of the four vertices of a cell. Note that cyclic permutations are negative and so do not preserve the orientation of a cell.</p>
<p><a class="anchor" id="fig__TDS3figcomborient"></a></p><div class="image">
<img src="comborient.png" alt="comborient.png" />
</div>
   <div class="cgal_figure_caption">  <a class="el" href="index.html#fig__TDS3figcomborient">Figure 43.5</a> Coherent orientations of two cells (3-dimensional case).  </div>  <br />

<p>The method <code>Triangulation_data_structure_3::is_valid()</code> method checks the local validity of a given triangulation data structure.</p>
<h1><a class="anchor" id="TDS3secdesign"></a>
Software Design</h1>
<p>The 3D-triangulation data structure class of <span style="font-variant: small-caps;">CGAL</span>, <code><a class="el" href="classCGAL_1_1Triangulation__data__structure__3.html" title="The class Triangulation_data_structure_3 stores a 3D-triangulation data structure and provides the op...">Triangulation_data_structure_3</a></code>, is designed to be used as a combinatorial layer upon which a geometric layer can be built <a class="el" href="citelist.html#CITEREF_k-ddsps-98">[1]</a>. This geometric layer is typically one of the 3D-triangulation classes of <span style="font-variant: small-caps;">CGAL</span>: <code><a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Triangulation_3.tag:../Triangulation_3/" href="../Triangulation_3/classCGAL_1_1Triangulation__3.html">Triangulation_3</a></code>, <code><a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Triangulation_3.tag:../Triangulation_3/" href="../Triangulation_3/classCGAL_1_1Delaunay__triangulation__3.html">Delaunay_triangulation_3</a></code> and <code><a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Triangulation_3.tag:../Triangulation_3/" href="../Triangulation_3/classCGAL_1_1Regular__triangulation__3.html">Regular_triangulation_3</a></code>. This relation is described in more details in Chapter <a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Triangulation_3.tag:../Triangulation_3/" href="../Triangulation_3/index.html#chapterTriangulation3">3D Triangulations</a>, where the Section <a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Triangulation_3.tag:../Triangulation_3/" href="../Triangulation_3/index.html#Triangulation3secdesign">Software Design</a> explains other important parts of the design related to the geometry.</p>
<p>We focus here on the design of the triangulation data structure (TDS) itself, which the <a class="el" href="index.html#fig__TDS3figlayers">Figure 43.6</a> illustrates.</p>
<p><a class="anchor" id="fig__TDS3figlayers"></a></p><div class="image">
<img src="design_tds.png" alt="design_tds.png" />
</div>
   <div class="cgal_figure_caption">  <a class="el" href="index.html#fig__TDS3figlayers">Figure 43.6</a> Triangulation Data Structure software design.  </div>  <br />

<h2><a class="anchor" id="TDS_3FlexibilityoftheDesign"></a>
Flexibility of the Design</h2>
<p>In order for the user to be able to add his own data in the vertices and cells, the design of the TDS is split into two layers:</p>
<ul>
<li>
<p class="startli">In the bottom layer, the (vertex and cell) base classes store elementary incidence and adjacency (and possibly geometric or other) information. These classes are parameterized by the TDS which provides the handle types. (They can also be parameterized by a geometric traits class or anything else.) A vertex stores a <code>Cell_handle</code>, and a cell stores four <code>Vertex_handle</code>s and four <code>Cell_handle</code>s.</p>
<p class="endli"></p>
</li>
<li>
The middle layer is the TDS, which is purely combinatorial. It provides operations such as insertion of a new vertex in a given cell, on a \( 1\) or \( 2\)-face. It also allows one, if the dimension of the triangulation is smaller than \( 3\), to insert a vertex so that the dimension of the triangulation is increased by one. The TDS is responsible for the combinatorial integrity of the eventual geometric triangulation built on top of it (the upper layer, see Chapter <a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Triangulation_3.tag:../Triangulation_3/" href="../Triangulation_3/index.html#chapterTriangulation3">3D Triangulations</a>). </li>
</ul>
<p>The user has several ways to add his own data in the vertex and cell base classes used by the TDS. He can either: </p><ul>
<li>
use the classes <code><a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Triangulation_3.tag:../Triangulation_3/" href="../Triangulation_3/classCGAL_1_1Triangulation__vertex__base__with__info__3.html">Triangulation_vertex_base_with_info_3</a></code> and <code><a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Triangulation_3.tag:../Triangulation_3/" href="../Triangulation_3/classCGAL_1_1Triangulation__cell__base__with__info__3.html">Triangulation_cell_base_with_info_3</a></code>, which allow to add one data member of a user provided type, and give access to it. </li>
<li>
derive his own classes from the default base classes <code><a class="el" href="classCGAL_1_1Triangulation__ds__vertex__base__3.html" title="The class Triangulation_ds_vertex_base_3 can be used as the base vertex for a 3D-triangulation data s...">Triangulation_ds_vertex_base_3</a></code>, and <code><a class="el" href="classCGAL_1_1Triangulation__ds__cell__base__3.html" title="The class Triangulation_ds_cell_base_3&lt;&gt; is a model for the concept TriangulationDSCellBase_3 to be u...">Triangulation_ds_cell_base_3</a></code> (or the geometric versions typically used by the geometric layer, <code><a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Triangulation_3.tag:../Triangulation_3/" href="../Triangulation_3/classCGAL_1_1Triangulation__vertex__base__3.html">Triangulation_vertex_base_3</a></code>, and <code><a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Triangulation_3.tag:../Triangulation_3/" href="../Triangulation_3/classCGAL_1_1Triangulation__cell__base__3.html">Triangulation_cell_base_3</a></code>). </li>
<li>
write his own base classes following the requirements given by the concepts <code><a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Triangulation_3.tag:../Triangulation_3/" href="../Triangulation_3/classTriangulationCellBase__3.html">TriangulationCellBase_3</a></code> and <code><a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Triangulation_3.tag:../Triangulation_3/" href="../Triangulation_3/classTriangulationVertexBase__3.html">TriangulationVertexBase_3</a></code>. </li>
</ul>
<h2><a class="anchor" id="tds3cyclic"></a>
Cyclic Dependency</h2>
<p>Since adjacency relations are stored in the vertices and cells, it means that the vertex and cell base classes have to be able to store handles (an entity akin to pointers) to their neighbors in the TDS. This in turns means that the vertex and cell base classes have to know the types of these handles, which are provided by the TDS. So in a sense, the base classes are parameterized by the TDS, and the TDS is parameterized by the vertex and cell base classes ! This is a cycle which cannot be resolved easily.</p>
<p>The solution that we have chosen is similar to the mechanism used by the standard class <code>std::allocator</code>: the vertex and cell base classes are initially given a fake or dummy TDS template parameter, whose unique purpose is to provide the types that can be used by the vertex and cell base classes (such as handles). Then, inside the TDS itself, these base classes are <em>rebound</em> to the real TDS type, that is we obtain the same vertex and cell base classes, but parameterized with the real TDS instead of the dummy one. Rebinding is performed by a nested template class of the vertex and cell base classes (see code below), which provides a type which is the rebound vertex or cell base class<span class="footnote">It is logically equivalent to a mechanism that does not exist yet in the C++ language: <em>template typedef</em> or <em>template aliasing</em></span>.</p>
<p>Here is how it works, schematically:</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt; <span class="keyword">class</span> Vb, <span class="keyword">class</span> Cb &gt;</div><div class="line"><span class="keyword">class </span>TDS</div><div class="line">{</div><div class="line"><span class="keyword">typedef</span> TDS&lt;Vb, Cb&gt; Self;</div><div class="line"></div><div class="line"><span class="comment">// Rebind the vertex and cell base to the actual TDS (Self).</span></div><div class="line"><span class="keyword">typedef</span> <span class="keyword">typename</span> Vb::template Rebind_TDS&lt;Self&gt;::Other VertexBase;</div><div class="line"><span class="keyword">typedef</span> <span class="keyword">typename</span> Cb::template Rebind_TDS&lt;Self&gt;::Other CellBase;</div><div class="line"></div><div class="line"><span class="comment">// ... further internal machinery leads to the final public types:</span></div><div class="line"><span class="keyword">public</span>:</div><div class="line"><span class="keyword">typedef</span> ... Vertex;</div><div class="line"><span class="keyword">typedef</span> ... Cell;</div><div class="line"><span class="keyword">typedef</span> ... Vertex_handle;</div><div class="line"><span class="keyword">typedef</span> ... Cell_handle;</div><div class="line">};</div><div class="line"></div><div class="line"><span class="keyword">template</span> &lt; <span class="keyword">class </span>TDS = ... &gt; <span class="comment">// The default is some internal type faking a TDS</span></div><div class="line"><span class="keyword">class </span>Triangulation_ds_vertex_base_3</div><div class="line">{</div><div class="line"><span class="keyword">public</span>:</div><div class="line"><span class="keyword">template</span> &lt; <span class="keyword">class</span> TDS2 &gt;</div><div class="line"><span class="keyword">struct </span>Rebind_TDS {</div><div class="line"><span class="keyword">typedef</span> Triangulation_ds_vertex_base_3&lt;TDS2&gt; Other;</div><div class="line">};</div><div class="line">...</div><div class="line">};</div></div><!-- fragment --><p>When derivation is used for the vertex or cell base classes, which is the case at the geometric level with <code><a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Triangulation_3.tag:../Triangulation_3/" href="../Triangulation_3/classCGAL_1_1Triangulation__vertex__base__3.html">Triangulation_vertex_base_3</a></code>, then it gets slightly more involved because its base class has to be rebound as well:</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt; <span class="keyword">class</span> GT, <span class="keyword">class</span> Vb = Triangulation_ds_vertex_base_3&lt;&gt; &gt;</div><div class="line"><span class="keyword">class </span>Triangulation_vertex_base_3 : <span class="keyword">public</span> Vb</div><div class="line">{</div><div class="line"><span class="keyword">public</span>:</div><div class="line"><span class="keyword">template</span> &lt; <span class="keyword">class</span> TDS2 &gt;</div><div class="line"><span class="keyword">struct </span>Rebind_TDS {</div><div class="line"><span class="keyword">typedef</span> <span class="keyword">typename</span> Vb::template Rebind_TDS&lt;TDS2&gt;::Other Vb2;</div><div class="line"><span class="keyword">typedef</span> Triangulation_vertex_base_3&lt;GT, Vb2&gt; Other;</div><div class="line">};</div><div class="line">...</div><div class="line">};</div></div><!-- fragment --><h2><a class="anchor" id="tds3parallel"></a>
Parallel Operations</h2>
<p>The third template parameter of <code><a class="el" href="classCGAL_1_1Triangulation__data__structure__3.html" title="The class Triangulation_data_structure_3 stores a 3D-triangulation data structure and provides the op...">Triangulation_data_structure_3</a></code> is <code>Concurrency_tag</code>. It enables the use of a concurrent container (<code><a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/STL_Extension.tag:../STL_Extension/" href="../STL_Extension/classCGAL_1_1Concurrent__compact__container.html">Concurrent_compact_container</a></code>) to store vertices and cells. If it is <code><a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/STL_Extension.tag:../STL_Extension/" href="../STL_Extension/structCGAL_1_1Parallel__tag.html">Parallel_tag</a></code>, then <code>create_vertex</code>, <code>create_cell</code>, <code>delete_vertex</code> and <code>delete_cell</code> can be called concurrently.</p>
<h1><a class="anchor" id="TDS3secexamples"></a>
Examples</h1>
<h2><a class="anchor" id="TDS_3IncrementalConstruction"></a>
Incremental Construction</h2>
<p>The following example shows how to construct a 3D triangulation data structure by inserting vertices.</p>
<p><br />
<b>File</b> <a class="el" href="TDS_3_2tds_8cpp-example.html">TDS_3/tds.cpp</a> </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;CGAL/Triangulation_data_structure_3.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;fstream&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;cassert&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;vector&gt;</span></div><div class="line"></div><div class="line"><span class="keyword">typedef</span> <a class="code" href="classCGAL_1_1Triangulation__data__structure__3.html">CGAL::Triangulation_data_structure_3&lt;&gt;</a>      Tds;</div><div class="line"></div><div class="line"><span class="keyword">typedef</span> Tds::size_type                              size_type;</div><div class="line"><span class="keyword">typedef</span> Tds::Cell_handle                            Cell_handle;</div><div class="line"><span class="keyword">typedef</span> Tds::Vertex_handle                          Vertex_handle;</div><div class="line"></div><div class="line"><span class="keywordtype">int</span> main()</div><div class="line">{</div><div class="line">  Tds T;</div><div class="line"></div><div class="line">  assert( T.number_of_vertices() == 0 );</div><div class="line">  assert( T.dimension() == -2 );</div><div class="line">  assert( T.is_valid() );</div><div class="line"></div><div class="line">  std::vector&lt;Vertex_handle&gt; PV(7);</div><div class="line"></div><div class="line">  PV[0] = T.insert_increase_dimension();</div><div class="line">  assert( T.number_of_vertices() == 1 );</div><div class="line">  assert( T.dimension() == -1 );</div><div class="line">  assert( T.is_valid() );</div><div class="line"></div><div class="line">  <span class="comment">// each of the following insertions of vertices increases the dimension</span></div><div class="line">  <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> i=1; i&lt;5; i++ ) {</div><div class="line">    PV[i] = T.insert_increase_dimension(PV[0]);</div><div class="line">    assert( T.number_of_vertices() == (size_type) i+1 );</div><div class="line">    assert( T.dimension() == i-1 );</div><div class="line">    assert( T.is_valid() );</div><div class="line">  }</div><div class="line">  assert( T.number_of_cells() == 5 );</div><div class="line"></div><div class="line">  <span class="comment">// we now have a simplex in dimension 4</span></div><div class="line"></div><div class="line">  <span class="comment">// cell incident to PV[0]</span></div><div class="line">  Cell_handle c = PV[0]-&gt;cell();</div><div class="line">  <span class="keywordtype">int</span> ind;</div><div class="line">  <span class="keywordtype">bool</span> check = c-&gt;has_vertex( PV[0], ind );</div><div class="line">  assert( check );</div><div class="line">  <span class="comment">// PV[0] is the vertex of index ind in c</span></div><div class="line"></div><div class="line">  <span class="comment">// insertion of a new vertex in the facet opposite to PV[0]</span></div><div class="line">  PV[5] = T.insert_in_facet(c, ind);</div><div class="line"></div><div class="line">  assert( T.number_of_vertices() == 6 );</div><div class="line">  assert( T.dimension() == 3 );</div><div class="line">  assert( T.is_valid() );</div><div class="line"></div><div class="line">  <span class="comment">// insertion of a new vertex in c</span></div><div class="line">  PV[6] = T.insert_in_cell(c);</div><div class="line"></div><div class="line">  assert( T.number_of_vertices() == 7 );</div><div class="line">  assert( T.dimension() == 3 );</div><div class="line">  assert( T.is_valid() );</div><div class="line"></div><div class="line">  std::ofstream oFileT(<span class="stringliteral">"output_tds"</span>,std::ios::out);</div><div class="line">  <span class="comment">// writing file output_tds;</span></div><div class="line">  oFileT &lt;&lt; T;</div><div class="line"></div><div class="line">  <span class="keywordflow">return</span> 0;</div><div class="line">}</div></div><!-- fragment --><h2><a class="anchor" id="TDS_3CrossLinkingBetweena2Danda3DDataStructures"></a>
Cross-Linking Between a 2D and a 3D Data Structures</h2>
<p>This example program illustrates how to setup a 2D and a 3D triangulation data structures whose vertices respectively store vertex handles of the other one.</p>
<p><br />
<b>File</b> <a class="el" href="TDS_3_2linking_2d_and_3d_8cpp-example.html">TDS_3/linking_2d_and_3d.cpp</a> </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;CGAL/Triangulation_data_structure_2.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Triangulation_data_structure_3.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;cassert&gt;</span></div><div class="line"></div><div class="line"><span class="comment">// declare the 2D vertex base type, parametrized by some 3D TDS.</span></div><div class="line"><span class="keyword">template</span> &lt; <span class="keyword">typename</span> T3, <span class="keyword">typename</span> Vb = CGAL::Triangulation_ds_vertex_base_2&lt;&gt; &gt;</div><div class="line"><span class="keyword">class </span>My_vertex_2;</div><div class="line"></div><div class="line"><span class="comment">// declare the 3D vertex base type, parametrized by some 2D TDS.</span></div><div class="line"><span class="keyword">template</span> &lt; <span class="keyword">typename</span> T2, <span class="keyword">typename</span> Vb = CGAL::Triangulation_ds_vertex_base_3&lt;&gt; &gt;</div><div class="line"><span class="keyword">class </span>My_vertex_3;</div><div class="line"></div><div class="line"><span class="comment">// Then, we have to break the dependency cycle.</span></div><div class="line"></div><div class="line"><span class="comment">// we need to refer to a dummy 3D TDS.</span></div><div class="line"><span class="keyword">typedef</span> <a class="code" href="classCGAL_1_1Triangulation__ds__vertex__base__3.html">CGAL::Triangulation_ds_vertex_base_3&lt;&gt;::Triangulation_data_structure</a></div><div class="line">        Dummy_tds_3;</div><div class="line"><span class="comment">// the 2D TDS, initially plugging a dummy 3D TDS in the vertex type</span></div><div class="line"><span class="comment">// (to break the dependency cycle).</span></div><div class="line"><span class="keyword">typedef</span> CGAL::Triangulation_data_structure_2&lt;My_vertex_2&lt;Dummy_tds_3&gt; &gt;  TDS_2;</div><div class="line"><span class="comment">// the 3D TDS, here we can plug the 2D TDS directly.</span></div><div class="line"><span class="keyword">typedef</span> <a class="code" href="classCGAL_1_1Triangulation__data__structure__3.html">CGAL::Triangulation_data_structure_3&lt;My_vertex_3&lt;TDS_2&gt;</a> &gt;        TDS_3;</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">template</span> &lt; <span class="keyword">typename</span> T3, <span class="keyword">typename</span> Vb &gt;</div><div class="line"><span class="keyword">class </span>My_vertex_2</div><div class="line">  : <span class="keyword">public</span> Vb</div><div class="line">{</div><div class="line"><span class="keyword">public</span>:</div><div class="line">  <span class="keyword">typedef</span> <span class="keyword">typename</span> Vb::Face_handle    Face_handle;</div><div class="line"></div><div class="line">  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> TDS2&gt;</div><div class="line">  <span class="keyword">struct </span>Rebind_TDS {</div><div class="line">    <span class="keyword">typedef</span> <span class="keyword">typename</span> Vb::template Rebind_TDS&lt;TDS2&gt;::Other  Vb2;</div><div class="line">    <span class="comment">// we also have to break the cycle here by hardcoding TDS_3 instead of T3.</span></div><div class="line">    <span class="keyword">typedef</span> My_vertex_2&lt;TDS_3, Vb2&gt;                        Other;</div><div class="line">  };</div><div class="line"></div><div class="line">  My_vertex_2() {}</div><div class="line"></div><div class="line">  My_vertex_2(Face_handle f) : Vb(f) {}</div><div class="line"></div><div class="line">  <span class="comment">// we store a vertex handle of the 3D TDS.</span></div><div class="line">  <span class="keyword">typename</span> T3::Vertex_handle v3;</div><div class="line">};</div><div class="line"></div><div class="line"><span class="keyword">template</span> &lt; <span class="keyword">typename</span> T2, <span class="keyword">typename</span> Vb &gt;</div><div class="line"><span class="keyword">class </span>My_vertex_3</div><div class="line">  : <span class="keyword">public</span> Vb</div><div class="line">{</div><div class="line"><span class="keyword">public</span>:</div><div class="line">  <span class="keyword">typedef</span> <span class="keyword">typename</span> Vb::Cell_handle    Cell_handle;</div><div class="line"></div><div class="line">  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> TDS2&gt;</div><div class="line">  <span class="keyword">struct </span>Rebind_TDS {</div><div class="line">    <span class="keyword">typedef</span> <span class="keyword">typename</span> Vb::template Rebind_TDS&lt;TDS2&gt;::Other  Vb2;</div><div class="line">    <span class="keyword">typedef</span> My_vertex_3&lt;T2, Vb2&gt;                           Other;</div><div class="line">  };</div><div class="line"></div><div class="line">  My_vertex_3() {}</div><div class="line"></div><div class="line">  My_vertex_3(Cell_handle c) : Vb(c) {}</div><div class="line"></div><div class="line">  <span class="comment">// we store a vertex handle of the 2D TDS.</span></div><div class="line">  <span class="keyword">typename</span> T2::Vertex_handle v2;</div><div class="line">};</div><div class="line"></div><div class="line"></div><div class="line"><span class="keywordtype">int</span> main() {</div><div class="line">  TDS_2 t2;</div><div class="line">  TDS_3 t3;</div><div class="line"></div><div class="line">  TDS_2::Vertex_handle v2 = t2.insert_dim_up();</div><div class="line">  TDS_3::Vertex_handle v3 = t3.insert_increase_dimension();</div><div class="line"></div><div class="line">  v2-&gt;v3 = v3;</div><div class="line">  v3-&gt;v2 = v2;</div><div class="line"></div><div class="line">  assert(t2.is_valid());</div><div class="line">  assert(t3.is_valid());</div><div class="line">  <span class="keywordflow">return</span> 0;</div><div class="line">}</div></div><!-- fragment --><h1><a class="anchor" id="TDS_3Design"></a>
Design and Implementation History</h1>
<p>Monique Teillaud introduced the triangulation of the topological sphere \( S^d\) in \( \mathbb{R}^{d+1}\) to manage the underlying graph of geometric triangulations and handle degenerate dimensions <a class="el" href="citelist.html#CITEREF_t-tdtc-99">[2]</a>.</p>
<p>Sylvain Pion improved the software in several ways, in particular regarding the memory management.</p>
<p>In 2013, Cl√©ment Jamin added the ability to create/delete vertices and cells in parallel. This feature is used by the parallel triangulation. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<!-- The footer div is not part of the default but we require it to
move the footer to the bottom of the page. -->
<div id="footer">
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Mon Oct 1 2018 11:59:10 for CGAL 4.13 - 3D Triangulation Data Structure by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen" /></a> 1.8.13 </li>
  </ul>
</div>
</div>
</body>


</html>
