<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="canonical" href="https://doc.cgal.org/latest/Envelope_2/index.html"/>

<link rel="icon" type="image/png" href="../Manual/g-196x196-doc.png" />
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8" />
<meta http-equiv="X-UA-Compatible" content="IE=9" />
<meta name="generator" content="Doxygen 1.8.13" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>CGAL 4.13 - 2D Envelopes: User Manual</title>
<!-- <link href="../Manual/tabs.css" rel="stylesheet" type="text/css"/> -->
<script type="text/javascript" src="../Manual/jquery.js"></script>
<script type="text/javascript" src="../Manual/dynsections.js"></script>
<!-- Manually include treeview and search to avoid bloat and to fix
     paths to the directory Manual . -->
<!-- $.treeview -->
<!-- $.search -->
<link href="navtree.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="../Manual/resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="../Manual/search/search.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="../Manual/search/searchdata.js"></script>
<script type="text/javascript" src="../Manual/search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="../Manual/search/search.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="../Manual/search/search.js"></script>
<!-- Manually done below. -->
<link href="../Manual/stylesheet.css" rel="stylesheet" type="text/css" />
<!-- This should probably be an extrastylesheet instead of hardcoded. -->
<link href="../Manual/cgal_stylesheet.css" rel="stylesheet" type="text/css" />
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js"></script>
<script src="../Manual/hacks.js" type="text/javascript"></script>
<script src="modules.js" type="text/javascript"></script>
</head>
<body>
<!-- Custom mathjax -->
<!-- TODO: Remove this with MATHJAX_CODEFILE -->
<span style="display:none">\( \newcommand{\E}{\mathrm{E}} \) \( \newcommand{\A}{\mathrm{A}} \)
\( \newcommand{\R}{\mathrm{R}} \) \( \newcommand{\N}{\mathrm{N}} \) \( \newcommand{\Q}{\mathrm{Q}} \) \( \newcommand{\Z}{\mathrm{Z}} \)
\(
\def\ccSum #1#2#3{
  \sum_{#1}^{#2}{#3}
}
\def\ccProd #1#2#3{
  \sum_{#1}^{#2}{#3}
}\)
</span>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="back-nav">
  <ul>
    <li><a href="https://www.cgal.org/">cgal.org</a></li>
    <li><a href="../Manual/index.html">Top</a></li>
    <li><a href="../Manual/general_intro.html">Getting Started</a></li>
    <li><a href="../Manual/tutorials.html">Tutorials</a></li>
    <li><a href="../Manual/packages.html">Package Overview</a></li>
    <li><a href="../Manual/how_to_cite_cgal.html">Acknowledging CGAL</a></li>
  </ul>
  <!-- In a package SEARCHENGINE = false, so we cannot use 
       insertion. That's why we have to do it manually here. Notice
       that we also take pngs from the Manual. -->
  <div id="MSearchBox" class="MSearchBoxInactive">
    <span class="left">
      <img id="MSearchSelect" src="../Manual/search/mag_sel.png" onmouseover="return searchBox.OnSearchSelectShow()" onmouseout="return searchBox.OnSearchSelectHide()" alt="" />
      <input type="text" id="MSearchField" value="Search" accesskey="S" onfocus="searchBox.OnSearchFieldFocus(true)" onblur="searchBox.OnSearchFieldFocus(false)" onkeyup="searchBox.OnSearchFieldChange(event)" />
    </span><span class="right">
      <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../Manual/search/close.png" alt="" /></a>
    </span>
  </div>
</div>
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">CGAL 4.13 - 2D Envelopes
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- Code below is usually inserted by doxygen when SEARCHENGINE =
     true. Notice that the path to the search directory is adjusted to
     the top-level.-->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../Manual/search",false,'Search');
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow" onmouseover="return searchBox.OnSearchSelectShow()" onmouseout="return searchBox.OnSearchSelectHide()" onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>
<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" name="MSearchResults" id="MSearchResults">
</iframe>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync" style="display: none"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('index.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">User Manual </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="Chapter_Envelopes_of_Curves_in_2D"></a> <a class="anchor" id="chapterEnvelope2"></a>  </p><div id="autotoc" class="toc"></div>  <dl class="section author"><dt>Author</dt><dd>Ron Wein</dd></dl>
<p><a class="anchor" id="fig__LowEnv2Fig"></a></p><div class="image">
<img src="lwrenv.png" alt="lwrenv.png" />
</div>
   <div class="cgal_figure_caption">  <a class="el" href="index.html#fig__LowEnv2Fig">Figure 37.1</a> The lower envelope of a set of line segments and hyperbolic arc.  </div>  <br />

<h1><a class="anchor" id="Envelope_2Introduction"></a>
Introduction</h1>
<p>A continuous curve \( C\) in \( {\mathbb R}^2\) is called <em> \( x\)-monotone</em>, if every vertical line intersects it at a single point at most. For example, the circle \( x^2 + y^2 = 1\) is <em>not</em> \( xy\)-monotone as the vertical line \( x = 0\) intersects it at \( (0, -1)\) and at \( (0, 1)\); however, it is possible to split the circle into an upper part and a lower part, such that both of these parts are \( x\)-monotone. We consider vertical segments as <em>weakly</em> \( x\)-monotone, to properly handle inputs that contain such vertical curves.</p>
<p>An \( x\)-monotone curve can be represented as a univariate function \( y = C(x)\), defined over some continuous range \( R_C \subseteq {\mathbb R}\). Given a set \( {\cal C} = \{ C_1, C_2, \ldots, C_n \}\) of \( x\)-monotone curves, their <em>lower envelope</em> is defined as the point-wise minimum of all curves. Namely, the lower envelope of the set \( {\cal C}\) can be defined as the following function:</p>
<p class="formulaDsp">
\begin{eqnarray*} {\cal L}_{{\cal C}} (x) = \min_{1 \leq k \leq n}{\overline{C}_k (x)} \ , \end{eqnarray*}
</p>
<p>where we define \(\overline{C}_k(x) = C_k(x)\) for \(x \in R_{C_k}\), and \(\overline{C}_k(x) = \infty\) otherwise.</p>
<p>Similarly, the <em>upper envelope</em> of \({\cal C}\) is the point-wise maximum of the \(x\)-monotone curves in the set: </p><p class="formulaDsp">
\begin{eqnarray*} {\cal U}_{{\cal C}} (x) = \max_{1 \leq k \leq n}{\underline{C}_k (x)} \ , \end{eqnarray*}
</p>
<p> where in this case \( \underline{C}_k(x) = -\infty\) for \( x \not\in R_{C_k}\).</p>
<p>Given a set of \( x\)-monotone curves \( {\cal C}\), the <em>minimization diagram</em> of \( {\cal C}\) is a subdivision of the \( x\)-axis into cells, such that the identity of the curves that induce the lower envelope over a specific cell of the subdivision (an edge or a vertex) is the same. In non-degenerate situations, an edge - which represents a continuous interval on the \( x\)-axis - is induced by a single curve (or by no curves at all, if there are no \( x\)-monotone curves defined over the interval), and a vertex is induced by a single curve and corresponds to one of its endpoints, or by two curves and corresponds to their intersection point. The <em>maximization diagram</em> is symmetrically defined for upper envelopes. In the rest of this chapter, we refer to both these diagrams as <em>envelope diagrams</em>.</p>
<p>Lower and upper envelopes can be efficiently computed using a divide-and-conquer approach. First, note that the envelope diagram for a single \( x\)-monotone curve \( C_k\) is trivial to compute: we project the boundary of its range of definition \( R_{C_k}\) onto the \( x\)-axis and label the features it induces accordingly. Given a set \( {\cal D}\) of (non necessarily \( x\)-monotone) curves in \( {\mathbb R}^2\), we subdivide each curve into a finite number of weakly \( x\)-monotone curves, and obtain the set \( {\cal C}\). Then, we split the set into two disjoint subsets \( {\cal C}_1\) and \( {\cal C}_2\), and we compute their envelope diagrams recursively. Finally, we merge the diagrams in linear time by traversing both diagrams in parallel.</p>
<h1><a class="anchor" id="env2_secenv_diag"></a>
The Envelope Diagram</h1>
<p>The package basically contains two sets of free functions: <a class="el" href="group__PkgEnvelope2.html#ga6567d5008ff085e1e7ed4d8b4baaaf68"><code>lower_envelope_x_monotone_2(begin, end, diag)</code></a> (similarly <code><a class="el" href="group__PkgEnvelope2.html#ga5cf2e72a9a4680d5abc12ba16b43906e" title="Computes the upper envelope of a set of -monotone curves in , as given by the range [begin...">upper_envelope_x_monotone_2()</a></code>) construct the envelope diagram for a given range of \( x\)-monotone curves, while <a class="el" href="group__PkgEnvelope2.html#ga6567d5008ff085e1e7ed4d8b4baaaf68"><code>lower_envelope_2(begin, end, diag)</code></a> (similarly <code><a class="el" href="group__PkgEnvelope2.html#ga680a36e045fb4afea381c24423898c40" title="Computes the upper envelope of a set of curves in , as given by the range [begin, end)...">upper_envelope_2()</a></code>) construct the envelope diagram for a range of <em>arbitrary</em> (not necessarily \( x\)-monotone) curves. In this section we explain more on the structure of the envelope diagram these functions output.</p>
<p><a class="anchor" id="fig__env2_figmin_diag"></a></p><div class="image">
<img src="min_diag.png" alt="min_diag.png" />
</div>
   <div class="cgal_figure_caption">  <a class="el" href="index.html#fig__env2_figmin_diag">Figure 37.2</a> The lower envelope of eight line segments, labeled \( A, \ldots, H\), as constructed in <code>envelope_segments.cpp</code>. The minimization diagram is shown at the bottom, where each diagram vertex points to the point associated with it, and the labels of the segment that induce a diagram edge are displayed below this edge. Note that there exists one edge that represents an overlap (i.e., there are two segments that induce it), and there are also a few edges that represent empty intervals.  </div>  <br />

<p>A minimization diagram or a maximization diagram is represented by a model of the concept <code><a class="el" href="classEnvelopeDiagram__1.html" title="This concept defines the representation of an envelope diagram of a set of planar curve...">EnvelopeDiagram_1</a></code>. This concept defines the structure of the subdivision of the \( x\)-axis into 0-dimensional cells called <em>vertices</em>, and 1-dimensional cells called <em>edges</em>. The important property of this subdivision is that the identity of the curves that induce the lower envelope (or the upper envelope) over each cell is fixed.</p>
<p><a class="el" href="index.html#fig__env2_figmin_diag">Figure 37.2</a> shows the lower envelope of a set of eight line segments, and sketches the structure of their minimization diagram. Each diagram vertex \( v\) is associated with a point \( p_v\) on the envelope, which corresponds to either a curve endpoint or to an intersection point of two (or more) curves. The vertex is therefore associated with a set of \( x\)-monotone curves that induce the envelope over \( p_v\). Each vertex is incident to two edges, one lying to its left and the other to its right.</p>
<p>An edge in the envelope diagram represents a continuous portion of the \( x\)-axis, and is associated with a set of \( x\)-monotone curves that induce the envelope over this interval. Note that this set may be empty if no \( x\)-monotone curves are defined over this interval. In degenerate situations where curves overlap, there may be more than a single curve that induces the envelope over the interval the edge represents. An envelop diagram of a set of curves either consists of a single unbounded edge (in case the curve set is empty or if the envelope contains a single unbounded curve that is below or above all other curves), or at least one vertex and two unbounded edges, while each additional vertex comes along with an additional edge. It is possible to directly access the <em>leftmost</em> edge, representing the unbounded interval that starts at \( -\infty\), and the <em>rightmost</em> edge, representing the unbounded interval that ends at \( \infty\). (In the example depicted in <a class="el" href="index.html#fig__env2_figmin_diag">Figure 37.2</a> we have only bounded curves, so the leftmost and rightmost edges represent empty intervals. This is not the case when we deal, for example, with envelopes of sets of lines.)</p>
<p>Any model of the <code><a class="el" href="classEnvelopeDiagram__1.html" title="This concept defines the representation of an envelope diagram of a set of planar curve...">EnvelopeDiagram_1</a></code> concept must define a geometric traits class, which in turn defines the <code><a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Kernel_23.tag:../Kernel_23/" href="../Kernel_23/classCGAL_1_1Point__2.html">Point_2</a></code> and <code>X_monotone_curve_2</code> types defined with the diagram features. The geometric traits class must be a model of the <code><a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Arrangement_on_surface_2.tag:../Arrangement_on_surface_2/" href="../Arrangement_on_surface_2/classArrangementXMonotoneTraits__2.html">ArrangementXMonotoneTraits_2</a></code> concept in case we construct envelopes of \( x\)-monotone curves. If we are interested in handling arbitrary (not necessarily \( x\)-monotone) curves, the traits class must be a model of the <code><a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Arrangement_on_surface_2.tag:../Arrangement_on_surface_2/" href="../Arrangement_on_surface_2/classArrangementTraits__2.html">ArrangementTraits_2</a></code> concept. This concepts refined the <code><a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Arrangement_on_surface_2.tag:../Arrangement_on_surface_2/" href="../Arrangement_on_surface_2/classArrangementXMonotoneTraits__2.html">ArrangementXMonotoneTraits_2</a></code> concept; a traits class that models this concepts must also defines a <code>Curve_2</code> type, representing an arbitrary planar curve, and provide a functor for subdividing such curves into \( x\)-monotone subcurves.</p>
<h1><a class="anchor" id="Envelope_2Examples"></a>
Examples</h1>
<h2><a class="anchor" id="Envelope_2ExampleforEnvelopeofLineSegments"></a>
Example for Envelope of Line Segments</h2>
<p>The following example demonstrates how to compute and traverse the minimization diagram of line segments, as illustrated in <a class="el" href="index.html#fig__env2_figmin_diag">Figure 37.2</a>. We use the curve-data traits instantiated by the <code><a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Arrangement_on_surface_2.tag:../Arrangement_on_surface_2/" href="../Arrangement_on_surface_2/classCGAL_1_1Arr__segment__traits__2.html">Arr_segment_traits_2</a></code> class, in order to attach a label (a <code>char</code> in this case) to each input segment. We use these labels when we print the minimization diagram.</p>
<p><br />
<b>File</b> <a class="el" href="Envelope_2_2envelope_segments_8cpp-example.html">Envelope_2/envelope_segments.cpp</a> </p><div class="fragment"><div class="line"><span class="comment">// Constructing the lower envelope of a set of segments.</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Exact_rational.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Cartesian.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Arr_segment_traits_2.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Arr_curve_data_traits_2.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Envelope_diagram_1.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/envelope_2.h&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;list&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div><div class="line"></div><div class="line"><span class="keyword">typedef</span> CGAL::Exact_rational                            Number_type;</div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Kernel_23.tag:../Kernel_23/" href="../Kernel_23/structCGAL_1_1Cartesian.html">CGAL::Cartesian&lt;Number_type&gt;</a>                    <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Kernel_23.tag:../Kernel_23/" href="../Kernel_23/namespaceKernel.html">Kernel</a>;</div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Arrangement_on_surface_2.tag:../Arrangement_on_surface_2/" href="../Arrangement_on_surface_2/classCGAL_1_1Arr__segment__traits__2.html">CGAL::Arr_segment_traits_2&lt;Kernel&gt;</a>              Segment_traits_2;</div><div class="line"><span class="keyword">typedef</span> Segment_traits_2::X_monotone_curve_2            Segment_2;</div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Arrangement_on_surface_2.tag:../Arrangement_on_surface_2/" href="../Arrangement_on_surface_2/classCGAL_1_1Arr__curve__data__traits__2.html">CGAL::Arr_curve_data_traits_2</a>&lt;Segment_traits_2,</div><div class="line">                                      <span class="keywordtype">char</span>&gt;             Traits_2;</div><div class="line"><span class="keyword">typedef</span> Traits_2::Point_2                               Point_2;</div><div class="line"><span class="keyword">typedef</span> Traits_2::X_monotone_curve_2                    Labeled_segment_2;</div><div class="line"><span class="keyword">typedef</span> <a class="code" href="classCGAL_1_1Envelope__diagram__1.html">CGAL::Envelope_diagram_1&lt;Traits_2&gt;</a>              Diagram_1;</div><div class="line"></div><div class="line"><span class="keywordtype">int</span> main ()</div><div class="line">{</div><div class="line">  <span class="comment">// Consrtuct the input segments and label them 'A' ... 'H'.</span></div><div class="line">  std::list&lt;Labeled_segment_2&gt;   segments;</div><div class="line"></div><div class="line">  segments.push_back (Labeled_segment_2 (Segment_2 (Point_2 (0, 1),</div><div class="line">                                                    Point_2 (2, 3)), <span class="charliteral">'A'</span>));</div><div class="line">  segments.push_back (Labeled_segment_2 (Segment_2 (Point_2 (1, 2),</div><div class="line">                                                    Point_2 (4, 5)), <span class="charliteral">'B'</span>));</div><div class="line">  segments.push_back (Labeled_segment_2 (Segment_2 (Point_2 (1, 5),</div><div class="line">                                                    Point_2 (7, 2)), <span class="charliteral">'C'</span>));</div><div class="line">  segments.push_back (Labeled_segment_2 (Segment_2 (Point_2 (4, 2),</div><div class="line">                                                    Point_2 (6, 4)), <span class="charliteral">'D'</span>));</div><div class="line">  segments.push_back (Labeled_segment_2 (Segment_2 (Point_2 (8, 3),</div><div class="line">                                                    Point_2 (8, 6)), <span class="charliteral">'E'</span>));</div><div class="line">  segments.push_back (Labeled_segment_2 (Segment_2 (Point_2 (9, 2),</div><div class="line">                                                    Point_2 (12, 4)), <span class="charliteral">'F'</span>));</div><div class="line">  segments.push_back (Labeled_segment_2 (Segment_2 (Point_2 (10, 2),</div><div class="line">                                                    Point_2 (12, 1)), <span class="charliteral">'G'</span>));</div><div class="line">  segments.push_back (Labeled_segment_2 (Segment_2 (Point_2 (11, 0),</div><div class="line">                                                    Point_2 (11, 5)), <span class="charliteral">'H'</span>));</div><div class="line"></div><div class="line">  <span class="comment">// Compute the minimization diagram that represents their lower envelope.</span></div><div class="line">  Diagram_1              min_diag;</div><div class="line"></div><div class="line">  <a class="code" href="group__PkgEnvelope2.html#ga6567d5008ff085e1e7ed4d8b4baaaf68">lower_envelope_x_monotone_2</a> (segments.begin(), segments.end(),</div><div class="line">                               min_diag);</div><div class="line"></div><div class="line">  <span class="comment">// Print the minimization diagram.</span></div><div class="line">  Diagram_1::Edge_const_handle     e = min_diag.leftmost();</div><div class="line">  Diagram_1::Vertex_const_handle   v;</div><div class="line">  Diagram_1::Curve_const_iterator  cit;</div><div class="line"></div><div class="line">  <span class="keywordflow">while</span> (e != min_diag.rightmost())</div><div class="line">  {</div><div class="line">    std::cout &lt;&lt; <span class="stringliteral">"Edge:"</span>;</div><div class="line">    <span class="keywordflow">if</span> (! e-&gt;is_empty())</div><div class="line">    {</div><div class="line">      <span class="keywordflow">for</span> (cit = e-&gt;curves_begin(); cit != e-&gt;curves_end(); ++cit)</div><div class="line">        std::cout &lt;&lt; <span class="charliteral">' '</span> &lt;&lt; cit-&gt;data();</div><div class="line">    }</div><div class="line">    <span class="keywordflow">else</span></div><div class="line">      std::cout &lt;&lt; <span class="stringliteral">" [empty]"</span>;</div><div class="line">    std::cout &lt;&lt; std::endl;</div><div class="line"></div><div class="line">    v = e-&gt;right();</div><div class="line">    std::cout &lt;&lt; <span class="stringliteral">"Vertex ("</span> &lt;&lt; v-&gt;point() &lt;&lt; <span class="stringliteral">"):"</span>;</div><div class="line">    <span class="keywordflow">for</span> (cit = v-&gt;curves_begin(); cit != v-&gt;curves_end(); ++cit)</div><div class="line">      std::cout &lt;&lt; <span class="charliteral">' '</span> &lt;&lt; cit-&gt;data();</div><div class="line">    std::cout &lt;&lt; std::endl;</div><div class="line"></div><div class="line">    e = v-&gt;right();</div><div class="line">  }</div><div class="line">  CGAL_assertion (e-&gt;is_empty());</div><div class="line">  std::cout &lt;&lt; <span class="stringliteral">"Edge: [empty]"</span> &lt;&lt; std::endl;</div><div class="line"></div><div class="line">  <span class="keywordflow">return</span> (0);</div><div class="line">}</div></div><!-- fragment --><h2><a class="anchor" id="Envelope_2ExampleforComputingtheConvexHull"></a>
Example for Computing the Convex Hull with Envelopes</h2>
<p>The next example computes the convex hull of a set of input points by constructing envelopes of unbounded curves, in our case lines that are dual to the input points. Here use the <code><a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Arrangement_on_surface_2.tag:../Arrangement_on_surface_2/" href="../Arrangement_on_surface_2/classCGAL_1_1Arr__linear__traits__2.html">Arr_linear_traits_2</a></code> class to compute the lower envelope of the set of dual lines. We read a set of points \( {\cal P} = p_1, \ldots, p_n\) from an input file, and construct the corresponding dual lines \( {\cal P}^{*} = p^{*}_1, \ldots, p^{*}_n\), where the line \( p^{*}\) dual to a point \( p = (p_x, p_y)\) is given by \( y = p_x x - p_y\). We then compute the convex hull of the point-set \( {\cal P}\), using the fact that the lines that form the lower envelope of \( {\cal P}^{*}\) are dual to the points along the <em>upper</em> part of \( {\cal P}\)'s convex hull, and the lines that form the upper envelope of \( {\cal P}^{*}\) are dual to the points along the <em>lower</em> part of the convex hull; see, e.g., <a class="el" href="citelist.html#CITEREF_bkos-cgaa-97">[1]</a>, Section 11.4 for more details. Note that the leftmost edge of the minimization diagram is associated with the same line as the rightmost edge of the maximization diagram, and vice-verse. We can therefore skip the rightmost edges of both diagrams.</p>
<p><br />
<b>File</b> <a class="el" href="Envelope_2_2convex_hull_2_8cpp-example.html">Envelope_2/convex_hull_2.cpp</a> </p><div class="fragment"><div class="line"><span class="comment">// Compute the convex hull of set of points using the lower envelope and upper</span></div><div class="line"><span class="comment">// envelopes of their dual line.</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Exact_rational.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Cartesian.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Arr_linear_traits_2.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Arr_curve_data_traits_2.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Envelope_diagram_1.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/envelope_2.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;vector&gt;</span></div><div class="line"></div><div class="line"><span class="keyword">typedef</span> CGAL::Exact_rational                             Number_type;</div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Kernel_23.tag:../Kernel_23/" href="../Kernel_23/structCGAL_1_1Cartesian.html">CGAL::Cartesian&lt;Number_type&gt;</a>                     <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Kernel_23.tag:../Kernel_23/" href="../Kernel_23/namespaceKernel.html">Kernel</a>;</div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Arrangement_on_surface_2.tag:../Arrangement_on_surface_2/" href="../Arrangement_on_surface_2/classCGAL_1_1Arr__linear__traits__2.html">CGAL::Arr_linear_traits_2&lt;Kernel&gt;</a>                Linear_traits_2;</div><div class="line"><span class="keyword">typedef</span> Linear_traits_2::Point_2                         Point_2;</div><div class="line"><span class="keyword">typedef</span> Linear_traits_2::Line_2                          Line_2;</div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Arrangement_on_surface_2.tag:../Arrangement_on_surface_2/" href="../Arrangement_on_surface_2/classCGAL_1_1Arr__curve__data__traits__2.html">CGAL::Arr_curve_data_traits_2</a>&lt;Linear_traits_2,</div><div class="line">                                      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>&gt;      Traits_2;</div><div class="line"><span class="keyword">typedef</span> Traits_2::X_monotone_curve_2                     Dual_line_2;</div><div class="line"><span class="keyword">typedef</span> <a class="code" href="classCGAL_1_1Envelope__diagram__1.html">CGAL::Envelope_diagram_1&lt;Traits_2&gt;</a>               Diagram_1;</div><div class="line"></div><div class="line"><span class="keywordtype">int</span> main (<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>* argv[])</div><div class="line">{</div><div class="line">  <span class="comment">// Read the points from the input file.</span></div><div class="line">  <span class="keyword">const</span> <span class="keywordtype">char</span>* filename = (argc &gt; 1) ? argv[1] : <span class="stringliteral">"ch_points.dat"</span>;</div><div class="line">  std::ifstream in_file(filename);</div><div class="line">  <span class="keywordflow">if</span> (!in_file.is_open()) {</div><div class="line">    std::cerr &lt;&lt; <span class="stringliteral">"Failed to open "</span> &lt;&lt; filename &lt;&lt; <span class="stringliteral">" ..."</span> &lt;&lt; std::endl;</div><div class="line">    <span class="keywordflow">return</span> -1;</div><div class="line">  }</div><div class="line"></div><div class="line">  <span class="comment">// Read the points from the file, and construct their dual lines.</span></div><div class="line">  std::list&lt;Dual_line_2&gt;  dual_lines;</div><div class="line"></div><div class="line">  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>            n;</div><div class="line">  in_file &gt;&gt; n;</div><div class="line">  std::vector&lt;Point_2&gt;    points;</div><div class="line">  points.resize(n);</div><div class="line"></div><div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> k = 0; k &lt; n; ++k) {</div><div class="line">    <span class="keywordtype">int</span> px, py;</div><div class="line">    in_file &gt;&gt; px &gt;&gt; py;</div><div class="line">    points[k] = Point_2 (px, py);</div><div class="line"></div><div class="line">    <span class="comment">// The line dual to the point (p_x, p_y) is y = p_x*x - p_y,</span></div><div class="line">    <span class="comment">// or: p_x*x - y - p_y = 0:</span></div><div class="line">    Line_2 line = Line_2 (Number_type(px), Number_type(-1), Number_type(-py));</div><div class="line"></div><div class="line">    <span class="comment">// Generate the x-monotone curve based on the line and the point index.</span></div><div class="line">    dual_lines.push_back (Dual_line_2 (line, k));</div><div class="line">  }</div><div class="line">  in_file.close();</div><div class="line"></div><div class="line">  <span class="comment">// Compute the lower envelope of dual lines, which corresponds to the upper</span></div><div class="line">  <span class="comment">// part of the convex hull, and their upper envelope, which corresponds to</span></div><div class="line">  <span class="comment">// the lower part of the convex hull.</span></div><div class="line">  Diagram_1              min_diag;</div><div class="line">  Diagram_1              max_diag;</div><div class="line">  <a class="code" href="group__PkgEnvelope2.html#ga6567d5008ff085e1e7ed4d8b4baaaf68">lower_envelope_x_monotone_2</a>(dual_lines.begin(), dual_lines.end(), min_diag);</div><div class="line">  <a class="code" href="group__PkgEnvelope2.html#ga5cf2e72a9a4680d5abc12ba16b43906e">upper_envelope_x_monotone_2</a>(dual_lines.begin(), dual_lines.end(), max_diag);</div><div class="line"></div><div class="line">  <span class="comment">// Output the points along the boundary convex hull in counterclockwise</span></div><div class="line">  <span class="comment">// order. We start by traversing the minimization diagram from left to</span></div><div class="line">  <span class="comment">// right, then the maximization diagram from right to left.</span></div><div class="line">  std::cout &lt;&lt; <span class="stringliteral">"The convex hull of "</span> &lt;&lt; points.size() &lt;&lt; <span class="stringliteral">" input points:"</span>;</div><div class="line">  Diagram_1::Edge_const_handle  e = min_diag.leftmost();</div><div class="line">  <span class="keywordflow">while</span> (e != min_diag.rightmost()) {</div><div class="line">    std::cout &lt;&lt; <span class="stringliteral">" ("</span> &lt;&lt; points[e-&gt;curve().data()] &lt;&lt; <span class="charliteral">')'</span>;</div><div class="line">    e = e-&gt;right()-&gt;right();</div><div class="line">  }</div><div class="line"></div><div class="line">  <span class="comment">// Handle the degenerate case of a vertical convex hull edge:</span></div><div class="line">  <span class="keywordflow">if</span> (e-&gt;curve().data() != max_diag.leftmost()-&gt;curve().data())</div><div class="line">    std::cout &lt;&lt; <span class="stringliteral">" ("</span> &lt;&lt; points[e-&gt;curve().data()] &lt;&lt; <span class="charliteral">')'</span>;</div><div class="line">  </div><div class="line">  e = max_diag.leftmost();</div><div class="line">  <span class="keywordflow">while</span> (e != max_diag.rightmost()) {</div><div class="line">    std::cout &lt;&lt; <span class="stringliteral">" ("</span> &lt;&lt; points[e-&gt;curve().data()] &lt;&lt; <span class="charliteral">')'</span>;</div><div class="line">    e = e-&gt;right()-&gt;right();</div><div class="line">  }</div><div class="line">  std::cout &lt;&lt; std::endl;</div><div class="line"></div><div class="line">  <span class="keywordflow">return</span> 0;</div><div class="line">}</div></div><!-- fragment --><p><a class="anchor" id="fig__env2_figex_circ"></a></p><div class="image">
<img src="ex_circle.png" alt="ex_circle.png" />
</div>
   <div class="cgal_figure_caption">  <a class="el" href="index.html#fig__env2_figex_circ">Figure 37.3</a> A set of four circles, as constructed in <a class="el" href="Envelope_2_2envelope_circles_8cpp-example.html">Envelope_2/envelope_circles.cpp</a>. The lower envelope and the upper envelope are shown using thick dashed lines of different colors respectively.  </div>  <br />

<h2><a class="anchor" id="Envelope_2ExampleforEnvelopeofNonLinearCurves"></a>
Example for Envelope of Non-Linear Curves</h2>
<p>We conclude by an example of envelopes of non-linear curves. We use the <code><a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Arrangement_on_surface_2.tag:../Arrangement_on_surface_2/" href="../Arrangement_on_surface_2/classCGAL_1_1Arr__circle__segment__traits__2.html">Arr_circle_segment_traits_2</a></code> class to construct the lower and the upper envelopes of a set of four circles, as depicted in <a class="el" href="index.html#fig__env2_figex_circ">Figure 37.3</a>. Note that unlike the two previous examples, here our curves are not \( x\)-monotone, so we use the functions that compute envelopes of arbitrary curves.</p>
<p><br />
<b>File</b> <a class="el" href="Envelope_2_2envelope_circles_8cpp-example.html">Envelope_2/envelope_circles.cpp</a> </p><div class="fragment"><div class="line"><span class="comment">// Constructing the envelopes of a set of circles using the circle-segment</span></div><div class="line"><span class="comment">// traits.</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Exact_rational.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Cartesian.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Arr_circle_segment_traits_2.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Arrangement_2.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Envelope_diagram_1.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/envelope_2.h&gt;</span></div><div class="line"></div><div class="line"><span class="keyword">typedef</span> CGAL::Exact_rational                          Number_type;</div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Kernel_23.tag:../Kernel_23/" href="../Kernel_23/structCGAL_1_1Cartesian.html">CGAL::Cartesian&lt;Number_type&gt;</a>                  Kernel;</div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Kernel_23.tag:../Kernel_23/" href="../Kernel_23/classKernel_1_1Point__2.html">Kernel::Point_2</a>                               Kernel_point_2;</div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Kernel_23.tag:../Kernel_23/" href="../Kernel_23/classKernel_1_1Circle__2.html">Kernel::Circle_2</a>                              Circle_2;</div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Arrangement_on_surface_2.tag:../Arrangement_on_surface_2/" href="../Arrangement_on_surface_2/classCGAL_1_1Arr__circle__segment__traits__2.html">CGAL::Arr_circle_segment_traits_2&lt;Kernel&gt;</a>     Traits_2;</div><div class="line"><span class="keyword">typedef</span> Traits_2::Curve_2                             Curve_2;</div><div class="line"><span class="keyword">typedef</span> <a class="code" href="classCGAL_1_1Envelope__diagram__1.html">CGAL::Envelope_diagram_1&lt;Traits_2&gt;</a>            Diagram_1;</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> print_diagram (<span class="keyword">const</span> Diagram_1&amp; diag)</div><div class="line">{</div><div class="line">  Diagram_1::Edge_const_handle     e = diag.leftmost();</div><div class="line">  Diagram_1::Vertex_const_handle   v;</div><div class="line"></div><div class="line">  <span class="keywordflow">while</span> (e != diag.rightmost())</div><div class="line">  {</div><div class="line">    std::cout &lt;&lt; <span class="stringliteral">"Edge: "</span>;</div><div class="line">    <span class="keywordflow">if</span> (! e-&gt;is_empty())</div><div class="line">    {</div><div class="line">      Circle_2      circ = e-&gt;curve().supporting_circle();</div><div class="line">      std::cout &lt;&lt; <span class="stringliteral">" (x - "</span> &lt;&lt; <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Algebraic_foundations.tag:../Algebraic_foundations/" href="../Algebraic_foundations/group__PkgAlgebraicFoundations.html#ga1f1bcd74fce34fd532445590bbda5cd5">CGAL::to_double</a>(circ.center().x()) &lt;&lt; <span class="stringliteral">")^2 +"</span></div><div class="line">                &lt;&lt; <span class="stringliteral">" (y - "</span> &lt;&lt; <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Algebraic_foundations.tag:../Algebraic_foundations/" href="../Algebraic_foundations/group__PkgAlgebraicFoundations.html#ga1f1bcd74fce34fd532445590bbda5cd5">CGAL::to_double</a>(circ.center().y()) &lt;&lt; <span class="stringliteral">")^2 = "</span></div><div class="line">                &lt;&lt; <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Algebraic_foundations.tag:../Algebraic_foundations/" href="../Algebraic_foundations/group__PkgAlgebraicFoundations.html#ga1f1bcd74fce34fd532445590bbda5cd5">CGAL::to_double</a>(circ.squared_radius()) &lt;&lt; std::endl;</div><div class="line">    }</div><div class="line">    <span class="keywordflow">else</span></div><div class="line">      std::cout &lt;&lt; <span class="stringliteral">" [empty]"</span> &lt;&lt; std::endl;</div><div class="line"></div><div class="line">    v = e-&gt;right();</div><div class="line">    std::cout &lt;&lt; <span class="stringliteral">"Vertex ("</span> &lt;&lt; <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Algebraic_foundations.tag:../Algebraic_foundations/" href="../Algebraic_foundations/group__PkgAlgebraicFoundations.html#ga1f1bcd74fce34fd532445590bbda5cd5">CGAL::to_double</a>(v-&gt;point().x()) &lt;&lt; <span class="charliteral">' '</span></div><div class="line">              &lt;&lt; <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Algebraic_foundations.tag:../Algebraic_foundations/" href="../Algebraic_foundations/group__PkgAlgebraicFoundations.html#ga1f1bcd74fce34fd532445590bbda5cd5">CGAL::to_double</a>(v-&gt;point().y()) &lt;&lt; <span class="charliteral">')'</span> &lt;&lt; std::endl;</div><div class="line"></div><div class="line">    e = v-&gt;right();</div><div class="line">  }</div><div class="line">  CGAL_assertion (e-&gt;is_empty());</div><div class="line">  std::cout &lt;&lt; <span class="stringliteral">"Edge: [empty]"</span> &lt;&lt; std::endl;</div><div class="line"></div><div class="line">  <span class="keywordflow">return</span>;</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">int</span> main ()</div><div class="line">{</div><div class="line">  <span class="comment">// Create four input circles.</span></div><div class="line">  Curve_2          circles[4];</div><div class="line"></div><div class="line">  circles[0] = Circle_2 (Kernel_point_2 (1, 3), <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Algebraic_foundations.tag:../Algebraic_foundations/" href="../Algebraic_foundations/group__PkgAlgebraicFoundations.html#ga07001b5ddc5c43096c811c91a306be9a">CGAL::square</a>(2));</div><div class="line">  circles[1] = Circle_2 (Kernel_point_2 (4, 5), <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Algebraic_foundations.tag:../Algebraic_foundations/" href="../Algebraic_foundations/group__PkgAlgebraicFoundations.html#ga07001b5ddc5c43096c811c91a306be9a">CGAL::square</a>(4));</div><div class="line">  circles[2] = Circle_2 (Kernel_point_2 (5, 1), <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Algebraic_foundations.tag:../Algebraic_foundations/" href="../Algebraic_foundations/group__PkgAlgebraicFoundations.html#ga07001b5ddc5c43096c811c91a306be9a">CGAL::square</a>(1));</div><div class="line">  circles[3] = Circle_2 (Kernel_point_2 (6, 7), <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Algebraic_foundations.tag:../Algebraic_foundations/" href="../Algebraic_foundations/group__PkgAlgebraicFoundations.html#ga07001b5ddc5c43096c811c91a306be9a">CGAL::square</a>(2));</div><div class="line"></div><div class="line">  <span class="comment">// Compute the minimization diagram that represents their lower envelope.</span></div><div class="line">  Diagram_1              min_diag;</div><div class="line"></div><div class="line">  <a class="code" href="group__PkgEnvelope2.html#gac7c1cea8786016979758adab53e9686f">lower_envelope_2</a> (&amp;(circles[0]), &amp;(circles[4]), min_diag);</div><div class="line">  print_diagram (min_diag);</div><div class="line"></div><div class="line">  <span class="comment">// Compute the maximization diagram that represents the upper envelope.</span></div><div class="line">  Diagram_1              max_diag;</div><div class="line"></div><div class="line">  <a class="code" href="group__PkgEnvelope2.html#ga680a36e045fb4afea381c24423898c40">upper_envelope_2</a> (&amp;(circles[0]), &amp;(circles[4]), max_diag);</div><div class="line">  print_diagram (max_diag);</div><div class="line"></div><div class="line">  <span class="keywordflow">return</span> (0);</div><div class="line">}</div></div><!-- fragment --> </div></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<!-- The footer div is not part of the default but we require it to
move the footer to the bottom of the page. -->
<div id="footer">
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Mon Oct 1 2018 11:58:52 for CGAL 4.13 - 2D Envelopes by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen" /></a> 1.8.13 </li>
  </ul>
</div>
</div>
</body>


</html>
