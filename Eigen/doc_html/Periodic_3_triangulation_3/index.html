<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="canonical" href="https://doc.cgal.org/latest/Periodic_3_triangulation_3/index.html"/>

<link rel="icon" type="image/png" href="../Manual/g-196x196-doc.png" />
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8" />
<meta http-equiv="X-UA-Compatible" content="IE=9" />
<meta name="generator" content="Doxygen 1.8.13" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>CGAL 4.13 - 3D Periodic Triangulations: User Manual</title>
<!-- <link href="../Manual/tabs.css" rel="stylesheet" type="text/css"/> -->
<script type="text/javascript" src="../Manual/jquery.js"></script>
<script type="text/javascript" src="../Manual/dynsections.js"></script>
<!-- Manually include treeview and search to avoid bloat and to fix
     paths to the directory Manual . -->
<!-- $.treeview -->
<!-- $.search -->
<link href="navtree.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="../Manual/resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="../Manual/search/search.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="../Manual/search/searchdata.js"></script>
<script type="text/javascript" src="../Manual/search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="../Manual/search/search.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="../Manual/search/search.js"></script>
<!-- Manually done below. -->
<link href="../Manual/stylesheet.css" rel="stylesheet" type="text/css" />
<!-- This should probably be an extrastylesheet instead of hardcoded. -->
<link href="../Manual/cgal_stylesheet.css" rel="stylesheet" type="text/css" />
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js"></script>
<script src="../Manual/hacks.js" type="text/javascript"></script>
<script src="modules.js" type="text/javascript"></script>
</head>
<body>
<!-- Custom mathjax -->
<!-- TODO: Remove this with MATHJAX_CODEFILE -->
<span style="display:none">\( \newcommand{\E}{\mathrm{E}} \) \( \newcommand{\A}{\mathrm{A}} \)
\( \newcommand{\R}{\mathrm{R}} \) \( \newcommand{\N}{\mathrm{N}} \) \( \newcommand{\Q}{\mathrm{Q}} \) \( \newcommand{\Z}{\mathrm{Z}} \)
\(
\def\ccSum #1#2#3{
  \sum_{#1}^{#2}{#3}
}
\def\ccProd #1#2#3{
  \sum_{#1}^{#2}{#3}
}\)
</span>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="back-nav">
  <ul>
    <li><a href="https://www.cgal.org/">cgal.org</a></li>
    <li><a href="../Manual/index.html">Top</a></li>
    <li><a href="../Manual/general_intro.html">Getting Started</a></li>
    <li><a href="../Manual/tutorials.html">Tutorials</a></li>
    <li><a href="../Manual/packages.html">Package Overview</a></li>
    <li><a href="../Manual/how_to_cite_cgal.html">Acknowledging CGAL</a></li>
  </ul>
  <!-- In a package SEARCHENGINE = false, so we cannot use 
       insertion. That's why we have to do it manually here. Notice
       that we also take pngs from the Manual. -->
  <div id="MSearchBox" class="MSearchBoxInactive">
    <span class="left">
      <img id="MSearchSelect" src="../Manual/search/mag_sel.png" onmouseover="return searchBox.OnSearchSelectShow()" onmouseout="return searchBox.OnSearchSelectHide()" alt="" />
      <input type="text" id="MSearchField" value="Search" accesskey="S" onfocus="searchBox.OnSearchFieldFocus(true)" onblur="searchBox.OnSearchFieldFocus(false)" onkeyup="searchBox.OnSearchFieldChange(event)" />
    </span><span class="right">
      <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../Manual/search/close.png" alt="" /></a>
    </span>
  </div>
</div>
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">CGAL 4.13 - 3D Periodic Triangulations
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- Code below is usually inserted by doxygen when SEARCHENGINE =
     true. Notice that the path to the search directory is adjusted to
     the top-level.-->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../Manual/search",false,'Search');
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow" onmouseover="return searchBox.OnSearchSelectShow()" onmouseout="return searchBox.OnSearchSelectHide()" onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>
<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" name="MSearchResults" id="MSearchResults">
</iframe>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync" style="display: none"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('index.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">User Manual </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="Chapter_3D_Periodic_Triangulations"></a><a class="anchor" id="chapterP3Triangulation3"></a>  </p><div id="autotoc" class="toc"></div> 
<dl class="section author"><dt>Authors</dt><dd>Manuel Caroli, Aymeric Pellé, Mael Rouxel-Labbé and Monique Teillaud</dd></dl>
<div class="image">
<img src="p3Delaunay3.jpg" alt="p3Delaunay3.jpg" />
</div>
 <p>The periodic 3D-triangulation class of <span style="font-variant: small-caps;">CGAL</span> is designed to represent the triangulations of a set of points in the three-dimensional flat torus. The triangulation forms a partition of the space it is computed in. It is a simplicial complex, i.e. it contains all incident \( j\)-simplices ( \( j&lt;k\)) of any \( k\)-simplex and two \( k\)-simplices either do not intersect or share a common \( j\)-face, \( j&lt;k\). The occurring simplices of dimension up to three are called <em>vertex</em>, <em>edge</em>, <em>facet</em>, and <em>cell</em>, respectively.</p>
<h1><a class="anchor" id="P3Triangulation3secspace"></a>
The Flat Torus</h1>
<p>The 3D Periodic Triangulation package computes triangulations in the space \( \mathbb T_c^3\), which is defined as follows: Let \( c\in\mathbb R\setminus\{0\}\) and \( G\) be the group \( (c\cdot\mathbb Z^3, +)\), where \( c\cdot\mathbb Z\) denotes the set containing all integer multiples of \( c\). The flat torus is the quotient space: \( \mathbb T_c^3:=\mathbb R^3/G\). The parameter \( c\) defines the period.</p>
<p>The elements of \( \mathbb T_c^3\) are the equivalence classes of sets of points in \( \mathbb R^3\). We call these points <em>representatives</em> of an element of \( \mathbb T_c^3\). The implementation works not directly on elements of \( \mathbb T_c^3\) but on some representatives in \( \mathbb R^3\). So there need to be distinguished representatives to work on. Given \( \alpha\), \( \beta\), and \( \gamma\), the cube \( [\alpha,\alpha+c)\times[\beta,\beta+c)\times[\gamma,\gamma+c)\) contains exactly one representative of each element in \( \mathbb T_c^3\). We call it <em>original domain</em>. From now on, when we talk about <em>points</em>, we generally mean representatives of elements of \( \mathbb T_c^3\) that lie inside the original domain. Note that any input point is required to be an element of the half-open cube representing the original domain as defined above.</p>
<p>There are simplices containing points inside the original domain but also points outside it. The points outside the original domain are periodic copies of points inside the original domain. So, to specify a simplex we need points together with some additional information that determines the respective periodic copy of each point. The set of representatives of an element of \( \mathbb T_c^3\) is a cubic point grid. We address each representative by a three-dimensional integer vector \( (o_x,o_y,o_z)\), called <em>offset</em>. It represents the number of periods a representative in the original domain must be translated in \( x\)-, \( y\)-, and \( z\)-direction. The vector \( (0,0,0)\) corresponds to the representative in the original domain. To specify a \( k\)-simplex we need \( k+1\) point-offset pairs (cf. <a class="el" href="index.html#fig__P3Triangulation3figoffsets">Figure 44.1</a>).</p>
<p><a class="anchor" id="fig__P3Triangulation3figoffsets"></a></p><div class="image">
<img src="offsets.png" alt="offsets.png" />
</div>
   <div class="cgal_figure_caption">  <a class="el" href="index.html#fig__P3Triangulation3figoffsets">Figure 44.1</a> Offsets in a cell.  </div>  <br />

<h1><a class="anchor" id="P3Triangulation3secintro"></a>
Representation</h1>
<p>A triangulation is a collection of vertices and cells that are linked together through incidence and adjacency relations. Each cell gives access to its four incident vertices, their corresponding offsets, and to its four adjacent cells. Each vertex gives access to one of its incident cells.</p>
<p>The four vertices of a cell are indexed with 0, 1, 2 and 3 in positive orientation. The orientation of a simplex in \( \mathbb T_c^3\) is defined as the orientation of the corresponding simplex in \( \mathbb R^3\) given by representatives determined by the respective offsets (see <a class="el" href="index.html#fig__P3Triangulation3figorient">Figure 44.2</a>).</p>
<p><a class="anchor" id="fig__P3Triangulation3figorient"></a></p><div class="image">
<img src="orient.png" alt="orient.png" />
</div>
   <div class="cgal_figure_caption">  <a class="el" href="index.html#fig__P3Triangulation3figorient">Figure 44.2</a> Orientation of a cell.  </div>  <br />

<p>As in the underlying combinatorial triangulation (see Chapter <a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/TDS_3.tag:../TDS_3/" href="../TDS_3/index.html#chapterTDS3">3D Triangulation Data Structure</a>), the neighbors of a cell are indexed with 0, 1, 2, 3 in such a way that the neighbor indexed by \( i\) is opposite to the vertex with the same index. Also edges ( \( 1\)-faces) and facets ( \( 2\)-faces) are not explicitly represented: a facet is given by a cell and an index (the facet <code>i</code> of a cell <code>c</code> is the facet of <code>c</code> that is opposite to the vertex with index <code>i</code>) and an edge is given by a cell and two indices (the edge <code>(i,j)</code> of a cell <code>c</code> is the edge whose endpoints are the vertices of <code>c</code> with indices <code>i</code> and <code>j</code>). See <a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/TDS_3.tag:../TDS_3/" href="../TDS_3/index.html#fig__TDS3figrepres">Figure 43.1</a> of chapter 3D Triangulation Data Structure.</p>
<p>Some point sets do not admit a triangulation in \( \mathbb T_c^3\). In this case we use 27 periodic copies of the point set arranged in a cube of edge length \( 3c\). Any point set constructed in this way has a triangulation in \( \mathbb R^3/G'\) with \( G'=((3c\cdot\mathbb Z)^3,+)\) <a class="el" href="citelist.html#CITEREF_cgal:ct-c3pt-09">[1]</a>. So we compute the triangulation in this space, which is a <em>27-sheeted covering space</em> of \( \mathbb T_c^3\) (see <a class="el" href="index.html#fig__P3Triangulation3figcovering">Figure 44.3</a>).</p>
<p><a class="anchor" id="fig__P3Triangulation3figcovering"></a></p><div class="image">
<img src="it_UNIQUE_small.jpg" alt="it_UNIQUE_small.jpg" />
</div>
   <div class="cgal_figure_caption">  <a class="el" href="index.html#fig__P3Triangulation3figcovering">Figure 44.3</a> The same periodic triangulation in the 1-sheeted covering space and the 27-sheeted covering space.  </div>  <br />

<p>The machinery that manages the copies is largely hidden from the user. However there are some effects that cannot be ignored. For example if the point set does not permit a triangulation in \( \mathbb T_c^3\) then the combinatorial iterators (<code>Cell_iterator</code>, <code>Facet_iterator</code>, <code>Edge_iterator</code>, and <code>Vertex_iterator</code>) return all simplices that are internally stored, which correspond to 27 periodic copies of each geometric primitive (Tetrahedron, Triangle, Segment, and Point). This is necessary to ensure consistency in the adjacency relations. In case it is desired to have only one periodic copy of each primitive, we provide <em>geometric</em> iterators. They return geometric primitives of the triangulation without relations between them. Another effect is that when the algorithm switches from the 27-sheeted covering space to the 1-sheeted covering space, the <code>Vertex_handle</code>s and <code>Cell_handle</code>s referencing deleted items become invalid.</p>
<p>In the data structure each vertex stores the input point it corresponds to. If we are computing in the 27-sheeted covering space, each vertex stores the representative <em>inside</em> the original domain it corresponds to. So, the 27 vertices corresponding to the same element of \( \mathbb T_c^3\) all store the same representative in \( \mathbb R^3\), and not different periodic copies.</p>
<p><b>Validity</b></p>
<p>A periodic triangulation is said to be <code>locally valid</code> iff</p>
<p><b>(a)-(b)</b> Its underlying combinatorial graph, the triangulation data structure, is <code>locally valid</code> (see Section <a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/TDS_3.tag:../TDS_3/" href="../TDS_3/index.html#TDS3secintro">Representation</a> of Chapter <a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/TDS_3.tag:../TDS_3/" href="../TDS_3/index.html#chapterTDS3">3D Triangulation Data Structure</a>)</p>
<p><b>(c)</b> Any cell has its vertices ordered according to positive orientation. See <a class="el" href="index.html#fig__P3Triangulation3figorient">Figure 44.2</a>.</p>
<h1><a class="anchor" id="Periodic_3_triangulation_3Delaunay"></a>
Delaunay Triangulation</h1>
<p>The class <code><a class="el" href="classCGAL_1_1Periodic__3__Delaunay__triangulation__3.html" title="The class Periodic_3_Delaunay_triangulation_3 represents a Delaunay triangulation in three-dimensiona...">Periodic_3_Delaunay_triangulation_3</a></code> implements Delaunay triangulations of point sets in \( \mathbb T_c^3\).</p>
<p>Delaunay triangulations have the <em>empty sphere property</em>, that is, the circumscribing sphere of each cell does not contain any other vertex of the triangulation in its interior. These triangulations are uniquely defined except in degenerate cases where five points are co-spherical. Note however that the <span style="font-variant: small-caps;">CGAL</span> implementation computes a uniquely defined triangulation even in these cases <a class="el" href="citelist.html#CITEREF_cgal:dt-pvr3d-03">[2]</a>.</p>
<p>This implementation is fully dynamic: it supports both point insertion and vertex removal.</p>
<h1><a class="anchor" id="Periodic_3_triangulation_3regular"></a>
Regular Triangulation</h1>
<p>The class <code><a class="el" href="classCGAL_1_1Periodic__3__regular__triangulation__3.html" title="The class Periodic_3_regular_triangulation_3 represents a weighted Delaunay triangulation in three-di...">Periodic_3_regular_triangulation_3</a></code> implements regular triangulations, also known as weighted Delaunay triangulations, of point sets in \( \mathbb T_c^3\).</p>
<p>A regular triangulation is a triangulation in which the power sphere of each simplex is regular. See Section <a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Triangulation_3.tag:../Triangulation_3/" href="../Triangulation_3/index.html#Triangulation3secclassRegulartriangulation">Regular Triangulation</a> for a complete definition. As for Delaunay triangulations, <span style="font-variant: small-caps;">CGAL</span> computes a uniquely defined regular triangulation even in degenerate cases <a class="el" href="citelist.html#CITEREF_cgal:dt-pvrdr-06">[3]</a>.</p>
<p>The implementation is fully dynamic: it supports both point insertion and vertex removal.</p>
<h1><a class="anchor" id="Periodic_3_triangulation_3Triangulation"></a>
Triangulation Hierarchy</h1>
<p>The class <code><a class="el" href="classCGAL_1_1Periodic__3__triangulation__hierarchy__3.html" title="The class Periodic_3_triangulation_hierarchy_3 implements a triangulation augmented with a data struc...">Periodic_3_triangulation_hierarchy_3</a></code> is the adaptation of the hierarchical structure described in chapter <a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Triangulation_3.tag:../Triangulation_3/" href="../Triangulation_3/index.html#chapterTriangulation3">3D Triangulations</a> to the periodic case.</p>
<h1><a class="anchor" id="P3Triangulation3secdesign"></a>
Software Design</h1>
<p>We have chosen the prefix "Periodic_3" to emphasize that the triangulation is periodic in all three directions of space.</p>
<p>The main classes <code><a class="el" href="classCGAL_1_1Periodic__3__triangulation__3.html" title="The class Periodic_3_triangulation_3 represents a 3-dimensional triangulation of a point set in ...">Periodic_3_triangulation_3</a></code>, <code><a class="el" href="classCGAL_1_1Periodic__3__Delaunay__triangulation__3.html" title="The class Periodic_3_Delaunay_triangulation_3 represents a Delaunay triangulation in three-dimensiona...">Periodic_3_Delaunay_triangulation_3</a></code>, and <code><a class="el" href="classCGAL_1_1Periodic__3__regular__triangulation__3.html" title="The class Periodic_3_regular_triangulation_3 represents a weighted Delaunay triangulation in three-di...">Periodic_3_regular_triangulation_3</a></code> provide high-level geometric functionality and are responsible for the geometric validity. They are built as layers on top of a triangulation data structure, which stores their combinatorial structure. This separation between the geometry and the combinatorics is reflected in the software design by the fact that the triangulation classes take two template parameters: </p><ul>
<li>
the <b>geometric traits</b> class, which provides the type of points to use as well as the elementary operations on them (predicates and constructions). Furthermore it contains the offset type. The concept and models for this parameter are described in more detail in Section <a class="el" href="index.html#P3Triangulation3secTraits">The Geometric Traits Parameter</a>. </li>
<li>
the <b>triangulation data structure</b> class, which stores the combinatorial structure, described in Section <a class="el" href="index.html#P3Triangulation3sectds">The Triangulation Data Structure Parameter</a>. </li>
</ul>
<p>The class <code><a class="el" href="classCGAL_1_1Periodic__3__triangulation__3.html" title="The class Periodic_3_triangulation_3 represents a 3-dimensional triangulation of a point set in ...">Periodic_3_triangulation_3</a></code> contains all the functionality that is common to triangulations in general, such as location of a point in the triangulation <a class="el" href="citelist.html#CITEREF_cgal:dpt-wt-02">[4]</a>, access functions, geometric queries like the orientation test etc. The class <code><a class="el" href="classCGAL_1_1Periodic__3__Delaunay__triangulation__3.html" title="The class Periodic_3_Delaunay_triangulation_3 represents a Delaunay triangulation in three-dimensiona...">Periodic_3_Delaunay_triangulation_3</a></code> contains all the functionality that is specific to Delaunay triangulations, such as point insertion and vertex removal, the side-of-sphere test, finding the conflicting region of a given point, computation of dual functions, etc. The class <code><a class="el" href="classCGAL_1_1Periodic__3__regular__triangulation__3.html" title="The class Periodic_3_regular_triangulation_3 represents a weighted Delaunay triangulation in three-di...">Periodic_3_regular_triangulation_3</a></code> does the same for regular triangulations.</p>
<h2><a class="anchor" id="P3Triangulation3secTraits"></a>
The Geometric Traits Parameter</h2>
<h3><a class="anchor" id="P3Triangulation3secTraitsP3T3"></a>
Traits for Periodic Triangulations</h3>
<p>The first template parameter of the triangulation class <code><a class="el" href="classCGAL_1_1Periodic__3__triangulation__3.html" title="The class Periodic_3_triangulation_3 represents a 3-dimensional triangulation of a point set in ...">Periodic_3_triangulation_3</a>&lt;<a class="el" href="classPeriodic__3TriangulationTraits__3.html" title="The concept Periodic_3TriangulationTraits_3 is the first template parameter of the class Periodic_3_t...">Periodic_3TriangulationTraits_3</a>, <a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/TDS_3.tag:../TDS_3/" href="../TDS_3/classTriangulationDataStructure__3.html">TriangulationDataStructure_3</a>&gt;</code> is the geometric traits class, described by the concept <code><a class="el" href="classPeriodic__3TriangulationTraits__3.html" title="The concept Periodic_3TriangulationTraits_3 is the first template parameter of the class Periodic_3_t...">Periodic_3TriangulationTraits_3</a></code>. It is different to the <a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Triangulation_3.tag:../Triangulation_3/" href="../Triangulation_3/classTriangulationTraits__3.html">TriangulationTraits_3</a> (see chapter <a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Triangulation_3.tag:../Triangulation_3/" href="../Triangulation_3/index.html#Triangulation3secTraits">3D Triangulations</a>) in that it implements all objects, predicates and constructions using offsets.</p>
<p>The class <code><a class="el" href="classCGAL_1_1Periodic__3__triangulation__traits__3.html" title="The class Periodic_3_triangulation_traits_3 is designed as a default traits class for the class Perio...">Periodic_3_triangulation_traits_3</a>&lt;<a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Triangulation_3.tag:../Triangulation_3/" href="../Triangulation_3/classTriangulationTraits__3.html">TriangulationTraits_3</a>,<a class="el" href="classPeriodic__3Offset__3.html" title="The concept Periodic_3Offset_3 describes a three-dimensional integer vector with some specialized acc...">Periodic_3Offset_3</a>&gt;</code> provides the required functionality. It expects two template parameters: a model of the concept <code><a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Triangulation_3.tag:../Triangulation_3/" href="../Triangulation_3/classTriangulationTraits__3.html">TriangulationTraits_3</a></code> and a model of the concept <code><a class="el" href="classPeriodic__3Offset__3.html" title="The concept Periodic_3Offset_3 describes a three-dimensional integer vector with some specialized acc...">Periodic_3Offset_3</a></code>.</p>
<p>The second parameter <code><a class="el" href="classPeriodic__3Offset__3.html" title="The concept Periodic_3Offset_3 describes a three-dimensional integer vector with some specialized acc...">Periodic_3Offset_3</a></code> defaults to <code><a class="el" href="classCGAL_1_1Periodic__3__offset__3.html" title="The class Periodic_3_offset_3 is a model of the concept Periodic_3Offset_3. ">Periodic_3_offset_3</a></code>.</p>
<h3><a class="anchor" id="P3Triangulation3secTraitsP3DT3"></a>
Traits for Periodic Delaunay Triangulations</h3>
<p>The first template parameter of the Delaunay triangulation class <code><a class="el" href="classCGAL_1_1Periodic__3__Delaunay__triangulation__3.html" title="The class Periodic_3_Delaunay_triangulation_3 represents a Delaunay triangulation in three-dimensiona...">Periodic_3_Delaunay_triangulation_3</a>&lt;<a class="el" href="classPeriodic__3DelaunayTriangulationTraits__3.html" title="The concept Periodic_3DelaunayTriangulationTraits_3 is the first template parameter of the class CGAL...">Periodic_3DelaunayTriangulationTraits_3</a>, <a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/TDS_3.tag:../TDS_3/" href="../TDS_3/classTriangulationDataStructure__3.html">TriangulationDataStructure_3</a>&gt;</code> is the geometric traits class, described by the concept <code><a class="el" href="classPeriodic__3DelaunayTriangulationTraits__3.html" title="The concept Periodic_3DelaunayTriangulationTraits_3 is the first template parameter of the class CGAL...">Periodic_3DelaunayTriangulationTraits_3</a></code>. It is different to the <a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Triangulation_3.tag:../Triangulation_3/" href="../Triangulation_3/classDelaunayTriangulationTraits__3.html">DelaunayTriangulationTraits_3</a> (see chapter <a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Triangulation_3.tag:../Triangulation_3/" href="../Triangulation_3/index.html#Triangulation3secTraits">3D Triangulations</a>) in that it implements all objects, predicates and constructions using offsets.</p>
<p>The class <code><a class="el" href="classCGAL_1_1Periodic__3__Delaunay__triangulation__traits__3.html" title="The class Periodic_3_Delaunay_triangulation_traits_3 is designed as a default traits class for the cl...">Periodic_3_Delaunay_triangulation_traits_3</a>&lt;<a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Triangulation_3.tag:../Triangulation_3/" href="../Triangulation_3/classDelaunayTriangulationTraits__3.html">DelaunayTriangulationTraits_3</a>,<a class="el" href="classPeriodic__3Offset__3.html" title="The concept Periodic_3Offset_3 describes a three-dimensional integer vector with some specialized acc...">Periodic_3Offset_3</a>&gt;</code> provides the required functionality. It expects two template parameters: a model of the concept <code><a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Triangulation_3.tag:../Triangulation_3/" href="../Triangulation_3/classDelaunayTriangulationTraits__3.html">DelaunayTriangulationTraits_3</a></code> and a model of the concept <code><a class="el" href="classPeriodic__3Offset__3.html" title="The concept Periodic_3Offset_3 describes a three-dimensional integer vector with some specialized acc...">Periodic_3Offset_3</a></code>.</p>
<p>The second parameter <code><a class="el" href="classPeriodic__3Offset__3.html" title="The concept Periodic_3Offset_3 describes a three-dimensional integer vector with some specialized acc...">Periodic_3Offset_3</a></code> defaults to <code><a class="el" href="classCGAL_1_1Periodic__3__offset__3.html" title="The class Periodic_3_offset_3 is a model of the concept Periodic_3Offset_3. ">Periodic_3_offset_3</a></code>.</p>
<h3><a class="anchor" id="P3Triangulation3secTraitsP3regularT3"></a>
Traits for Periodic Regular Triangulations</h3>
<p>The first template parameter of the regular triangulation class <code><a class="el" href="classCGAL_1_1Periodic__3__regular__triangulation__3.html" title="The class Periodic_3_regular_triangulation_3 represents a weighted Delaunay triangulation in three-di...">Periodic_3_regular_triangulation_3</a>&lt;<a class="el" href="classPeriodic__3RegularTriangulationTraits__3.html" title="The concept Periodic_3RegularTriangulationTraits_3 is the first template parameter of the class CGAL:...">Periodic_3RegularTriangulationTraits_3</a>, <a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/TDS_3.tag:../TDS_3/" href="../TDS_3/classTriangulationDataStructure__3.html">TriangulationDataStructure_3</a>&gt;</code> is the geometric traits class, described by the concept <code><a class="el" href="classPeriodic__3RegularTriangulationTraits__3.html" title="The concept Periodic_3RegularTriangulationTraits_3 is the first template parameter of the class CGAL:...">Periodic_3RegularTriangulationTraits_3</a></code>. It is different to the <a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Triangulation_3.tag:../Triangulation_3/" href="../Triangulation_3/classRegularTriangulationTraits__3.html">RegularTriangulationTraits_3</a> (see chapter <a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Triangulation_3.tag:../Triangulation_3/" href="../Triangulation_3/index.html#Triangulation3secTraits">3D Triangulations</a>) in that it implements all objects, predicates and constructions using offsets.</p>
<p>The class <code><a class="el" href="classCGAL_1_1Periodic__3__regular__triangulation__traits__3.html" title="The class Periodic_3_regular_triangulation_traits_3 is designed as a default traits class for the cla...">Periodic_3_regular_triangulation_traits_3</a>&lt;<a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Triangulation_3.tag:../Triangulation_3/" href="../Triangulation_3/classRegularTriangulationTraits__3.html">RegularTriangulationTraits_3</a>,<a class="el" href="classPeriodic__3Offset__3.html" title="The concept Periodic_3Offset_3 describes a three-dimensional integer vector with some specialized acc...">Periodic_3Offset_3</a>&gt;</code> provides the required functionality. It expects two template parameters: a model of the concept <code><a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Triangulation_3.tag:../Triangulation_3/" href="../Triangulation_3/classRegularTriangulationTraits__3.html">RegularTriangulationTraits_3</a></code> and a model of the concept <code><a class="el" href="classPeriodic__3Offset__3.html" title="The concept Periodic_3Offset_3 describes a three-dimensional integer vector with some specialized acc...">Periodic_3Offset_3</a></code>.</p>
<p>The second parameter <code><a class="el" href="classPeriodic__3Offset__3.html" title="The concept Periodic_3Offset_3 describes a three-dimensional integer vector with some specialized acc...">Periodic_3Offset_3</a></code> defaults to <code><a class="el" href="classCGAL_1_1Periodic__3__offset__3.html" title="The class Periodic_3_offset_3 is a model of the concept Periodic_3Offset_3. ">Periodic_3_offset_3</a></code>.</p>
<h3><a class="anchor" id="P3Triangulation3secTraitsK"></a>
Compatible Kernels</h3>
<p>The kernels <code><a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Kernel_23.tag:../Kernel_23/" href="../Kernel_23/structCGAL_1_1Cartesian.html">Cartesian</a></code>, <code><a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Kernel_23.tag:../Kernel_23/" href="../Kernel_23/structCGAL_1_1Homogeneous.html">Homogeneous</a></code>, <code><a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Kernel_23.tag:../Kernel_23/" href="../Kernel_23/structCGAL_1_1Simple__cartesian.html">Simple_cartesian</a></code>, <code><a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Kernel_23.tag:../Kernel_23/" href="../Kernel_23/structCGAL_1_1Simple__homogeneous.html">Simple_homogeneous</a></code> and <code><a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Kernel_23.tag:../Kernel_23/" href="../Kernel_23/structCGAL_1_1Filtered__kernel.html">Filtered_kernel</a></code> can all be used as models of the concepts <code><a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Triangulation_3.tag:../Triangulation_3/" href="../Triangulation_3/classTriangulationTraits__3.html">TriangulationTraits_3</a></code>, <code><a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Triangulation_3.tag:../Triangulation_3/" href="../Triangulation_3/classDelaunayTriangulationTraits__3.html">DelaunayTriangulationTraits_3</a></code>, and <code><a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Triangulation_3.tag:../Triangulation_3/" href="../Triangulation_3/classRegularTriangulationTraits__3.html">RegularTriangulationTraits_3</a></code>. The periodic triangulation classes provide exact predicates and exact constructions if these respective template parameters do. They provide exact predicates but not exact constructions if <code><a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Kernel_23.tag:../Kernel_23/" href="../Kernel_23/structCGAL_1_1Filtered__kernel.html">Filtered_kernel</a>&lt;CK&gt;</code> with <code>CK</code> an inexact kernel is used as template parameter. Using <code><a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Kernel_23.tag:../Kernel_23/" href="../Kernel_23/classCGAL_1_1Exact__predicates__inexact__constructions__kernel.html">Exact_predicates_inexact_constructions_kernel</a></code> provides fast and exact predicates and not exact constructions, using <code><a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Kernel_23.tag:../Kernel_23/" href="../Kernel_23/classCGAL_1_1Exact__predicates__exact__constructions__kernel.html">Exact_predicates_exact_constructions_kernel</a></code> provides fast and exact predicates and exact constructions. The latter is recommended if the dual constructions and constructions of points, segments, triangles, and tetrahedra are used.</p>
<h2><a class="anchor" id="P3Triangulation3sectds"></a>
The Triangulation Data Structure Parameter</h2>
<p>The second template parameter of the periodic triangulation classes is a triangulation data structure class. This class can be seen as a container for the cells and vertices maintaining incidence and adjacency relations (see Chapter <a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/TDS_3.tag:../TDS_3/" href="../TDS_3/index.html#chapterTDS3">3D Triangulation Data Structure</a>). A model of this triangulation data structure is <code><a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/TDS_3.tag:../TDS_3/" href="../TDS_3/classCGAL_1_1Triangulation__data__structure__3.html">Triangulation_data_structure_3</a></code>, and it is described by the <code><a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/TDS_3.tag:../TDS_3/" href="../TDS_3/classTriangulationDataStructure__3.html">TriangulationDataStructure_3</a></code> concept. This model is itself parameterized by a vertex base class and a cell base class, which gives the possibility to customize the vertices and cells used by the triangulation data structure, and hence by the geometric triangulation using it. To represent periodic triangulations the cell base and vertex base classes need to meet the concepts <code><a class="el" href="classPeriodic__3TriangulationDSCellBase__3.html" title="A refinement of the concept TriangulationDSCellBase_3 which adds an API for offsets. ">Periodic_3TriangulationDSCellBase_3</a></code> and <code><a class="el" href="classPeriodic__3TriangulationDSVertexBase__3.html" title="A refinement of the concept TriangulationDSVertexBase_3 which adds an API for offset. ">Periodic_3TriangulationDSVertexBase_3</a></code>.</p>
<p>A default value for the triangulation data structure parameter is provided in all the triangulation classes, so it does not need to be specified by the user unless he wants to use a different triangulation data structure or a different vertex or cell base class.</p>
<h2><a class="anchor" id="Periodic_3_triangulation_3Flexibilityofthe"></a>
Flexibility of the Design</h2>
<p>The class <code><a class="el" href="classCGAL_1_1Periodic__3__triangulation__3.html" title="The class Periodic_3_triangulation_3 represents a 3-dimensional triangulation of a point set in ...">Periodic_3_triangulation_3</a></code> uses the <code><a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/TDS_3.tag:../TDS_3/" href="../TDS_3/classTriangulationDataStructure__3.html">TriangulationDataStructure_3</a></code> in essentially the same way as the class <code><a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Triangulation_3.tag:../Triangulation_3/" href="../Triangulation_3/classCGAL_1_1Triangulation__3.html">Triangulation_3</a></code> and the flexibility described in <a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Triangulation_3.tag:../Triangulation_3/" href="../Triangulation_3/index.html#Triangulation3secdesign">Software Design</a> is therefore applicable in exactly the same way. Furthermore, the classes <code><a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Triangulation_3.tag:../Triangulation_3/" href="../Triangulation_3/classCGAL_1_1Triangulation__vertex__base__with__info__3.html">Triangulation_vertex_base_with_info_3</a></code> and <code><a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Triangulation_3.tag:../Triangulation_3/" href="../Triangulation_3/classCGAL_1_1Triangulation__cell__base__with__info__3.html">Triangulation_cell_base_with_info_3</a></code> can be reused directly, see Example <a class="el" href="index.html#P3Triangulation3secexamplescolor">Adding a Color</a>.</p>
<h1><a class="anchor" id="P3Triangulation3secexamples"></a>
Examples</h1>
<h2><a class="anchor" id="Periodic_3_triangulation_3BasicExample"></a>
Basic Example</h2>
<p>This example shows the incremental construction of a 3D Delaunay triangulation, the location of a point and how to perform elementary operations on indices in a cell. It uses the default parameter of the class <code><a class="el" href="classCGAL_1_1Periodic__3__Delaunay__triangulation__3.html" title="The class Periodic_3_Delaunay_triangulation_3 represents a Delaunay triangulation in three-dimensiona...">Periodic_3_Delaunay_triangulation_3</a></code> for the triangulation data structure.</p>
<p><br />
<b>File</b> <a class="el" href="Periodic_3_triangulation_3_2simple_example_8cpp-example.html">Periodic_3_triangulation_3/simple_example.cpp</a> </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;CGAL/Exact_predicates_inexact_constructions_kernel.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Periodic_3_Delaunay_triangulation_traits_3.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Periodic_3_Delaunay_triangulation_3.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/periodic_3_triangulation_3_io.h&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;fstream&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;cassert&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;list&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;vector&gt;</span></div><div class="line"></div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Kernel_23.tag:../Kernel_23/" href="../Kernel_23/classCGAL_1_1Exact__predicates__inexact__constructions__kernel.html">CGAL::Exact_predicates_inexact_constructions_kernel</a>       K;</div><div class="line"><span class="keyword">typedef</span> <a class="code" href="classCGAL_1_1Periodic__3__Delaunay__triangulation__traits__3.html">CGAL::Periodic_3_Delaunay_triangulation_traits_3&lt;K&gt;</a>       Gt;</div><div class="line"><span class="keyword">typedef</span> <a class="code" href="classCGAL_1_1Periodic__3__Delaunay__triangulation__3.html">CGAL::Periodic_3_Delaunay_triangulation_3&lt;Gt&gt;</a>             P3DT3;</div><div class="line"></div><div class="line"><span class="keyword">typedef</span> P3DT3::Point             Point;</div><div class="line"><span class="keyword">typedef</span> P3DT3::Iso_cuboid        Iso_cuboid;</div><div class="line"><span class="keyword">typedef</span> P3DT3::Vertex_handle     Vertex_handle;</div><div class="line"><span class="keyword">typedef</span> P3DT3::Cell_handle       Cell_handle;</div><div class="line"><span class="keyword">typedef</span> P3DT3::Locate_type       Locate_type;</div><div class="line"></div><div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span>, <span class="keywordtype">char</span>**)</div><div class="line">{</div><div class="line">  Iso_cuboid domain(-1,-1,-1,2,2,2);  <span class="comment">// the fundamental domain</span></div><div class="line"></div><div class="line">  <span class="comment">// construction from a list of points :</span></div><div class="line">  std::list&lt;Point&gt; L;</div><div class="line">  L.push_front(Point(0,0,0));</div><div class="line">  L.push_front(Point(1,0,0));</div><div class="line">  L.push_front(Point(0,1,0));</div><div class="line"></div><div class="line">  P3DT3 T(L.begin(), L.end(), domain); <span class="comment">// put the domain with the constructor</span></div><div class="line"></div><div class="line">  P3DT3::size_type n = T.number_of_vertices();</div><div class="line"></div><div class="line">  <span class="comment">// insertion from a vector :</span></div><div class="line">  std::vector&lt;Point&gt; V(3);</div><div class="line">  V[0] = Point(0,0,1);</div><div class="line">  V[1] = Point(1,1,1);</div><div class="line">  V[2] = Point(-1,-1,-1);</div><div class="line"></div><div class="line">  n = n + T.insert(V.begin(), V.end());</div><div class="line"></div><div class="line">  assert( n == 6 );       <span class="comment">// 6 points have been inserted</span></div><div class="line">  assert( T.is_valid() ); <span class="comment">// checking validity of T</span></div><div class="line"></div><div class="line">  Locate_type lt;</div><div class="line">  <span class="keywordtype">int</span> li, lj;</div><div class="line">  Point p(0,0,0);</div><div class="line">  Cell_handle c = T.locate(p, lt, li, lj);</div><div class="line">  <span class="comment">// p is the vertex of c of index li :</span></div><div class="line">  assert( lt == P3DT3::VERTEX );</div><div class="line">  assert( c-&gt;vertex(li)-&gt;point() == p );</div><div class="line"></div><div class="line">  Vertex_handle v = c-&gt;vertex( (li+1)&amp;3 );</div><div class="line">  <span class="comment">// v is another vertex of c</span></div><div class="line">  Cell_handle nc = c-&gt;neighbor(li);</div><div class="line">  <span class="comment">// nc = neighbor of c opposite to the vertex associated with p</span></div><div class="line">  <span class="comment">// nc must have vertex v :</span></div><div class="line">  <span class="keywordtype">int</span> nli;</div><div class="line">  assert( nc-&gt;has_vertex( v, nli ) );</div><div class="line">  <span class="comment">// nli is the index of v in nc</span></div><div class="line"></div><div class="line">  <span class="comment">// writing file output</span></div><div class="line">  std::ofstream oFileT(<span class="stringliteral">"output.tri"</span>, std::ios::out); <span class="comment">// as a .tri file</span></div><div class="line">  oFileT &lt;&lt; T;</div><div class="line"></div><div class="line">  std::ofstream to_off(<span class="stringliteral">"output_regular.off"</span>); <span class="comment">// as a .off file</span></div><div class="line">  CGAL::write_triangulation_to_off(to_off, T);</div><div class="line"></div><div class="line">  std::ofstream d_to_off(<span class="stringliteral">"output_dual.off"</span>);</div><div class="line">  draw_dual_to_off(d_to_off, T);</div><div class="line"></div><div class="line">  <span class="comment">// reading file output</span></div><div class="line">  P3DT3 T1;</div><div class="line">  std::ifstream iFileT(<span class="stringliteral">"output.tri"</span>,std::ios::in);</div><div class="line">  iFileT &gt;&gt; T1;</div><div class="line">  assert( T1.is_valid() );</div><div class="line">  assert( T1.number_of_vertices() == T.number_of_vertices() );</div><div class="line">  assert( T1.number_of_cells() == T.number_of_cells() );</div><div class="line"></div><div class="line">  <span class="keywordflow">return</span> 0;</div><div class="line">}</div></div><!-- fragment --><h2><a class="anchor" id="Periodic_3_triangulation_3ChangingtheVertex"></a>
Changing the Vertex Base</h2>
<p>The following two examples show how the user can plug his own vertex base in a triangulation. Changing the cell base is similar.</p>
<h3><a class="anchor" id="P3Triangulation3secexamplescolor"></a>
Adding a Color</h3>
<p>If the user does not need to add a type in a vertex that depends on the <code><a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/TDS_3.tag:../TDS_3/" href="../TDS_3/classTriangulationDataStructure__3.html">TriangulationDataStructure_3</a></code> (e.g. a <code>Vertex_handle</code> or <code>Cell_handle</code>), then he can use the <code><a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Triangulation_3.tag:../Triangulation_3/" href="../Triangulation_3/classCGAL_1_1Triangulation__vertex__base__with__info__3.html">Triangulation_vertex_base_with_info_3</a></code> class to add his own information easily in the vertices. The example below shows how to add a <code><a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Stream_support.tag:../Stream_support/" href="../Stream_support/classCGAL_1_1Color.html">Color</a></code> this way.</p>
<p><br />
<b>File</b> <a class="el" href="Periodic_3_triangulation_3_2colored_vertices_8cpp-example.html">Periodic_3_triangulation_3/colored_vertices.cpp</a> </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;CGAL/Exact_predicates_inexact_constructions_kernel.h&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Periodic_3_Delaunay_triangulation_traits_3.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Periodic_3_Delaunay_triangulation_3.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Triangulation_vertex_base_with_info_3.h&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;CGAL/IO/Color.h&gt;</span></div><div class="line"></div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Kernel_23.tag:../Kernel_23/" href="../Kernel_23/classCGAL_1_1Exact__predicates__inexact__constructions__kernel.html">CGAL::Exact_predicates_inexact_constructions_kernel</a> K;</div><div class="line"><span class="keyword">typedef</span> <a class="code" href="classCGAL_1_1Periodic__3__Delaunay__triangulation__traits__3.html">CGAL::Periodic_3_Delaunay_triangulation_traits_3&lt;K&gt;</a> Gt;</div><div class="line"></div><div class="line"><span class="keyword">typedef</span> <a class="code" href="classCGAL_1_1Periodic__3__triangulation__ds__vertex__base__3.html">CGAL::Periodic_3_triangulation_ds_vertex_base_3&lt;&gt;</a> VbDS;</div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Triangulation_3.tag:../Triangulation_3/" href="../Triangulation_3/classCGAL_1_1Triangulation__vertex__base__3.html">CGAL::Triangulation_vertex_base_3&lt;Gt, VbDS&gt;</a>       Vb;</div><div class="line"></div><div class="line"><span class="keyword">typedef</span> <a class="code" href="classCGAL_1_1Periodic__3__triangulation__ds__cell__base__3.html">CGAL::Periodic_3_triangulation_ds_cell_base_3&lt;&gt;</a> CbDS;</div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Triangulation_3.tag:../Triangulation_3/" href="../Triangulation_3/classCGAL_1_1Triangulation__cell__base__3.html">CGAL::Triangulation_cell_base_3&lt;Gt, CbDS&gt;</a>       Cb;</div><div class="line"></div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Triangulation_3.tag:../Triangulation_3/" href="../Triangulation_3/classCGAL_1_1Triangulation__vertex__base__with__info__3.html">CGAL::Triangulation_vertex_base_with_info_3&lt;CGAL::Color, Gt, Vb&gt;</a> VbInfo;</div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/TDS_3.tag:../TDS_3/" href="../TDS_3/classCGAL_1_1Triangulation__data__structure__3.html">CGAL::Triangulation_data_structure_3&lt;VbInfo, Cb&gt;</a>                 TDS;</div><div class="line"><span class="keyword">typedef</span> <a class="code" href="classCGAL_1_1Periodic__3__Delaunay__triangulation__3.html">CGAL::Periodic_3_Delaunay_triangulation_3&lt;Gt, TDS&gt;</a>               P3DT3;</div><div class="line"></div><div class="line"><span class="keyword">typedef</span> P3DT3::Point   Point;</div><div class="line"></div><div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span>, <span class="keywordtype">char</span>**)</div><div class="line">{</div><div class="line">  P3DT3 T;</div><div class="line"></div><div class="line">  T.<a class="code" href="classCGAL_1_1Periodic__3__Delaunay__triangulation__3.html#a00517885761d298a85ecccf15f8a9559">insert</a>(Point(0,0,0));</div><div class="line">  T.insert(Point(.1,0,0));</div><div class="line">  T.insert(Point(0,.1,0));</div><div class="line">  T.insert(Point(0,0,.1));</div><div class="line">  T.insert(Point(.2,.2,.2));</div><div class="line">  T.insert(Point(.9,0,.1));</div><div class="line"></div><div class="line">  <span class="comment">// Set the color of finite vertices of degree 6 to red.</span></div><div class="line">  P3DT3::Vertex_iterator vit;</div><div class="line">  <span class="keywordflow">for</span> (vit = T.vertices_begin(); vit != T.vertices_end(); ++vit) {</div><div class="line">    <span class="keywordflow">if</span> (T.degree(vit) == 16) {</div><div class="line">      vit-&gt;info() = CGAL::RED;</div><div class="line">    }</div><div class="line">  }</div><div class="line"></div><div class="line">  <span class="keywordflow">return</span> 0;</div><div class="line">}</div></div><!-- fragment --><h3><a class="anchor" id="Periodic_3_triangulation_3AddingHandles"></a>
Adding Handles</h3>
<p>If the user needs to add a type in a vertex that depends on the <code><a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/TDS_3.tag:../TDS_3/" href="../TDS_3/classTriangulationDataStructure__3.html">TriangulationDataStructure_3</a></code> (e.g. a <code>Vertex_handle</code> or <code>Cell_handle</code>), then he has to derive his own vertex base class, as the following example shows.</p>
<p><br />
<b>File</b> <a class="el" href="Periodic_3_triangulation_3_2periodic_adding_handles_8cpp-example.html">Periodic_3_triangulation_3/periodic_adding_handles.cpp</a> </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;CGAL/Exact_predicates_inexact_constructions_kernel.h&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Periodic_3_Delaunay_triangulation_traits_3.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Periodic_3_Delaunay_triangulation_3.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Periodic_3_triangulation_ds_vertex_base_3.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Triangulation_vertex_base_3.h&gt;</span></div><div class="line"></div><div class="line"><span class="keyword">template</span> &lt; <span class="keyword">class </span>Gt, <span class="keyword">class </span>VbDS,</div><div class="line">           <span class="keyword">class </span>Vb = <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Triangulation_3.tag:../Triangulation_3/" href="../Triangulation_3/classCGAL_1_1Triangulation__vertex__base__3.html">CGAL::Triangulation_vertex_base_3&lt;Gt,VbDS&gt;</a> &gt;</div><div class="line"><span class="keyword">class </span>My_vertex_base</div><div class="line">  : <span class="keyword">public</span> Vb</div><div class="line">{</div><div class="line"><span class="keyword">public</span>:</div><div class="line">  <span class="keyword">typedef</span> <span class="keyword">typename</span> Vb::Vertex_handle  Vertex_handle;</div><div class="line">  <span class="keyword">typedef</span> <span class="keyword">typename</span> Vb::Cell_handle    Cell_handle;</div><div class="line">  <span class="keyword">typedef</span> <span class="keyword">typename</span> Vb::Point          Point;</div><div class="line"></div><div class="line">  <span class="keyword">template</span> &lt; <span class="keyword">class</span> TDS2 &gt;</div><div class="line">  <span class="keyword">struct </span>Rebind_TDS {</div><div class="line">    <span class="keyword">typedef</span> <span class="keyword">typename</span> Vb::template Rebind_TDS&lt;TDS2&gt;::Other  Vb2;</div><div class="line">    <span class="keyword">typedef</span> My_vertex_base&lt;Gt, Vb2&gt;                        Other;</div><div class="line">  };</div><div class="line"></div><div class="line">  My_vertex_base() {}</div><div class="line"></div><div class="line">  My_vertex_base(<span class="keyword">const</span> Point&amp; p)</div><div class="line">    : Vb(p) {}</div><div class="line"></div><div class="line">  My_vertex_base(<span class="keyword">const</span> Point&amp; p, Cell_handle c)</div><div class="line">    : Vb(p, c) {}</div><div class="line"></div><div class="line">  Vertex_handle   vh;</div><div class="line">  Cell_handle     ch;</div><div class="line">};</div><div class="line"></div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Kernel_23.tag:../Kernel_23/" href="../Kernel_23/classCGAL_1_1Exact__predicates__inexact__constructions__kernel.html">CGAL::Exact_predicates_inexact_constructions_kernel</a> K;</div><div class="line"><span class="keyword">typedef</span> <a class="code" href="classCGAL_1_1Periodic__3__Delaunay__triangulation__traits__3.html">CGAL::Periodic_3_Delaunay_triangulation_traits_3&lt;K&gt;</a> Gt;</div><div class="line"></div><div class="line"><span class="keyword">typedef</span> <a class="code" href="classCGAL_1_1Periodic__3__triangulation__ds__vertex__base__3.html">CGAL::Periodic_3_triangulation_ds_vertex_base_3&lt;&gt;</a>  VbDS;</div><div class="line"><span class="keyword">typedef</span> <a class="code" href="classCGAL_1_1Periodic__3__triangulation__ds__cell__base__3.html">CGAL::Periodic_3_triangulation_ds_cell_base_3&lt;&gt;</a>    CbDS;</div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Triangulation_3.tag:../Triangulation_3/" href="../Triangulation_3/classCGAL_1_1Triangulation__cell__base__3.html">CGAL::Triangulation_cell_base_3&lt;Gt,CbDS&gt;</a>           Cb;</div><div class="line"></div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/TDS_3.tag:../TDS_3/" href="../TDS_3/classCGAL_1_1Triangulation__data__structure__3.html">CGAL::Triangulation_data_structure_3&lt;My_vertex_base&lt;Gt, VbDS&gt;</a>, Cb&gt; TDS;</div><div class="line"><span class="keyword">typedef</span> <a class="code" href="classCGAL_1_1Periodic__3__Delaunay__triangulation__3.html">CGAL::Periodic_3_Delaunay_triangulation_3&lt;Gt, TDS&gt;</a>                 P3DT3;</div><div class="line"></div><div class="line"><span class="keyword">typedef</span> P3DT3::Vertex_handle    Vertex_handle;</div><div class="line"><span class="keyword">typedef</span> P3DT3::Point            Point;</div><div class="line"></div><div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span>, <span class="keywordtype">char</span>**)</div><div class="line">{</div><div class="line">  P3DT3 T;</div><div class="line"></div><div class="line">  Vertex_handle v0 = T.<a class="code" href="classCGAL_1_1Periodic__3__Delaunay__triangulation__3.html#a00517885761d298a85ecccf15f8a9559">insert</a>(Point(0,0,0));</div><div class="line">  Vertex_handle v1 = T.insert(Point(.1,0,0));</div><div class="line">  Vertex_handle v2 = T.insert(Point(0,.1,0));</div><div class="line">  Vertex_handle v3 = T.insert(Point(0,0,.1));</div><div class="line">  Vertex_handle v4 = T.insert(Point(.2,.2,.2));</div><div class="line">  Vertex_handle v5 = T.insert(Point(.9,0,.1));</div><div class="line"></div><div class="line">  <span class="comment">// Now we can link the vertices as we like.</span></div><div class="line">  v0-&gt;vh = v1;</div><div class="line">  v1-&gt;vh = v2;</div><div class="line">  v2-&gt;vh = v3;</div><div class="line">  v3-&gt;vh = v4;</div><div class="line">  v4-&gt;vh = v5;</div><div class="line">  v5-&gt;vh = v0;</div><div class="line"></div><div class="line">  <span class="keywordflow">return</span> 0;</div><div class="line">}</div></div><!-- fragment --><h2><a class="anchor" id="Periodic_3_triangulation_3The27sheetedCovering"></a>
The 27-sheeted Covering Space</h2>
<p>The user can check at any time whether a triangulation would be a simplicial complex in \( \mathbb T_c^3\) and force a conversion if so. However, this should be done very carefully in order to ensure that the internal structure always remains a simplicial complex and thus a triangulation.</p>
<p>In this example, we construct a triangulation that can be converted to the 1-sheeted covering space. However, we can insert new points such that the point set does not have a Delaunay triangulation in the 1-sheeted covering space anymore, rendering the triangulation not <em>extensible</em>.</p>
<p><br />
<b>File</b> <a class="el" href="Periodic_3_triangulation_3_2covering_8cpp-example.html">Periodic_3_triangulation_3/covering.cpp</a> </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;CGAL/Exact_predicates_inexact_constructions_kernel.h&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Periodic_3_Delaunay_triangulation_traits_3.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Periodic_3_Delaunay_triangulation_3.h&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;vector&gt;</span></div><div class="line"></div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Kernel_23.tag:../Kernel_23/" href="../Kernel_23/classCGAL_1_1Exact__predicates__inexact__constructions__kernel.html">CGAL::Exact_predicates_inexact_constructions_kernel</a>     K;</div><div class="line"><span class="keyword">typedef</span> <a class="code" href="classCGAL_1_1Periodic__3__Delaunay__triangulation__traits__3.html">CGAL::Periodic_3_Delaunay_triangulation_traits_3&lt;K&gt;</a>     Gt;</div><div class="line"><span class="keyword">typedef</span> <a class="code" href="classCGAL_1_1Periodic__3__Delaunay__triangulation__3.html">CGAL::Periodic_3_Delaunay_triangulation_3&lt;Gt&gt;</a>           P3DT3;</div><div class="line"></div><div class="line"><span class="keyword">typedef</span> P3DT3::Point                  Point;</div><div class="line"><span class="keyword">typedef</span> P3DT3::Covering_sheets        Covering_sheets;</div><div class="line"></div><div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span>, <span class="keywordtype">char</span>**)</div><div class="line">{</div><div class="line">  P3DT3 T;</div><div class="line"></div><div class="line">  <span class="comment">// Input point grid (27 points)</span></div><div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">double</span> x=0. ; x &lt; .9 ; x += 0.33) {</div><div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">double</span> y=0. ; y &lt; .9 ; y += 0.33) {</div><div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">double</span> z=0. ; z &lt; .9 ; z += 0.33) {</div><div class="line">        T.<a class="code" href="classCGAL_1_1Periodic__3__Delaunay__triangulation__3.html#a00517885761d298a85ecccf15f8a9559">insert</a>(Point(x,y,z));</div><div class="line">      }</div><div class="line">    }</div><div class="line">  }</div><div class="line"></div><div class="line">  Covering_sheets cs = T.number_of_sheets();</div><div class="line">  std::cout&lt;&lt;<span class="stringliteral">"Current covering: "</span>&lt;&lt;cs[0]&lt;&lt;<span class="charliteral">' '</span>&lt;&lt;cs[1]&lt;&lt;<span class="charliteral">' '</span>&lt;&lt;cs[2]&lt;&lt;std::endl;</div><div class="line">  <span class="keywordflow">if</span> ( T.is_triangulation_in_1_sheet() ) { <span class="comment">// = true</span></div><div class="line">    <span class="keywordtype">bool</span> is_extensible = T.is_extensible_triangulation_in_1_sheet_h1()</div><div class="line">      || T.is_extensible_triangulation_in_1_sheet_h2(); <span class="comment">// = false</span></div><div class="line">    T.convert_to_1_sheeted_covering();</div><div class="line">    cs = T.number_of_sheets();</div><div class="line">    std::cout&lt;&lt;<span class="stringliteral">"Current covering: "</span>&lt;&lt;cs[0]&lt;&lt;<span class="charliteral">' '</span>&lt;&lt;cs[1]&lt;&lt;<span class="charliteral">' '</span>&lt;&lt;cs[2]&lt;&lt;std::endl;</div><div class="line">    <span class="keywordflow">if</span> ( is_extensible ) <span class="comment">// = false</span></div><div class="line">      std::cout&lt;&lt;<span class="stringliteral">"It is safe to change the triangulation here."</span>&lt;&lt;std::endl;</div><div class="line">    <span class="keywordflow">else</span></div><div class="line">      std::cout&lt;&lt;<span class="stringliteral">"It is NOT safe to change the triangulation here!"</span>&lt;&lt;std::endl;</div><div class="line"></div><div class="line">    T.convert_to_27_sheeted_covering();</div><div class="line">    cs = T.number_of_sheets();</div><div class="line">    std::cout&lt;&lt;<span class="stringliteral">"Current covering: "</span>&lt;&lt;cs[0]&lt;&lt;<span class="charliteral">' '</span>&lt;&lt;cs[1]&lt;&lt;<span class="charliteral">' '</span>&lt;&lt;cs[2]&lt;&lt;std::endl;</div><div class="line">  }</div><div class="line"></div><div class="line">  std::cout&lt;&lt;<span class="stringliteral">"It is (again) safe to modify the triangulation."</span>&lt;&lt;std::endl;</div><div class="line"></div><div class="line">  <span class="keywordflow">return</span> 0;</div><div class="line">}</div></div><!-- fragment --><h2><a class="anchor" id="Periodic_3_triangulation_3LargePointSet"></a>
Large Point Set</h2>
<p>Two optimizations are available for large point sets. Firstly, spatial sorting can be used to sort the input points according to a Hilbert curve, see chapter <a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Spatial_sorting.tag:../Spatial_sorting/" href="../Spatial_sorting/index.html#secspatial_sorting">Spatial Sorting</a>. Secondly, 36 appropriately chosen dummy points can be inserted to avoid the use of a 27-sheeted covering space in the beginning. These 36 dummy points are deleted in the end. If the point set turns out to not have a Delaunay triangulation in the 1-sheeted covering space, the triangulation is converted to the 27-sheeted covering space during the removal of the 36 dummy points. Note that this might take even longer than computing the triangulation without using this optimization. In general, uniformly distributed random point sets of more than 1000 points have a Delaunay triangulation in the 1-sheeted covering space.</p>
<p>The following example illustrates the use of these optimization techniques.</p>
<p><br />
<b>File</b> <a class="el" href="Periodic_3_triangulation_3_2large_point_set_8cpp-example.html">Periodic_3_triangulation_3/large_point_set.cpp</a> </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;CGAL/Exact_predicates_inexact_constructions_kernel.h&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Periodic_3_Delaunay_triangulation_traits_3.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Periodic_3_Delaunay_triangulation_3.h&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Random.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/point_generators_3.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Timer.h&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;vector&gt;</span></div><div class="line"></div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Kernel_23.tag:../Kernel_23/" href="../Kernel_23/classCGAL_1_1Exact__predicates__inexact__constructions__kernel.html">CGAL::Exact_predicates_inexact_constructions_kernel</a>   K;</div><div class="line"><span class="keyword">typedef</span> <a class="code" href="classCGAL_1_1Periodic__3__Delaunay__triangulation__traits__3.html">CGAL::Periodic_3_Delaunay_triangulation_traits_3&lt;K&gt;</a>   Gt;</div><div class="line"><span class="keyword">typedef</span> <a class="code" href="classCGAL_1_1Periodic__3__Delaunay__triangulation__3.html">CGAL::Periodic_3_Delaunay_triangulation_3&lt;Gt&gt;</a>         P3DT3;</div><div class="line"></div><div class="line"><span class="keyword">typedef</span> P3DT3::Point          Point;</div><div class="line"></div><div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span>, <span class="keywordtype">char</span>**)</div><div class="line">{</div><div class="line">  CGAL::Timer t;</div><div class="line">  <span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/STL_Extension.tag:../STL_Extension/" href="../STL_Extension/classCGAL_1_1Creator__uniform__3.html">CGAL::Creator_uniform_3&lt;double, Point&gt;</a> Creator;</div><div class="line">  CGAL::Random random(7);</div><div class="line">  CGAL::Random_points_in_cube_3&lt;Point, Creator&gt; in_cube(.5, random);</div><div class="line"></div><div class="line">  <span class="keywordtype">int</span> n = 10000;</div><div class="line">  std::vector&lt;Point&gt; pts;</div><div class="line"></div><div class="line">  P3DT3 PT1, PT2, PT3;</div><div class="line"></div><div class="line">  <span class="comment">// Generating n random points</span></div><div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0 ; i &lt; n ; i++) {</div><div class="line">    Point p = *in_cube;</div><div class="line">    in_cube++;</div><div class="line">    pts.push_back(Point(p.x()+.5,p.y()+.5,p.z()+.5));</div><div class="line">  }</div><div class="line"></div><div class="line">  <span class="comment">// Standard insertion</span></div><div class="line">  t.start();</div><div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0 ; i &lt; n ; i++) {</div><div class="line">    PT1.insert(pts[i]);</div><div class="line">  }</div><div class="line">  t.stop();</div><div class="line">  std::cout&lt;&lt;<span class="stringliteral">"  Time: "</span>&lt;&lt;t.time()&lt;&lt;<span class="stringliteral">" sec. (Standard insertion)"</span>&lt;&lt;std::endl;</div><div class="line">  t.reset();</div><div class="line"></div><div class="line">  <span class="comment">// Iterator range insertion using spatial sorting but no dummy points</span></div><div class="line">  t.start();</div><div class="line">  PT2.insert(pts.begin(), pts.end()); <span class="comment">// third parameter defaults to false</span></div><div class="line">  t.stop();</div><div class="line">  std::cout&lt;&lt;<span class="stringliteral">"  Time: "</span>&lt;&lt;t.time()&lt;&lt;<span class="stringliteral">" sec. (with spatial sorting)"</span>&lt;&lt;std::endl;</div><div class="line">  t.reset();</div><div class="line"></div><div class="line">  <span class="comment">// Iterator range insertion using spatial sorting and dummy point heuristic</span></div><div class="line">  t.start();</div><div class="line">  PT3.insert(pts.begin(), pts.end(), <span class="keyword">true</span>);</div><div class="line">  t.stop();</div><div class="line">  std::cout&lt;&lt;<span class="stringliteral">"  Time: "</span>&lt;&lt;t.time()&lt;&lt;<span class="stringliteral">" sec. (Dummy point heuristic)"</span>&lt;&lt;std::endl;</div><div class="line"></div><div class="line">  <span class="keywordflow">return</span> 0;</div><div class="line">}</div></div><!-- fragment --><h2><a class="anchor" id="Periodic_3_triangulation_3GeometricAccess"></a>
Geometric Access</h2>
<p>Some application might use the geometric primitives of a triangulation as an input but not require a simplicial complex. We provide for these cases the geometric iterators that return only the geometric primitives fulfilling some properties. In the following example, we use the <code><a class="el" href="classCGAL_1_1Periodic__3__triangulation__3.html#a9fb6b751e82c0dbae9e69f193c8821d3" title="iterator over the triangles corresponding to facets of the triangulation. ">Periodic_3_triangulation_3::Periodic_triangle_iterator</a></code> with the option <code>UNIQUE_COVER_DOMAIN</code>. This means that only the triangles that have a non-empty intersection with the original domain of the 1-sheeted covering space are returned, see Figure <a class="el" href="classCGAL_1_1Periodic__3__triangulation__3.html#P3Triangulation3figgeom_iterators">P3Triangulation3figgeom_iterators</a>. The <code><a class="el" href="classCGAL_1_1Periodic__3__triangulation__3.html#a4d8a791d313a7e2320079d78e9e44041" title="A periodic triangle. ">Periodic_3_triangulation_3::Periodic_triangle</a></code> is actually a three-dimensional array of point-offset pairs. We check for all three entries of the periodic triangle whether the offset is (0,0,0) using the method <code>is_null</code>. If so, we convert the periodic triangle to a <code>PK::Triangle_3</code>, which requires <em>exact constructions</em> to be exact.</p>
<p><br />
<b>File</b> <a class="el" href="Periodic_3_triangulation_3_2geometric_access_8cpp-example.html">Periodic_3_triangulation_3/geometric_access.cpp</a> </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;CGAL/Exact_predicates_inexact_constructions_kernel.h&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Periodic_3_Delaunay_triangulation_traits_3.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Periodic_3_Delaunay_triangulation_3.h&gt;</span></div><div class="line"></div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Kernel_23.tag:../Kernel_23/" href="../Kernel_23/classCGAL_1_1Exact__predicates__inexact__constructions__kernel.html">CGAL::Exact_predicates_inexact_constructions_kernel</a>  K;</div><div class="line"><span class="keyword">typedef</span> <a class="code" href="classCGAL_1_1Periodic__3__Delaunay__triangulation__traits__3.html">CGAL::Periodic_3_Delaunay_triangulation_traits_3&lt;K&gt;</a>  Gt;</div><div class="line"><span class="keyword">typedef</span> <a class="code" href="classCGAL_1_1Periodic__3__Delaunay__triangulation__3.html">CGAL::Periodic_3_Delaunay_triangulation_3&lt;Gt&gt;</a>        P3DT3;</div><div class="line"></div><div class="line"><span class="keyword">typedef</span> Gt::Point_3        Point;</div><div class="line"><span class="keyword">typedef</span> Gt::Triangle_3     Triangle;</div><div class="line"></div><div class="line"><span class="keyword">typedef</span> P3DT3::Periodic_triangle           Periodic_triangle;</div><div class="line"><span class="keyword">typedef</span> P3DT3::Periodic_triangle_iterator  Periodic_triangle_iterator;</div><div class="line"><span class="keyword">typedef</span> P3DT3::Iterator_type               Iterator_type;</div><div class="line"></div><div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span>, <span class="keywordtype">char</span>**) {</div><div class="line">  P3DT3 T;</div><div class="line"></div><div class="line">  T.<a class="code" href="classCGAL_1_1Periodic__3__Delaunay__triangulation__3.html#a00517885761d298a85ecccf15f8a9559">insert</a>(Point(0,0,0));</div><div class="line">  T.insert(Point(0,0,0.5));</div><div class="line">  T.insert(Point(0,0.5,0.5));</div><div class="line">  T.insert(Point(0.5,0,0.5));</div><div class="line"></div><div class="line">  Periodic_triangle pt;</div><div class="line">  Triangle t_bd;</div><div class="line"></div><div class="line">  <span class="comment">// Extracting the triangles that have a non-empty intersection with</span></div><div class="line">  <span class="comment">// the original domain of the 1-sheeted covering space</span></div><div class="line">  <span class="keywordflow">for</span> (Periodic_triangle_iterator ptit = T.periodic_triangles_begin(P3DT3::UNIQUE_COVER_DOMAIN);</div><div class="line">       ptit != T.periodic_triangles_end(P3DT3::UNIQUE_COVER_DOMAIN); ++ptit) {</div><div class="line">    pt = *ptit;</div><div class="line">    <span class="keywordflow">if</span> (! (pt[0].second.is_null() &amp;&amp; pt[1].second.is_null() &amp;&amp; pt[2].second.is_null()) ) {</div><div class="line">      <span class="comment">// Convert the current Periodic_triangle to a Triangle if it is</span></div><div class="line">      <span class="comment">// not strictly contained inside the original domain.</span></div><div class="line">      <span class="comment">// Note that this requires EXACT constructions to be exact!</span></div><div class="line">      t_bd = T.construct_triangle(pt);</div><div class="line">    }</div><div class="line">  }</div><div class="line">}</div></div><!-- fragment --><h2><a class="anchor" id="Periodic_3_triangulation_3PeriodicRegularTriangulations"></a>
Periodic Regular Triangulations</h2>
<p>The following five examples illustrate various features of 3D periodic regular triangulations.</p>
<h3><a class="anchor" id="Periodic_3_triangulation_3P3TR3FirstExample"></a>
Basic example</h3>
<p>This example shows the incremental construction of a 3D Delaunay triangulation, the location of a point and how to perform elementary operations on indices in a cell. It uses the default parameter of the class <code><a class="el" href="classCGAL_1_1Periodic__3__regular__triangulation__3.html" title="The class Periodic_3_regular_triangulation_3 represents a weighted Delaunay triangulation in three-di...">Periodic_3_regular_triangulation_3</a></code> for the triangulation data structure.</p>
<p><br />
<b>File</b> <a class="el" href="Periodic_3_triangulation_3_2simple_regular_example_8cpp-example.html">Periodic_3_triangulation_3/simple_regular_example.cpp</a> </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;CGAL/Exact_predicates_inexact_constructions_kernel.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Periodic_3_regular_triangulation_traits_3.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Periodic_3_regular_triangulation_3.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/periodic_3_triangulation_3_io.h&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;fstream&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;cassert&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;list&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;vector&gt;</span></div><div class="line"></div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Kernel_23.tag:../Kernel_23/" href="../Kernel_23/classCGAL_1_1Exact__predicates__inexact__constructions__kernel.html">CGAL::Exact_predicates_inexact_constructions_kernel</a>       K;</div><div class="line"><span class="keyword">typedef</span> <a class="code" href="classCGAL_1_1Periodic__3__regular__triangulation__traits__3.html">CGAL::Periodic_3_regular_triangulation_traits_3&lt;K&gt;</a>        Gt;</div><div class="line"><span class="keyword">typedef</span> <a class="code" href="classCGAL_1_1Periodic__3__regular__triangulation__3.html">CGAL::Periodic_3_regular_triangulation_3&lt;Gt&gt;</a>              P3RT3;</div><div class="line"></div><div class="line"><span class="keyword">typedef</span> P3RT3::Bare_point        Point;</div><div class="line"><span class="keyword">typedef</span> P3RT3::Weighted_point    Weighted_point;</div><div class="line"><span class="keyword">typedef</span> P3RT3::Iso_cuboid        Iso_cuboid;</div><div class="line"><span class="keyword">typedef</span> P3RT3::Vertex_handle     Vertex_handle;</div><div class="line"><span class="keyword">typedef</span> P3RT3::Cell_handle       Cell_handle;</div><div class="line"><span class="keyword">typedef</span> P3RT3::Locate_type       Locate_type;</div><div class="line"></div><div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span>, <span class="keywordtype">char</span>**)</div><div class="line">{</div><div class="line">  Iso_cuboid domain(-1,-1,-1, 2,2,2); <span class="comment">// the fundamental domain</span></div><div class="line"></div><div class="line">  <span class="comment">// construction from a list of weighted points :</span></div><div class="line">  std::list&lt;Weighted_point&gt; L;</div><div class="line">  L.push_front(Weighted_point(Point(0,0,0), 0.01));</div><div class="line">  L.push_front(Weighted_point(Point(1,0,0), 0.02));</div><div class="line">  L.push_front(Weighted_point(Point(0,1,0), 0.03));</div><div class="line"></div><div class="line">  P3RT3 T(L.begin(), L.end(), domain); <span class="comment">// put the domain with the constructor</span></div><div class="line"></div><div class="line">  P3RT3::size_type n = T.number_of_vertices();</div><div class="line"></div><div class="line">  <span class="comment">// insertion from a vector :</span></div><div class="line">  std::vector&lt;Weighted_point&gt; V(3);</div><div class="line">  V[0] = Weighted_point(Point(0,0,1), 0.04);</div><div class="line">  V[1] = Weighted_point(Point(1,1,1), 0.05);</div><div class="line">  V[2] = Weighted_point(Point(-1,-1,-1), 0.06);</div><div class="line"></div><div class="line">  n = n + T.insert(V.begin(), V.end());</div><div class="line"></div><div class="line">  assert( n == 6 );       <span class="comment">// 6 points have been inserted</span></div><div class="line">  assert( T.is_valid() ); <span class="comment">// checking validity of T</span></div><div class="line"></div><div class="line">  Locate_type lt;</div><div class="line">  <span class="keywordtype">int</span> li, lj;</div><div class="line">  Weighted_point p(Point(0,0,0), 1.);</div><div class="line">  Cell_handle c = T.locate(p, lt, li, lj);</div><div class="line">  <span class="comment">// p is the vertex of c of index li :</span></div><div class="line">  assert( lt == P3RT3::VERTEX );</div><div class="line">  assert( c-&gt;vertex(li)-&gt;point() == p );</div><div class="line"></div><div class="line">  Vertex_handle v = c-&gt;vertex( (li+1)&amp;3 );</div><div class="line">  <span class="comment">// v is another vertex of c</span></div><div class="line">  Cell_handle nc = c-&gt;neighbor(li);</div><div class="line">  <span class="comment">// nc = neighbor of c opposite to the vertex associated with p</span></div><div class="line">  <span class="comment">// nc must have vertex v :</span></div><div class="line">  <span class="keywordtype">int</span> nli;</div><div class="line">  assert( nc-&gt;has_vertex( v, nli ) );</div><div class="line">  <span class="comment">// nli is the index of v in nc</span></div><div class="line"></div><div class="line">  <span class="comment">// writing file output</span></div><div class="line">  std::ofstream oFileT(<span class="stringliteral">"output_regular.tri"</span>, std::ios::out); <span class="comment">// as a .tri file</span></div><div class="line">  oFileT &lt;&lt; T;</div><div class="line"></div><div class="line">  std::ofstream to_off(<span class="stringliteral">"output_regular.off"</span>);</div><div class="line">  CGAL::write_triangulation_to_off(to_off, T);</div><div class="line"></div><div class="line">  std::ofstream d_to_off(<span class="stringliteral">"output_regular_dual.off"</span>); <span class="comment">// as a .off file</span></div><div class="line">  draw_dual_to_off(d_to_off, T);</div><div class="line"></div><div class="line">  <span class="comment">// reading file output</span></div><div class="line">  P3RT3 T1;</div><div class="line">  std::ifstream iFileT(<span class="stringliteral">"output_regular.tri"</span>,std::ios::in);</div><div class="line">  iFileT &gt;&gt; T1;</div><div class="line">  assert( T1.is_valid() );</div><div class="line">  assert( T1.number_of_vertices() == T.number_of_vertices() );</div><div class="line">  assert( T1.number_of_cells() == T.number_of_cells() );</div><div class="line"></div><div class="line">  <span class="keywordflow">return</span> 0;</div><div class="line">}</div></div><!-- fragment --><h3><a class="anchor" id="Periodic_3_triangulation_3P3TR3PointInsertionAndVertexRemoval"></a>
Point Insertion and Vertex Removal</h3>
<p>This example shows the incremental construction of a 3D regular triangulation, and the removal of a vertex. It uses the default parameter of the <code><a class="el" href="classCGAL_1_1Periodic__3__regular__triangulation__3.html" title="The class Periodic_3_regular_triangulation_3 represents a weighted Delaunay triangulation in three-di...">Periodic_3_regular_triangulation_3</a></code> class for the triangulation data structure.</p>
<p><br />
<b>File</b> <a class="el" href="Periodic_3_triangulation_3_2p3rt3_insert_remove_8cpp-example.html">Periodic_3_triangulation_3/p3rt3_insert_remove.cpp</a> </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;CGAL/Exact_predicates_inexact_constructions_kernel.h&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Periodic_3_regular_triangulation_traits_3.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Periodic_3_regular_triangulation_3.h&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div><div class="line"></div><div class="line"><span class="keyword">typedef</span> CGAL::Epick K;</div><div class="line"><span class="keyword">typedef</span> K::FT FT;</div><div class="line"></div><div class="line"><span class="keyword">typedef</span> <a class="code" href="classCGAL_1_1Periodic__3__regular__triangulation__traits__3.html">CGAL::Periodic_3_regular_triangulation_traits_3&lt;K&gt;</a>        Gt;</div><div class="line"><span class="keyword">typedef</span> <a class="code" href="classCGAL_1_1Periodic__3__regular__triangulation__3.html">CGAL::Periodic_3_regular_triangulation_3&lt;Gt&gt;</a>              P3RT3;</div><div class="line"></div><div class="line"><span class="keyword">typedef</span> Gt::Weighted_point_3                                Weighted_point_3;</div><div class="line"><span class="keyword">typedef</span> Gt::Point_3                                         Point_3;</div><div class="line"></div><div class="line"><span class="keyword">typedef</span> P3RT3::Vertex_handle                                Vertex_handle;</div><div class="line"></div><div class="line"><span class="keywordtype">int</span> main (<span class="keywordtype">int</span>, <span class="keywordtype">char</span>**)</div><div class="line">{</div><div class="line">  P3RT3 p3rt3(P3RT3::Iso_cuboid(0,0,0, 1,1,1));</div><div class="line"></div><div class="line">  p3rt3.insert(Weighted_point_3(Point_3(0.1,0.1,0.1), 0.01));</div><div class="line">  p3rt3.insert(Weighted_point_3(Point_3(0.9,0.1,0.1), 0.01));</div><div class="line">  p3rt3.insert(Weighted_point_3(Point_3(0.1,0.9,0.1), 0.01));</div><div class="line">  p3rt3.insert(Weighted_point_3(Point_3(0.1,0.1,0.9), 0.01));</div><div class="line">  p3rt3.insert(Weighted_point_3(Point_3(0.4,0.4,0.4), 0.001));</div><div class="line"></div><div class="line">  <span class="keywordflow">while</span> (p3rt3.number_of_vertices())</div><div class="line">    p3rt3.remove(p3rt3.vertices_begin());</div><div class="line"></div><div class="line">  std::cout &lt;&lt; <span class="stringliteral">"EXIT SUCCESS"</span> &lt;&lt; std::endl;</div><div class="line">  <span class="keywordflow">return</span> 0;</div><div class="line">}</div></div><!-- fragment --><h3><a class="anchor" id="Periodic_3_triangulation_3P3TR3SecondExample"></a>
Data Structure</h3>
<p>This example shows the incremental construction of a 3D regular triangulation. It uses a more appropriate triangulation data structure, which saves some memory resources.</p>
<p><br />
<b>File</b> <a class="el" href="Periodic_3_triangulation_3_2p3rt3_insert_only_8cpp-example.html">Periodic_3_triangulation_3/p3rt3_insert_only.cpp</a> </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;CGAL/Exact_predicates_inexact_constructions_kernel.h&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Periodic_3_regular_triangulation_traits_3.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Periodic_3_regular_triangulation_3.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/periodic_3_triangulation_3_io.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Regular_triangulation_vertex_base_3.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Regular_triangulation_cell_base_3.h&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div><div class="line"></div><div class="line"><span class="keyword">typedef</span> CGAL::Epick                                              K;</div><div class="line"><span class="keyword">typedef</span> <a class="code" href="classCGAL_1_1Periodic__3__regular__triangulation__traits__3.html">CGAL::Periodic_3_regular_triangulation_traits_3&lt;K&gt;</a>       Gt;</div><div class="line"></div><div class="line"><span class="comment">/* If remove() isn't called in our program, we can use a triangulation data structure</span></div><div class="line"><span class="comment"> * more appropriate, which saves some memory resources.</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Triangulation_3.tag:../Triangulation_3/" href="../Triangulation_3/classCGAL_1_1Regular__triangulation__vertex__base__3.html">CGAL::Regular_triangulation_vertex_base_3</a>&lt;Gt,</div><div class="line">          <a class="code" href="classCGAL_1_1Periodic__3__triangulation__ds__vertex__base__3.html">CGAL::Periodic_3_triangulation_ds_vertex_base_3&lt;&gt;</a> &gt;    Vb;</div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Triangulation_3.tag:../Triangulation_3/" href="../Triangulation_3/classCGAL_1_1Regular__triangulation__cell__base__3.html">CGAL::Regular_triangulation_cell_base_3</a>&lt;Gt,</div><div class="line">          <a class="code" href="classCGAL_1_1Periodic__3__triangulation__ds__cell__base__3.html">CGAL::Periodic_3_triangulation_ds_cell_base_3&lt;&gt;</a> &gt;      Cb;</div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/TDS_3.tag:../TDS_3/" href="../TDS_3/classCGAL_1_1Triangulation__data__structure__3.html">CGAL::Triangulation_data_structure_3&lt;Vb, Cb&gt;</a>             Tds;</div><div class="line"></div><div class="line"><span class="keyword">typedef</span> <a class="code" href="classCGAL_1_1Periodic__3__regular__triangulation__3.html">CGAL::Periodic_3_regular_triangulation_3&lt;Gt, Tds&gt;</a>        P3RT3;</div><div class="line"></div><div class="line"><span class="keyword">typedef</span> Gt::Iso_cuboid_3                                         Iso_cuboid;</div><div class="line"><span class="keyword">typedef</span> Gt::Weighted_point_3                                     Weighted_point_3;</div><div class="line"><span class="keyword">typedef</span> Gt::Point_3                                              Point_3;</div><div class="line"></div><div class="line"><span class="keyword">typedef</span> P3RT3::Vertex_handle Vertex_handle;</div><div class="line"></div><div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span>, <span class="keywordtype">char</span>**)</div><div class="line">{</div><div class="line">  P3RT3 p3rt3(P3RT3::Iso_cuboid(0,0,0, 1,1,1));</div><div class="line"></div><div class="line">  p3rt3.insert(Weighted_point_3(Point_3(0.1,0.1,0.1), 0.01));</div><div class="line">  p3rt3.insert(Weighted_point_3(Point_3(0.9,0.1,0.1), 0.01));</div><div class="line">  p3rt3.insert(Weighted_point_3(Point_3(0.1,0.9,0.1), 0.01));</div><div class="line">  p3rt3.insert(Weighted_point_3(Point_3(0.1,0.1,0.9), 0.01));</div><div class="line">  p3rt3.insert(Weighted_point_3(Point_3(0.4,0.4,0.4), 0.001));</div><div class="line"></div><div class="line">  std::cout &lt;&lt; <span class="stringliteral">"EXIT SUCCESS"</span> &lt;&lt; std::endl;</div><div class="line">  <span class="keywordflow">return</span> 0;</div><div class="line">}</div></div><!-- fragment --><h3><a class="anchor" id="Periodic_3_triangulation_3P3TR3ThirdExample"></a>
Hidden Points</h3>
<p>This example shows that points can be hidden during the incremental construction of a 3D regular triangulation.</p>
<p><br />
<b>File</b> <a class="el" href="Periodic_3_triangulation_3_2p3rt3_hidden_points_8cpp-example.html">Periodic_3_triangulation_3/p3rt3_hidden_points.cpp</a> </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;CGAL/Exact_predicates_inexact_constructions_kernel.h&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Periodic_3_regular_triangulation_traits_3.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Periodic_3_regular_triangulation_3.h&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div><div class="line"></div><div class="line"><span class="keyword">typedef</span> CGAL::Epick                                              K;</div><div class="line"><span class="keyword">typedef</span> <a class="code" href="classCGAL_1_1Periodic__3__regular__triangulation__traits__3.html">CGAL::Periodic_3_regular_triangulation_traits_3&lt;K&gt;</a>       Gt;</div><div class="line"><span class="keyword">typedef</span> <a class="code" href="classCGAL_1_1Periodic__3__regular__triangulation__3.html">CGAL::Periodic_3_regular_triangulation_3&lt;Gt&gt;</a>             P3RT3;</div><div class="line"></div><div class="line"><span class="keyword">typedef</span> Gt::Iso_cuboid_3                                     Iso_cuboid;</div><div class="line"><span class="keyword">typedef</span> Gt::Point_3                                          Point_3;</div><div class="line"><span class="keyword">typedef</span> Gt::Weighted_point_3                                 Weighted_point_3;</div><div class="line"></div><div class="line"><span class="keyword">typedef</span> P3RT3::Vertex_handle                                 Vertex_handle;</div><div class="line"></div><div class="line"><span class="keywordtype">int</span> main ()</div><div class="line">{</div><div class="line">  P3RT3 p3rt3(P3RT3::Iso_cuboid(0,0,0, 1,1,1));</div><div class="line"></div><div class="line">  p3rt3.insert(Weighted_point_3(Point_3(0.1,0.1,0.1), 0.01));</div><div class="line">  p3rt3.insert(Weighted_point_3(Point_3(0.9,0.1,0.1), 0.01));</div><div class="line">  p3rt3.insert(Weighted_point_3(Point_3(0.1,0.91,0.1), 0.01));</div><div class="line">  p3rt3.insert(Weighted_point_3(Point_3(0.1,0.1,0.89), 0.01));</div><div class="line">  p3rt3.insert(Weighted_point_3(Point_3(0.101,0.101,0.101), 0.001));</div><div class="line">  assert(p3rt3.is_valid());</div><div class="line"></div><div class="line">  std::cout &lt;&lt; <span class="stringliteral">"Number of vertices :      "</span> &lt;&lt; p3rt3.number_of_vertices() &lt;&lt; std::endl;</div><div class="line">  std::cout &lt;&lt; <span class="stringliteral">"Number of hidden points : "</span> &lt;&lt; p3rt3.number_of_hidden_points() &lt;&lt; std::endl;</div><div class="line"></div><div class="line">  std::cout &lt;&lt; <span class="stringliteral">"Removing the first point..."</span> &lt;&lt; std::endl;</div><div class="line">  p3rt3.remove(p3rt3.vertices_begin());</div><div class="line">  <span class="comment">// The first point is removed and the hidden point is revealed.</span></div><div class="line"></div><div class="line">  std::cout &lt;&lt; <span class="stringliteral">"Number of vertices :      "</span> &lt;&lt; p3rt3.number_of_vertices() &lt;&lt; std::endl;</div><div class="line">  std::cout &lt;&lt; <span class="stringliteral">"Number of hidden points : "</span> &lt;&lt; p3rt3.number_of_hidden_points() &lt;&lt; std::endl;</div><div class="line"></div><div class="line">  std::cout &lt;&lt; <span class="stringliteral">"EXIT SUCCESS"</span> &lt;&lt; std::endl;</div><div class="line">  <span class="keywordflow">return</span> 0;</div><div class="line">}</div></div><!-- fragment --><h3><a class="anchor" id="Periodic_3_triangulation_3P3TR3FourthExample"></a>
Bad Weights</h3>
<p>Finally, this example shows how points whose weight does not satisfy the precondition are handled during the incremental construction of a 3D regular triangulation.</p>
<p><br />
<b>File</b> <a class="el" href="Periodic_3_triangulation_3_2p3rt3_insert_point_with_bad_weight_8cpp-example.html">Periodic_3_triangulation_3/p3rt3_insert_point_with_bad_weight.cpp</a> </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;CGAL/Exact_predicates_inexact_constructions_kernel.h&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Regular_triangulation_vertex_base_3.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Regular_triangulation_cell_base_3.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Periodic_3_regular_triangulation_traits_3.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Periodic_3_regular_triangulation_3.h&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div><div class="line"></div><div class="line"><span class="keyword">typedef</span> CGAL::Epick                                         K;</div><div class="line"><span class="keyword">typedef</span> <a class="code" href="classCGAL_1_1Periodic__3__regular__triangulation__traits__3.html">CGAL::Periodic_3_regular_triangulation_traits_3&lt;K&gt;</a>  Gt;</div><div class="line"></div><div class="line"><span class="comment">/* If remove() isn't called in our program, we can use a triangulation data structure more appropriate</span></div><div class="line"><span class="comment"> * which saves some memory resources.</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Triangulation_3.tag:../Triangulation_3/" href="../Triangulation_3/classCGAL_1_1Regular__triangulation__vertex__base__3.html">CGAL::Regular_triangulation_vertex_base_3</a>&lt;Gt,</div><div class="line">          <a class="code" href="classCGAL_1_1Periodic__3__triangulation__ds__vertex__base__3.html">CGAL::Periodic_3_triangulation_ds_vertex_base_3&lt;&gt;</a> &gt;    Vb;</div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Triangulation_3.tag:../Triangulation_3/" href="../Triangulation_3/classCGAL_1_1Regular__triangulation__cell__base__3.html">CGAL::Regular_triangulation_cell_base_3</a>&lt;Gt,</div><div class="line">          <a class="code" href="classCGAL_1_1Periodic__3__triangulation__ds__cell__base__3.html">CGAL::Periodic_3_triangulation_ds_cell_base_3&lt;&gt;</a> &gt;      Cb;</div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/TDS_3.tag:../TDS_3/" href="../TDS_3/classCGAL_1_1Triangulation__data__structure__3.html">CGAL::Triangulation_data_structure_3&lt;Vb, Cb&gt;</a>             Tds;</div><div class="line"></div><div class="line"><span class="keyword">typedef</span> <a class="code" href="classCGAL_1_1Periodic__3__regular__triangulation__3.html">CGAL::Periodic_3_regular_triangulation_3&lt;Gt, Tds&gt;</a>        P3RT3;</div><div class="line"></div><div class="line"><span class="keyword">typedef</span> Gt::Iso_cuboid_3                                         Iso_cuboid;</div><div class="line"><span class="keyword">typedef</span> Gt::Weighted_point_3                                     Weighted_point_3;</div><div class="line"><span class="keyword">typedef</span> Gt::Point_3                                              Point_3;</div><div class="line"></div><div class="line"><span class="keywordtype">int</span> main ()</div><div class="line">{</div><div class="line">  P3RT3 p3rt3(P3RT3::Iso_cuboid(0,0,0, 1,1,1));</div><div class="line"></div><div class="line">  <span class="comment">// Here, we insert a point with a bad weight.</span></div><div class="line"><span class="comment">//  p3rt3.insert(Weighted_point_3(Point_3(0.5,0.5,0.5), 1.));</span></div><div class="line"></div><div class="line"><span class="comment">//   In debug mode, if we uncomment the previous instruction, the program displays the following error message :</span></div><div class="line"><span class="comment">//   terminate called after throwing an instance of 'CGAL::Precondition_exception'</span></div><div class="line"><span class="comment">//     what():  CGAL ERROR: precondition violation!</span></div><div class="line"><span class="comment">//   Expr: point.weight() &lt; ( FT(0.015625) * (domain().xmax()-domain().xmin()) * (domain().xmax()-domain().xmin()) )</span></div><div class="line"><span class="comment">//   [...]</span></div><div class="line"><span class="comment">//   Explanation: point.weight() &lt; 1/64 * domain_size * domain_size</span></div><div class="line"></div><div class="line">  std::cout &lt;&lt; <span class="stringliteral">"EXIT SUCCESS"</span> &lt;&lt; std::endl;</div><div class="line">  <span class="keywordflow">return</span> 0;</div><div class="line">}</div></div><!-- fragment --><h2><a class="anchor" id="Periodic_3_triangulation_3PeriodicAlphaShapes"></a>
Periodic Alpha Shapes</h2>
<p>It is possible to use the classes <code><a class="el" href="classCGAL_1_1Periodic__3__Delaunay__triangulation__3.html" title="The class Periodic_3_Delaunay_triangulation_3 represents a Delaunay triangulation in three-dimensiona...">Periodic_3_Delaunay_triangulation_3</a></code> and <code><a class="el" href="classCGAL_1_1Periodic__3__regular__triangulation__3.html" title="The class Periodic_3_regular_triangulation_3 represents a weighted Delaunay triangulation in three-di...">Periodic_3_regular_triangulation_3</a></code> as underlying triangulations to compute alpha shapes. Examples of usage can be found in Section <a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Alpha_shapes_3.tag:../Alpha_shapes_3/" href="../Alpha_shapes_3/index.html#AlphaShape_3DExampleForPeriodicAlphaShapes">Example for Periodic Alpha Shapes</a> of the chapter on 3D alpha shapes.</p>
<h1><a class="anchor" id="Periodic_3_triangulation_3Design"></a>
Design and Implementation History</h1>
<p>In 2006, Nico Kruithof started to work with Monique Teillaud on the 3D Periodic Triangulations package.</p>
<p>In 2007, Manuel Caroli continued work on the algorithms <a class="el" href="citelist.html#CITEREF_cgal:ct-c3pt-09">[1]</a> and on the package with Monique Teillaud.</p>
<p>In 2015, Aymeric Pellé contributed to adding regular triangulations in the package.</p>
<p>The package follows the design of the 3D Triangulations package (see Chapter <a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Triangulation_3.tag:../Triangulation_3/" href="../Triangulation_3/index.html#Chapter_3D_Triangulations">3D Triangulations</a>). </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<!-- The footer div is not part of the default but we require it to
move the footer to the bottom of the page. -->
<div id="footer">
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Mon Oct 1 2018 11:59:05 for CGAL 4.13 - 3D Periodic Triangulations by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen" /></a> 1.8.13 </li>
  </ul>
</div>
</div>
</body>


</html>
