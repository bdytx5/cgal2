<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="canonical" href="https://doc.cgal.org/latest/Surface_mesh_skeletonization/index.html"/>

<link rel="icon" type="image/png" href="../Manual/g-196x196-doc.png" />
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8" />
<meta http-equiv="X-UA-Compatible" content="IE=9" />
<meta name="generator" content="Doxygen 1.8.13" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>CGAL 4.13 - Triangulated Surface Mesh Skeletonization: User Manual</title>
<!-- <link href="../Manual/tabs.css" rel="stylesheet" type="text/css"/> -->
<script type="text/javascript" src="../Manual/jquery.js"></script>
<script type="text/javascript" src="../Manual/dynsections.js"></script>
<!-- Manually include treeview and search to avoid bloat and to fix
     paths to the directory Manual . -->
<!-- $.treeview -->
<!-- $.search -->
<link href="navtree.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="../Manual/resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="../Manual/search/search.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="../Manual/search/searchdata.js"></script>
<script type="text/javascript" src="../Manual/search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="../Manual/search/search.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="../Manual/search/search.js"></script>
<!-- Manually done below. -->
<link href="../Manual/stylesheet.css" rel="stylesheet" type="text/css" />
<!-- This should probably be an extrastylesheet instead of hardcoded. -->
<link href="../Manual/cgal_stylesheet.css" rel="stylesheet" type="text/css" />
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js"></script>
<script src="../Manual/hacks.js" type="text/javascript"></script>
<script src="modules.js" type="text/javascript"></script>
</head>
<body>
<!-- Custom mathjax -->
<!-- TODO: Remove this with MATHJAX_CODEFILE -->
<span style="display:none">\( \newcommand{\E}{\mathrm{E}} \) \( \newcommand{\A}{\mathrm{A}} \)
\( \newcommand{\R}{\mathrm{R}} \) \( \newcommand{\N}{\mathrm{N}} \) \( \newcommand{\Q}{\mathrm{Q}} \) \( \newcommand{\Z}{\mathrm{Z}} \)
\(
\def\ccSum #1#2#3{
  \sum_{#1}^{#2}{#3}
}
\def\ccProd #1#2#3{
  \sum_{#1}^{#2}{#3}
}\)
</span>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="back-nav">
  <ul>
    <li><a href="https://www.cgal.org/">cgal.org</a></li>
    <li><a href="../Manual/index.html">Top</a></li>
    <li><a href="../Manual/general_intro.html">Getting Started</a></li>
    <li><a href="../Manual/tutorials.html">Tutorials</a></li>
    <li><a href="../Manual/packages.html">Package Overview</a></li>
    <li><a href="../Manual/how_to_cite_cgal.html">Acknowledging CGAL</a></li>
  </ul>
  <!-- In a package SEARCHENGINE = false, so we cannot use 
       insertion. That's why we have to do it manually here. Notice
       that we also take pngs from the Manual. -->
  <div id="MSearchBox" class="MSearchBoxInactive">
    <span class="left">
      <img id="MSearchSelect" src="../Manual/search/mag_sel.png" onmouseover="return searchBox.OnSearchSelectShow()" onmouseout="return searchBox.OnSearchSelectHide()" alt="" />
      <input type="text" id="MSearchField" value="Search" accesskey="S" onfocus="searchBox.OnSearchFieldFocus(true)" onblur="searchBox.OnSearchFieldFocus(false)" onkeyup="searchBox.OnSearchFieldChange(event)" />
    </span><span class="right">
      <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../Manual/search/close.png" alt="" /></a>
    </span>
  </div>
</div>
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">CGAL 4.13 - Triangulated Surface Mesh Skeletonization
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- Code below is usually inserted by doxygen when SEARCHENGINE =
     true. Notice that the path to the search directory is adjusted to
     the top-level.-->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../Manual/search",false,'Search');
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow" onmouseover="return searchBox.OnSearchSelectShow()" onmouseout="return searchBox.OnSearchSelectHide()" onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>
<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" name="MSearchResults" id="MSearchResults">
</iframe>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync" style="display: none"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('index.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">User Manual </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="Chapter_3D_Surface_mesh_skeletonization"></a>  </p><div id="autotoc" class="toc"></div>  <dl class="section author"><dt>Author</dt><dd>Xiang Gao, Sébastien Loriot and Andrea Tagliasacchi</dd></dl>
<h1><a class="anchor" id="MCFSkelSecMot"></a>
Introduction</h1>
<p><a class="anchor" id="fig__Main_image_suggestion"></a></p><div class="image">
<img src="main_image_suggestion.png" alt="main_image_suggestion.png" />
</div>
   <div class="cgal_figure_caption">  <a class="el" href="index.html#fig__Main_image_suggestion">Figure 68.1</a> Curve skeleton of a horse model.  </div>  <br />

<p>Skeletons are effective shape abstractions used in segmentation, shape matching, reconstruction, virtual navigation, etc. As the name implies, a curve skeleton is a graph of curvilinear structures (1D). It is not a medial axis that for a 3D geometry is composed of surfaces (2D). As illustrated in <a class="el" href="index.html#fig__Main_image_suggestion">Figure 68.1</a>, the curve skeleton of a shape captures its essential topology. In this package, we implement the <em>Mean Curvature Skeleton</em> algorithm described in <a class="el" href="citelist.html#CITEREF_tagliasacchi2012mean">[1]</a> that extracts a curve skeleton from a triangulated surface mesh without borders by iteratively contracting the input triangulated surface mesh.</p>
<h1><a class="anchor" id="MCFSkelSecAPI"></a>
User Interface Description</h1>
<h2><a class="anchor" id="MCFSkelSecAPI-IO"></a>
Input and Output</h2>
<p>The input is a triangulated surface mesh, model of the <code><a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/BGL.tag:../BGL/" href="../BGL/classFaceListGraph.html">FaceListGraph</a></code> concept (<code><a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Surface_mesh.tag:../Surface_mesh/" href="../Surface_mesh/classCGAL_1_1Surface__mesh.html">CGAL::Surface_mesh</a></code>, <code><a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Polyhedron.tag:../Polyhedron/" href="../Polyhedron/classCGAL_1_1Polyhedron__3.html">CGAL::Polyhedron_3</a></code>, ...) that has no boundary and that has only one connected component. The skeleton is provided as a graph of type <a href="https://www.boost.org/doc/libs/release/libs/graph/doc/adjacency_list.html"><code>boost::adjacency_list</code></a>. Each vertex of the skeleton is associated to a 3D location point and to the set of input vertices that contracted to that skeleton vertex. Note that due to the construction process of the skeleton, a skeleton vertex might have no corresponding input vertex.</p>
<p>This package needs a sparse linear solver and we recommend the use of <a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Manual.tag:../Manual/" href="../Manual/installation.html#thirdpartyEigen">Eigen</a> 3.2 or later.</p>
<p>The input and output are illustrated in <a class="el" href="index.html#fig__MCFInputOutput">Figure 68.2</a>.</p>
<p><a class="anchor" id="fig__MCFInputOutput"></a></p><div class="image">
<img src="correspondence.png" alt="correspondence.png" />
</div>
   <div class="cgal_figure_caption">  <a class="el" href="index.html#fig__MCFInputOutput">Figure 68.2</a> Left: An input triangulated surface mesh model of an octopus; Middle: The mean curvature flow skeleton extracted using this package; Right: Each vertex of the input surface is associated to a skeleton vertex.  </div>  <br />

<h2><a class="anchor" id="MCFSkelSecAPI-FF"></a>
Free Function</h2>
<p>If a <span style="font-variant: small-caps;">CGAL</span> model of the <code><a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/BGL.tag:../BGL/" href="../BGL/classFaceListGraph.html">FaceListGraph</a></code> concept such as <code><a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Surface_mesh.tag:../Surface_mesh/" href="../Surface_mesh/classCGAL_1_1Surface__mesh.html">CGAL::Surface_mesh</a></code> or <code><a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Polyhedron.tag:../Polyhedron/" href="../Polyhedron/classCGAL_1_1Polyhedron__3.html">CGAL::Polyhedron_3</a></code> is used as triangulated input surface mesh, <a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Manual.tag:../Manual/" href="../Manual/installation.html#thirdpartyEigen">Eigen</a> 3.2 or later is available and <code>CGAL_EIGEN3_ENABLED</code> is defined, the function <code><a class="el" href="group__PkgMeanCurvatureSkeleton3.html#gaf4b49adaa500340ce11630f91b320aec" title="extracts a medially centered curve skeleton for the triangle mesh tmesh. This function uses the class...">CGAL::extract_mean_curvature_flow_skeleton()</a></code> can be used to extract a mean curvature flow skeleton from the input surface mesh using the default parameters, which work well in most cases.</p>
<p>The following example shows how to extract a skeleton out of a triangulated surface mesh and how to access the point of each skeleton vertex and the set of input vertices associated.</p>
<p><br />
<b>File</b> <a class="el" href="Surface_mesh_skeletonization_2simple_mcfskel_example_8cpp-example.html">Surface_mesh_skeletonization/simple_mcfskel_example.cpp</a> </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;CGAL/Simple_cartesian.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Polyhedron_3.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/extract_mean_curvature_flow_skeleton.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/boost/graph/split_graph_into_polylines.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;fstream&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;boost/foreach.hpp&gt;</span></div><div class="line"></div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Kernel_23.tag:../Kernel_23/" href="../Kernel_23/structCGAL_1_1Simple__cartesian.html">CGAL::Simple_cartesian&lt;double&gt;</a>                        <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Kernel_23.tag:../Kernel_23/" href="../Kernel_23/namespaceKernel.html">Kernel</a>;</div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Kernel_23.tag:../Kernel_23/" href="../Kernel_23/classKernel_1_1Point__3.html">Kernel::Point_3</a>                                       Point;</div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Polyhedron.tag:../Polyhedron/" href="../Polyhedron/classCGAL_1_1Polyhedron__3.html">CGAL::Polyhedron_3&lt;Kernel&gt;</a>                            Polyhedron;</div><div class="line"></div><div class="line"><span class="keyword">typedef</span> boost::graph_traits&lt;Polyhedron&gt;::vertex_descriptor    vertex_descriptor;</div><div class="line"></div><div class="line"><span class="keyword">typedef</span> <a class="code" href="classCGAL_1_1Mean__curvature__flow__skeletonization.html">CGAL::Mean_curvature_flow_skeletonization&lt;Polyhedron&gt;</a> Skeletonization;</div><div class="line"><span class="keyword">typedef</span> Skeletonization::Skeleton                             Skeleton;</div><div class="line"></div><div class="line"><span class="keyword">typedef</span> Skeleton::vertex_descriptor                           Skeleton_vertex;</div><div class="line"><span class="keyword">typedef</span> Skeleton::edge_descriptor                             Skeleton_edge;</div><div class="line"></div><div class="line"><span class="comment">//only needed for the display of the skeleton as maximal polylines</span></div><div class="line"><span class="keyword">struct </span>Display_polylines{</div><div class="line">  <span class="keyword">const</span> Skeleton&amp; skeleton;</div><div class="line">  std::ofstream&amp; out;</div><div class="line">  <span class="keywordtype">int</span> polyline_size;</div><div class="line">  std::stringstream sstr;</div><div class="line"></div><div class="line">  Display_polylines(<span class="keyword">const</span> Skeleton&amp; skeleton, std::ofstream&amp; out)</div><div class="line">    : skeleton(skeleton), out(out)</div><div class="line">  {}</div><div class="line"></div><div class="line">  <span class="keywordtype">void</span> start_new_polyline(){</div><div class="line">    polyline_size=0;</div><div class="line">    sstr.str(<span class="stringliteral">""</span>);</div><div class="line">    sstr.clear();</div><div class="line">  }</div><div class="line">  <span class="keywordtype">void</span> add_node(Skeleton_vertex v){</div><div class="line">    ++polyline_size;</div><div class="line">    sstr &lt;&lt; <span class="stringliteral">" "</span> &lt;&lt; skeleton[v].point;</div><div class="line">  }</div><div class="line">  <span class="keywordtype">void</span> end_polyline()</div><div class="line">  {</div><div class="line">    out &lt;&lt; polyline_size &lt;&lt; sstr.str() &lt;&lt; <span class="stringliteral">"\n"</span>;</div><div class="line">  }</div><div class="line">};</div><div class="line"></div><div class="line"><span class="comment">// This example extracts a medially centered skeleton from a given mesh.</span></div><div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>* argv[])</div><div class="line">{</div><div class="line">  std::ifstream input((argc&gt;1)?argv[1]:<span class="stringliteral">"data/elephant.off"</span>);</div><div class="line">  Polyhedron tmesh;</div><div class="line">  input &gt;&gt; tmesh;</div><div class="line">  <span class="keywordflow">if</span> (!<a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/BGL.tag:../BGL/" href="../BGL/group__PkgBGLHelperFct.html#ga11883d231eec1b58f37efe4acedd9588">CGAL::is_triangle_mesh</a>(tmesh))</div><div class="line">  {</div><div class="line">    std::cout &lt;&lt; <span class="stringliteral">"Input geometry is not triangulated."</span> &lt;&lt; std::endl;</div><div class="line">    <span class="keywordflow">return</span> EXIT_FAILURE;</div><div class="line">  }</div><div class="line"></div><div class="line">  Skeleton skeleton;</div><div class="line"></div><div class="line">  <a class="code" href="group__PkgMeanCurvatureSkeleton3.html#gaf4b49adaa500340ce11630f91b320aec">CGAL::extract_mean_curvature_flow_skeleton</a>(tmesh, skeleton);</div><div class="line"></div><div class="line">  std::cout &lt;&lt; <span class="stringliteral">"Number of vertices of the skeleton: "</span> &lt;&lt; boost::num_vertices(skeleton) &lt;&lt; <span class="stringliteral">"\n"</span>;</div><div class="line">  std::cout &lt;&lt; <span class="stringliteral">"Number of edges of the skeleton: "</span> &lt;&lt; boost::num_edges(skeleton) &lt;&lt; <span class="stringliteral">"\n"</span>;</div><div class="line"></div><div class="line">  <span class="comment">// Output all the edges of the skeleton.</span></div><div class="line">  std::ofstream output(<span class="stringliteral">"skel-poly.cgal"</span>);</div><div class="line">  Display_polylines display(skeleton,output);</div><div class="line">  <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/BGL.tag:../BGL/" href="../BGL/group__PkgBGL.html#ga99ea6bf193f1194db5e523e713c82fb9">CGAL::split_graph_into_polylines</a>(skeleton, display);</div><div class="line">  output.close();</div><div class="line"></div><div class="line">  <span class="comment">// Output skeleton points and the corresponding surface points</span></div><div class="line">  output.open(<span class="stringliteral">"correspondance-poly.cgal"</span>);</div><div class="line">  BOOST_FOREACH(Skeleton_vertex v, vertices(skeleton))</div><div class="line">    BOOST_FOREACH(vertex_descriptor vd, skeleton[v].vertices)</div><div class="line">      output &lt;&lt; <span class="stringliteral">"2 "</span> &lt;&lt; skeleton[v].point &lt;&lt; <span class="stringliteral">" "</span></div><div class="line">                     &lt;&lt; <span class="keyword">get</span>(CGAL::vertex_point, tmesh, vd)  &lt;&lt; <span class="stringliteral">"\n"</span>;</div><div class="line"></div><div class="line">  <span class="keywordflow">return</span> EXIT_SUCCESS;</div><div class="line">}</div><div class="line"></div></div><!-- fragment --><h2><a class="anchor" id="MCFSkelSecAPI-AUUFO"></a>
Advanced Usage with the Function Object</h2>
<p>The class <code><a class="el" href="classCGAL_1_1Mean__curvature__flow__skeletonization.html" title="Function object that enables to extract the mean curvature flow skeleton of a triangulated surface me...">CGAL::Mean_curvature_flow_skeletonization</a></code> enables the usage of low level functions such as <a class="el" href="classCGAL_1_1Mean__curvature__flow__skeletonization.html#a64419fbc0d958665302ecc308df3850c"><code>contract_geometry()</code></a> and <a class="el" href="classCGAL_1_1Mean__curvature__flow__skeletonization.html#a6d8ee83dde7082566572363601638fb5"><code>collapse_edges()</code></a>. The class further enables to change the parameters of the algorithm, for example by calling <a class="el" href="classCGAL_1_1Mean__curvature__flow__skeletonization.html#a13b8a8dc3f77229d172b623b6f5f2ffb"><code>set_is_medially_centered()</code></a>. The class gives the user full control over each step of the algorithm as well as the intermediate contracted mesh (called <em>meso-skeleton</em>) as illustrated by <a class="el" href="index.html#fig__MCFMesoSkel">Figure 68.3</a>.</p>
<p><a class="anchor" id="fig__MCFMesoSkel"></a></p><div class="image">
<img src="iterations.png" alt="iterations.png" />
</div>
   <div class="cgal_figure_caption">  <a class="el" href="index.html#fig__MCFMesoSkel">Figure 68.3</a> Three iterations of the mean curvature flow contraction of the horse of <a class="el" href="index.html#fig__Main_image_suggestion">Figure 68.1</a>. The red points indicate vertices where the surface has locally degenerated to a curvilinear structure.  </div>  <br />

<p>In this example, we show how to use the API of the class <code><a class="el" href="classCGAL_1_1Mean__curvature__flow__skeletonization.html" title="Function object that enables to extract the mean curvature flow skeleton of a triangulated surface me...">CGAL::Mean_curvature_flow_skeletonization</a></code>.</p>
<p><br />
<b>File</b> <a class="el" href="Surface_mesh_skeletonization_2MCF_Skeleton_sm_example_8cpp-example.html">Surface_mesh_skeletonization/MCF_Skeleton_sm_example.cpp</a> </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;CGAL/Simple_cartesian.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Surface_mesh.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Mean_curvature_flow_skeletonization.h&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;fstream&gt;</span></div><div class="line"></div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Kernel_23.tag:../Kernel_23/" href="../Kernel_23/structCGAL_1_1Simple__cartesian.html">CGAL::Simple_cartesian&lt;double&gt;</a>                        <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Kernel_23.tag:../Kernel_23/" href="../Kernel_23/namespaceKernel.html">Kernel</a>;</div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Kernel_23.tag:../Kernel_23/" href="../Kernel_23/classKernel_1_1Point__3.html">Kernel::Point_3</a>                                       Point;</div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Surface_mesh.tag:../Surface_mesh/" href="../Surface_mesh/classCGAL_1_1Surface__mesh.html">CGAL::Surface_mesh&lt;Point&gt;</a>                             Triangle_mesh;</div><div class="line"></div><div class="line"><span class="keyword">typedef</span> boost::graph_traits&lt;Triangle_mesh&gt;::vertex_descriptor vertex_descriptor;</div><div class="line"></div><div class="line"><span class="keyword">typedef</span> <a class="code" href="classCGAL_1_1Mean__curvature__flow__skeletonization.html">CGAL::Mean_curvature_flow_skeletonization&lt;Triangle_mesh&gt;</a> Skeletonization;</div><div class="line"><span class="keyword">typedef</span> Skeletonization::Skeleton                             Skeleton;</div><div class="line"></div><div class="line"><span class="keyword">typedef</span> Skeleton::vertex_descriptor                           Skeleton_vertex;</div><div class="line"><span class="keyword">typedef</span> Skeleton::edge_descriptor                             Skeleton_edge;</div><div class="line"></div><div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>* argv[])</div><div class="line">{</div><div class="line">  std::ifstream input((argc&gt;1)?argv[1]:<span class="stringliteral">"data/elephant.off"</span>);</div><div class="line">  Triangle_mesh tmesh;</div><div class="line">  input &gt;&gt; tmesh;</div><div class="line">  <span class="keywordflow">if</span> (!<a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/BGL.tag:../BGL/" href="../BGL/group__PkgBGLHelperFct.html#ga11883d231eec1b58f37efe4acedd9588">CGAL::is_triangle_mesh</a>(tmesh))</div><div class="line">  {</div><div class="line">    std::cout &lt;&lt; <span class="stringliteral">"Input geometry is not triangulated."</span> &lt;&lt; std::endl;</div><div class="line">    <span class="keywordflow">return</span> EXIT_FAILURE;</div><div class="line">  }</div><div class="line"></div><div class="line">  Skeleton skeleton;</div><div class="line">  Skeletonization mcs(tmesh);</div><div class="line"></div><div class="line">  <span class="comment">// 1. Contract the mesh by mean curvature flow.</span></div><div class="line">  mcs.contract_geometry();</div><div class="line"></div><div class="line">  <span class="comment">// 2. Collapse short edges and split bad triangles.</span></div><div class="line">  mcs.collapse_edges();</div><div class="line">  mcs.split_faces();</div><div class="line"></div><div class="line">  <span class="comment">// 3. Fix degenerate vertices.</span></div><div class="line">  mcs.detect_degeneracies();</div><div class="line"></div><div class="line">  <span class="comment">// Perform the above three steps in one iteration.</span></div><div class="line">  mcs.contract();</div><div class="line"></div><div class="line">  <span class="comment">// Iteratively apply step 1 to 3 until convergence.</span></div><div class="line">  mcs.contract_until_convergence();</div><div class="line"></div><div class="line">  <span class="comment">// Convert the contracted mesh into a curve skeleton and</span></div><div class="line">  <span class="comment">// get the correspondent surface points</span></div><div class="line">  mcs.convert_to_skeleton(skeleton);</div><div class="line"></div><div class="line">  std::cout &lt;&lt; <span class="stringliteral">"Number of vertices of the skeleton: "</span> &lt;&lt; boost::num_vertices(skeleton) &lt;&lt; <span class="stringliteral">"\n"</span>;</div><div class="line">  std::cout &lt;&lt; <span class="stringliteral">"Number of edges of the skeleton: "</span> &lt;&lt; boost::num_edges(skeleton) &lt;&lt; <span class="stringliteral">"\n"</span>;</div><div class="line"></div><div class="line">  <span class="comment">// Output all the edges of the skeleton.</span></div><div class="line">  std::ofstream output(<span class="stringliteral">"skel-sm.cgal"</span>);</div><div class="line">  BOOST_FOREACH(Skeleton_edge e, edges(skeleton))</div><div class="line">  {</div><div class="line">    <span class="keyword">const</span> Point&amp; s = skeleton[source(e, skeleton)].point;</div><div class="line">    <span class="keyword">const</span> Point&amp; t = skeleton[target(e, skeleton)].point;</div><div class="line">    output &lt;&lt; <span class="stringliteral">"2 "</span>&lt;&lt; s &lt;&lt; <span class="stringliteral">" "</span> &lt;&lt; t &lt;&lt; <span class="stringliteral">"\n"</span>;</div><div class="line">  }</div><div class="line">  output.close();</div><div class="line"></div><div class="line">  <span class="comment">// Output skeleton points and the corresponding surface points</span></div><div class="line">  output.open(<span class="stringliteral">"correspondance-sm.cgal"</span>);</div><div class="line">  BOOST_FOREACH(Skeleton_vertex v, vertices(skeleton))</div><div class="line">    BOOST_FOREACH(vertex_descriptor vd, skeleton[v].vertices)</div><div class="line">      output &lt;&lt; <span class="stringliteral">"2 "</span> &lt;&lt; skeleton[v].point &lt;&lt; <span class="stringliteral">"  "</span> &lt;&lt; <span class="keyword">get</span>(CGAL::vertex_point, tmesh, vd)  &lt;&lt; <span class="stringliteral">"\n"</span>;</div><div class="line"></div><div class="line">  <span class="keywordflow">return</span> EXIT_SUCCESS;</div><div class="line">}</div></div><!-- fragment --><h2><a class="anchor" id="Mesh"></a>
Segmentation through Skeletonization</h2>
<p>As a proof of concept, we show how to use the skeleton and the association of input vertices to skeleton to compute a segmentation of the input triangulated surface mesh using the package <a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Manual.tag:../Manual/" href="../Manual/packages.html#PkgSurfaceSegmentationSummary">Triangulated Surface Mesh Segmentation</a>. The segmentation algorithm consists in computing a <em>shape diameter function</em> for each face of the input mesh, followed by solving a graph cut problem. Here we use the skeleton to define a new shape diameter function. Specifically, for each face we compute the diameter value as the average distance between its three incident vertices and their corresponding skeletal point. The result of this segmentation is shown in <a class="el" href="index.html#fig__Segmentation">Figure 68.4</a>.</p>
<p><a class="anchor" id="fig__Segmentation"></a></p><div class="image">
<img src="segmentation.png" alt="segmentation.png" />
</div>
   <div class="cgal_figure_caption">  <a class="el" href="index.html#fig__Segmentation">Figure 68.4</a> Left: Curve skeleton extracted of a triangulated surface mesh; Right: Segmentation using the skeleton to compute a shape diameter function.  </div>  <br />

<p><br />
<b>File</b> <a class="el" href="Surface_mesh_skeletonization_2segmentation_example_8cpp-example.html">Surface_mesh_skeletonization/segmentation_example.cpp</a> </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;CGAL/Polyhedron_3.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Polyhedron_items_with_id_3.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Simple_cartesian.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/extract_mean_curvature_flow_skeleton.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/mesh_segmentation.h&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;fstream&gt;</span></div><div class="line"></div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Kernel_23.tag:../Kernel_23/" href="../Kernel_23/structCGAL_1_1Simple__cartesian.html">CGAL::Simple_cartesian&lt;double&gt;</a>                               Kernel;</div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Kernel_23.tag:../Kernel_23/" href="../Kernel_23/classKernel_1_1Point__3.html">Kernel::Point_3</a>                                              Point;</div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Polyhedron.tag:../Polyhedron/" href="../Polyhedron/classCGAL_1_1Polyhedron__3.html">CGAL::Polyhedron_3&lt;Kernel, CGAL::Polyhedron_items_with_id_3&gt;</a> Polyhedron;</div><div class="line"></div><div class="line"><span class="keyword">typedef</span> boost::graph_traits&lt;Polyhedron&gt;::vertex_descriptor           vertex_descriptor;</div><div class="line"><span class="keyword">typedef</span> boost::graph_traits&lt;Polyhedron&gt;::halfedge_descriptor         halfedge_descriptor;</div><div class="line"><span class="keyword">typedef</span> boost::graph_traits&lt;Polyhedron&gt;::face_descriptor             face_descriptor;</div><div class="line"></div><div class="line"><span class="keyword">typedef</span> <a class="code" href="classCGAL_1_1Mean__curvature__flow__skeletonization.html">CGAL::Mean_curvature_flow_skeletonization&lt;Polyhedron&gt;</a>        Skeletonization;</div><div class="line"><span class="keyword">typedef</span> Skeletonization::Skeleton                                    Skeleton;</div><div class="line"></div><div class="line"><span class="keyword">typedef</span> Skeleton::vertex_descriptor                                  Skeleton_vertex;</div><div class="line"></div><div class="line"><span class="comment">// Property map associating a facet with an integer as id to an</span></div><div class="line"><span class="comment">// element in a vector stored internally</span></div><div class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> ValueType&gt;</div><div class="line"><span class="keyword">struct </span>Facet_with_id_pmap</div><div class="line">    : <span class="keyword">public</span> boost::put_get_helper&lt;ValueType&amp;,</div><div class="line">             Facet_with_id_pmap&lt;ValueType&gt; &gt;</div><div class="line">{</div><div class="line">    <span class="keyword">typedef</span> face_descriptor key_type;</div><div class="line">    <span class="keyword">typedef</span> ValueType value_type;</div><div class="line">    <span class="keyword">typedef</span> value_type&amp; reference;</div><div class="line">    <span class="keyword">typedef</span> boost::lvalue_property_map_tag category;</div><div class="line"></div><div class="line">    Facet_with_id_pmap(</div><div class="line">      std::vector&lt;ValueType&gt;&amp; internal_vector</div><div class="line">    ) : internal_vector(internal_vector) { }</div><div class="line"></div><div class="line">    reference operator[](key_type key)<span class="keyword"> const</span></div><div class="line"><span class="keyword">    </span>{ <span class="keywordflow">return</span> internal_vector[key-&gt;id()]; }</div><div class="line"><span class="keyword">private</span>:</div><div class="line">    std::vector&lt;ValueType&gt;&amp; internal_vector;</div><div class="line">};</div><div class="line"></div><div class="line"></div><div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>* argv[])</div><div class="line">{</div><div class="line">  std::ifstream input((argc&gt;1)?argv[1]:<span class="stringliteral">"data/161.off"</span>);</div><div class="line">  Polyhedron tmesh;</div><div class="line">  input &gt;&gt; tmesh;</div><div class="line">  <span class="keywordflow">if</span> (!<a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/BGL.tag:../BGL/" href="../BGL/group__PkgBGLHelperFct.html#ga11883d231eec1b58f37efe4acedd9588">CGAL::is_triangle_mesh</a>(tmesh))</div><div class="line">  {</div><div class="line">    std::cout &lt;&lt; <span class="stringliteral">"Input geometry is not triangulated."</span> &lt;&lt; std::endl;</div><div class="line">    <span class="keywordflow">return</span> EXIT_FAILURE;</div><div class="line">  }</div><div class="line"></div><div class="line">  <span class="comment">// extract the skeleton</span></div><div class="line">  Skeleton skeleton;</div><div class="line">  <a class="code" href="group__PkgMeanCurvatureSkeleton3.html#gaf4b49adaa500340ce11630f91b320aec">CGAL::extract_mean_curvature_flow_skeleton</a>(tmesh, skeleton);</div><div class="line"></div><div class="line">  <span class="comment">// init the polyhedron simplex indices</span></div><div class="line">  <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/BGL.tag:../BGL/" href="../BGL/group__PkgBGLHelper.html#ga0660924a1aa87e8be5cccbc261e931c7">CGAL::set_halfedgeds_items_id</a>(tmesh);</div><div class="line"></div><div class="line">  <span class="comment">//for each input vertex compute its distance to the skeleton</span></div><div class="line">  std::vector&lt;double&gt; distances(num_vertices(tmesh));</div><div class="line">  BOOST_FOREACH(Skeleton_vertex v, vertices(skeleton) )</div><div class="line">  {</div><div class="line">    <span class="keyword">const</span> Point&amp; skel_pt = skeleton[v].point;</div><div class="line">    BOOST_FOREACH(vertex_descriptor mesh_v, skeleton[v].vertices)</div><div class="line">    {</div><div class="line">      <span class="keyword">const</span> Point&amp; mesh_pt = mesh_v-&gt;point();</div><div class="line">      distances[mesh_v-&gt;id()] = <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Algebraic_foundations.tag:../Algebraic_foundations/" href="../Algebraic_foundations/group__PkgAlgebraicFoundations.html#gab922269072ee9ee99ba8c541418b2e11">std::sqrt</a>(<a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Kernel_23.tag:../Kernel_23/" href="../Kernel_23/group__squared__distance__grp.html#ga1ff73525660a052564d33fbdd61a4f71">CGAL::squared_distance</a>(skel_pt, mesh_pt));</div><div class="line">    }</div><div class="line">  }</div><div class="line"></div><div class="line">  <span class="comment">// create a property-map for sdf values</span></div><div class="line">  std::vector&lt;double&gt; <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Surface_mesh_segmentation.tag:../Surface_mesh_segmentation/" href="../Surface_mesh_segmentation/group__PkgSurfaceSegmentation.html#ga42c20ac00cd54fb258c8d98fb5673925">sdf_values</a>( num_faces(tmesh) );</div><div class="line">  Facet_with_id_pmap&lt;double&gt; sdf_property_map(<a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Surface_mesh_segmentation.tag:../Surface_mesh_segmentation/" href="../Surface_mesh_segmentation/group__PkgSurfaceSegmentation.html#ga42c20ac00cd54fb258c8d98fb5673925">sdf_values</a>);</div><div class="line"></div><div class="line">  <span class="comment">// compute sdf values with skeleton</span></div><div class="line">  BOOST_FOREACH(face_descriptor f, faces(tmesh))</div><div class="line">  {</div><div class="line">    <span class="keywordtype">double</span> dist = 0;</div><div class="line">    BOOST_FOREACH(halfedge_descriptor hd, <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/BGL.tag:../BGL/" href="../BGL/group__PkgBGLIterators.html#ga37229df31508a78eb4acdaf907e637e5">halfedges_around_face</a>(halfedge(f, tmesh), tmesh))</div><div class="line">      dist+=distances[target(hd, tmesh)-&gt;id()];</div><div class="line">    sdf_property_map[f] = dist / 3.;</div><div class="line">  }</div><div class="line"></div><div class="line">  <span class="comment">// post-process the sdf values</span></div><div class="line">  <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Surface_mesh_segmentation.tag:../Surface_mesh_segmentation/" href="../Surface_mesh_segmentation/group__PkgSurfaceSegmentation.html#ga392cbdd609e2ba8cacf7f2af8e86c631">CGAL::sdf_values_postprocessing</a>(tmesh, sdf_property_map);</div><div class="line"></div><div class="line">  <span class="comment">// create a property-map for segment-ids (it is an adaptor for this case)</span></div><div class="line">  std::vector&lt;std::size_t&gt; segment_ids( num_faces(tmesh) );</div><div class="line">  Facet_with_id_pmap&lt;std::size_t&gt; segment_property_map(segment_ids);</div><div class="line"></div><div class="line">  <span class="comment">// segment the mesh using default parameters</span></div><div class="line">  std::cout &lt;&lt; <span class="stringliteral">"Number of segments: "</span></div><div class="line">            &lt;&lt; <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Surface_mesh_segmentation.tag:../Surface_mesh_segmentation/" href="../Surface_mesh_segmentation/group__PkgSurfaceSegmentation.html#ga8a429857a748922d0e8460619db69764">CGAL::segmentation_from_sdf_values</a>(tmesh, sdf_property_map, segment_property_map) &lt;&lt;<span class="stringliteral">"\n"</span>;</div><div class="line"></div><div class="line">  <span class="keywordflow">return</span> EXIT_SUCCESS;</div><div class="line">}</div><div class="line"></div></div><!-- fragment --><h1><a class="anchor" id="MCFSkelSecEvaluation"></a>
Performance</h1>
<p>The elephant model is used to illustrate the performance of the mean curvature flow skeletonization procedure. Different resolutions of the model obtained by loop subdivision are used.</p>
<p>As can be seen on <a class="el" href="index.html#fig__MCFBenchComp">Figure 68.5</a>, the more sampled the surface is, the better the skeleton is inside the model.</p>
<p><a class="anchor" id="fig__MCFBenchComp"></a></p><div class="image">
<img src="comparison.png" alt="comparison.png" />
</div>
   <div class="cgal_figure_caption">  <a class="el" href="index.html#fig__MCFBenchComp">Figure 68.5</a> Skeleton of the head of the elephant model. Left: Using the original mesh (2,775 vertices); Middle: After one loop subdivision step (11,112 vertices); Right: After two loops subdivision steps (44,460 vertices).  </div>  <br />

<p>Runtime in milliseconds of <code><a class="el" href="group__PkgMeanCurvatureSkeleton3.html#gaf4b49adaa500340ce11630f91b320aec" title="extracts a medially centered curve skeleton for the triangle mesh tmesh. This function uses the class...">extract_mean_curvature_flow_skeleton()</a></code> using <code><a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Polyhedron.tag:../Polyhedron/" href="../Polyhedron/classCGAL_1_1Polyhedron__3.html">Polyhedron_3</a>&lt;<a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Kernel_23.tag:../Kernel_23/" href="../Kernel_23/structCGAL_1_1Simple__cartesian.html">Simple_cartesian</a>&lt;double&gt; &gt;</code> as input data structure. The runtimes are similar if <code><a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Surface_mesh.tag:../Surface_mesh/" href="../Surface_mesh/classCGAL_1_1Surface__mesh.html">Surface_mesh</a>&lt;<a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Kernel_23.tag:../Kernel_23/" href="../Kernel_23/structCGAL_1_1Simple__cartesian.html">Simple_cartesian</a>&lt;double&gt;::Point_3&gt;</code> is used instead. The solver used is the default one when <a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Manual.tag:../Manual/" href="../Manual/installation.html#thirdpartyEigen">Eigen</a> is available. The code was compiled using <span style="font-variant: small-caps;">CGAL</span> 4.7 with g++ 4.8.4 with <code>-O3 -DNDEBUG</code> as compiling flags and was run on a Intel(R) Core(TM) i7-2820QM CPU @ 2.30GHz</p>
<center> <table class="doxtable">
<tr>
<th align="right">Number of loop subdivision of <code>elephant.off</code> </th><th align="right">Number of vertices </th><th align="right">Runtime in s  </th></tr>
<tr>
<td align="right">0 </td><td align="right">2,775 </td><td align="right">0.46 </td></tr>
<tr>
<td align="right">1 </td><td align="right">11,112 </td><td align="right">1.26 </td></tr>
<tr>
<td align="right">2 </td><td align="right">44,460 </td><td align="right">5.64 </td></tr>
<tr>
<td align="right">3 </td><td align="right">177,852 </td><td align="right">26.26 </td></tr>
</table>
</center><h1><a class="anchor" id="MCFSkelSecDesign"></a>
Design and Implementation History</h1>
<p>The initial implementation of this package is the result of the work of Xiang Gao during the 2013 season of the Google Summer of Code mentored by Andrea Tagliasacchi and Sébastien Loriot. It was finalized by Andreas Fabri and Sébastien Loriot. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<!-- The footer div is not part of the default but we require it to
move the footer to the bottom of the page. -->
<div id="footer">
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Mon Oct 1 2018 11:58:55 for CGAL 4.13 - Triangulated Surface Mesh Skeletonization by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen" /></a> 1.8.13 </li>
  </ul>
</div>
</div>
</body>


</html>
