<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="canonical" href="https://doc.cgal.org/latest/Periodic_3_mesh_3/index.html"/>

<link rel="icon" type="image/png" href="../Manual/g-196x196-doc.png" />
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8" />
<meta http-equiv="X-UA-Compatible" content="IE=9" />
<meta name="generator" content="Doxygen 1.8.13" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>CGAL 4.13 - 3D Periodic Mesh Generation: User Manual</title>
<!-- <link href="../Manual/tabs.css" rel="stylesheet" type="text/css"/> -->
<script type="text/javascript" src="../Manual/jquery.js"></script>
<script type="text/javascript" src="../Manual/dynsections.js"></script>
<!-- Manually include treeview and search to avoid bloat and to fix
     paths to the directory Manual . -->
<!-- $.treeview -->
<!-- $.search -->
<link href="navtree.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="../Manual/resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="../Manual/search/search.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="../Manual/search/searchdata.js"></script>
<script type="text/javascript" src="../Manual/search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="../Manual/search/search.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="../Manual/search/search.js"></script>
<!-- Manually done below. -->
<link href="../Manual/stylesheet.css" rel="stylesheet" type="text/css" />
<!-- This should probably be an extrastylesheet instead of hardcoded. -->
<link href="../Manual/cgal_stylesheet.css" rel="stylesheet" type="text/css" />
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js"></script>
<script src="../Manual/hacks.js" type="text/javascript"></script>
<script src="modules.js" type="text/javascript"></script>
</head>
<body>
<!-- Custom mathjax -->
<!-- TODO: Remove this with MATHJAX_CODEFILE -->
<span style="display:none">\( \newcommand{\E}{\mathrm{E}} \) \( \newcommand{\A}{\mathrm{A}} \)
\( \newcommand{\R}{\mathrm{R}} \) \( \newcommand{\N}{\mathrm{N}} \) \( \newcommand{\Q}{\mathrm{Q}} \) \( \newcommand{\Z}{\mathrm{Z}} \)
\(
\def\ccSum #1#2#3{
  \sum_{#1}^{#2}{#3}
}
\def\ccProd #1#2#3{
  \sum_{#1}^{#2}{#3}
}\)
</span>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="back-nav">
  <ul>
    <li><a href="https://www.cgal.org/">cgal.org</a></li>
    <li><a href="../Manual/index.html">Top</a></li>
    <li><a href="../Manual/general_intro.html">Getting Started</a></li>
    <li><a href="../Manual/tutorials.html">Tutorials</a></li>
    <li><a href="../Manual/packages.html">Package Overview</a></li>
    <li><a href="../Manual/how_to_cite_cgal.html">Acknowledging CGAL</a></li>
  </ul>
  <!-- In a package SEARCHENGINE = false, so we cannot use 
       insertion. That's why we have to do it manually here. Notice
       that we also take pngs from the Manual. -->
  <div id="MSearchBox" class="MSearchBoxInactive">
    <span class="left">
      <img id="MSearchSelect" src="../Manual/search/mag_sel.png" onmouseover="return searchBox.OnSearchSelectShow()" onmouseout="return searchBox.OnSearchSelectHide()" alt="" />
      <input type="text" id="MSearchField" value="Search" accesskey="S" onfocus="searchBox.OnSearchFieldFocus(true)" onblur="searchBox.OnSearchFieldFocus(false)" onkeyup="searchBox.OnSearchFieldChange(event)" />
    </span><span class="right">
      <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../Manual/search/close.png" alt="" /></a>
    </span>
  </div>
</div>
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">CGAL 4.13 - 3D Periodic Mesh Generation
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- Code below is usually inserted by doxygen when SEARCHENGINE =
     true. Notice that the path to the search directory is adjusted to
     the top-level.-->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../Manual/search",false,'Search');
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow" onmouseover="return searchBox.OnSearchSelectShow()" onmouseout="return searchBox.OnSearchSelectHide()" onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>
<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" name="MSearchResults" id="MSearchResults">
</iframe>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync" style="display: none"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('index.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">User Manual </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="Chapter_3D_Periodic_Mesh_Generation"></a><a class="anchor" id="userchapterperiodic3mesh3"></a></p><dl class="section author"><dt>Authors</dt><dd>Mikhail Bogdanov, Aymeric Pellé, Mael Rouxel-Labbé, and Monique Teillaud  <div id="autotoc" class="toc"></div> </dd></dl>
<p><a class="anchor" id="fig__Periodic_3_mesh_3Banner"></a></p><center> <div class="image">
<img src="periodic_banner.png" style="max-width:60%;" />
</div>
 </center><p>  </p><div class="cgal_figure_caption">  <a class="el" href="index.html#fig__Periodic_3_mesh_3Banner">Figure 56.1</a> A cut view of a periodic mesh.  </div>  <br />

<h1><a class="anchor" id="Periodic_3_mesh_3_section_intro"></a>
Introduction</h1>
<p>This package is devoted to the generation of isotropic simplicial meshes discretizing periodic 3D domains. The domain to be meshed is a subset of the three-dimensional flat torus (see Section <a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Periodic_3_triangulation_3.tag:../Periodic_3_triangulation_3/" href="../Periodic_3_triangulation_3/index.html#P3Triangulation3secspace">The Flat Torus</a> of the package <a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Manual.tag:../Manual/" href="../Manual/packages.html#PkgPeriodic3Triangulation3Summary">3D Periodic Triangulations</a>). The domain may be connected or composed of multiple components and/or subdivided in several subdomains. The current implementation provides classes to represent domains bounded by isosurfaces of implicit functions defined over a cube.</p>
<p>Boundary and subdivision surfaces are either smooth or piecewise-smooth surfaces, formed with planar or curved surface patches. Surfaces may exhibit 1-dimensional features (e.g. crease edges) and 0-dimensional features (e.g. singular points as corners tips, cusps or darts), that have to be fairly approximated in the mesh.</p>
<p>The output mesh is a periodic 3-dimensional triangulation, including subcomplexes that approximate each input domain feature: subdomain, boundary surface patch or input domain feature with dimension 0 or 1. Thus, the output mesh includes a 3D submesh covering each subdomain, a surface mesh approximating each boundary or subdividing surface patch, a polyline approximation for each 1-dimensional feature and of course a vertex on each corner.</p>
<p>The main entry points of the package are two global functions that respectively generate and refine such meshes. The mesh generator is customized to output a mesh that fits as much as possible the user needs, for instance in terms of sizing field or with respect to some user customized quality criteria.</p>
<p>The meshing engine used in this mesh generator is based on Delaunay refinement <a class="el" href="citelist.html#CITEREF_c-gqmgc-93">[4]</a>, <a class="el" href="citelist.html#CITEREF_r-draq2d-95">[7]</a>, <a class="el" href="citelist.html#CITEREF_s-tmgdr-98">[8]</a>. It uses the notion of restricted Delaunay triangulation to approximate 1-dimensional curves and surface patches <a class="el" href="citelist.html#CITEREF_cgal:bo-pgsms-05">[1]</a>. Before the refinement, a mechanism of protecting balls is set up on 1-dimensional features, if any, to ensure a fair representation of those features in the mesh, and also to guarantee the termination of the refinement process, whatever may be the input geometry, in particular whatever small angles the boundary and subdivision surface patches may form <a class="el" href="citelist.html#CITEREF_cgal:cdl-pdma-07">[2]</a>, <a class="el" href="citelist.html#CITEREF_cgal:cdr-drpsc-07">[3]</a>. The Delaunay refinement is followed by a mesh optimization phase to remove slivers and provide a good quality mesh.</p>
<h2><a class="anchor" id="Periodic_3_mesh_3Mesh_3"></a>
Relation to the 3D Mesh Generation and 3D Periodic Triangulations Packages</h2>
<p>This package is fundamentally linked to the package <a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Manual.tag:../Manual/" href="../Manual/packages.html#PkgMesh_3Summary">3D Mesh Generation</a>, which is devoted to the generation of isotropic simplicial meshes discretizing (non-periodic) 3D domains and to the <a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Manual.tag:../Manual/" href="../Manual/packages.html#PkgPeriodic3Triangulation3Summary">3D Periodic Triangulations</a> of CGAL, which are used as underlying triangulation structures of the mesh.</p>
<p>A periodic mesh extends, by definition, infinitely in space. We consider the flat torus \( \mathbb T_c^3\), whose <em>canonical cube</em> has side length <code>c</code> (this canonical cube is named <em>original domain</em> in Chapter <a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Manual.tag:../Manual/" href="../Manual/packages.html#PkgPeriodic3Triangulation3Summary">3D Periodic Triangulations</a>; we rename it here to avoid the confusion with the domain defined in Chapter <a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Manual.tag:../Manual/" href="../Manual/packages.html#PkgMesh_3Summary">3D Mesh Generation</a>). Well-chosen "dummy" points are inserted at the beginning of the meshing process, ensuring that the projection of the periodic triangulation into the flat torus \( \mathbb T_c^3\) forms at all times a simplicial complex (see Sections <a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Periodic_3_triangulation_3.tag:../Periodic_3_triangulation_3/" href="../Periodic_3_triangulation_3/index.html#P3Triangulation3secspace">The Flat Torus</a> and <a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Periodic_3_triangulation_3.tag:../Periodic_3_triangulation_3/" href="../Periodic_3_triangulation_3/index.html#P3Triangulation3secintro">Representation</a> of the manual of 3D periodic triangulations). Thanks to this construction, the meshing process can be exclusively conducted within the canonical cube. The mesh can then be created using the <a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Manual.tag:../Manual/" href="../Manual/packages.html#PkgMesh_3Summary">3D Mesh Generation</a> package of CGAL. As this package originally aims to mesh non-periodic domains of \( \mathbb R^3\), an interface is necessary between the packages <a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Manual.tag:../Manual/" href="../Manual/packages.html#PkgMesh_3Summary">3D Mesh Generation</a> and <a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Manual.tag:../Manual/" href="../Manual/packages.html#PkgPeriodic3Triangulation3Summary">3D Periodic Triangulations</a>. This package provides this interface.</p>
<h2><a class="anchor" id="Periodic_3_mesh_3InputDomain"></a>
Input Domain</h2>
<p>The domain to be meshed is assumed to be representable as a pure 3D complex. A 3D complex is a set of faces with dimension 0, 1, 2, and 3 such that all faces are pairwise interior disjoint, and the boundary of each face of the complex is the union of lower-dimensional faces of the complex. The 3D complex is <em>pure</em>, meaning that each face is included in a face of dimension 3, so that the complex is entirely described by the set of its 3D faces and their subfaces. However the 3D complex needs not be connected. The set of faces with dimension lower or equal than 2 forms a 2D subcomplex which needs not be manifold, neither pure, nor connected: some 3D faces may have dangling 2D or 1D faces in their boundary faces.</p>
<p>In the rest of the documentation, we will refer to the input 3D complex as the input domain. The faces of the input domain with dimension 0, 1, 2, and 3 are called respectively <em>corners</em>, <em>curves</em>, <em>surface patches</em>, and <em>subdomains</em> to clearly distinguish them from the faces of the mesh that are called vertices, edges, facets and cells.</p>
<p>Note that the input complex faces are not required to be linear nor smooth. Surface patches, for instance, may be smooth surface patches, or portions of surface meshes with boundaries. Curves may be for instance straight segments, parameterized curves, or polylines. Each of those features will be accurately represented in the final mesh.</p>
<p>The 0 and 1-dimensional features of the input domain are usually singular points of the subdomain boundaries, however this is not required. Furthermore, those features are not required to cover all the subdomains boundaries singularities but only those that need to be accurately represented in the final mesh. In the following, we say that a domain has <em>features</em> when it has 0 and 1-dimensional features that need to be accurately represented in the mesh, and we call those features <em>exposed features</em>. Therefore, a domain may be without features either because all boundary surface patches are smooth closed surfaces, or simply because the curves joining different surface patches and the singularities of those patches need not be accurately approximated in the final mesh.</p>
<p>Note also that input complex faces are not required to be connected. Faces of the input domain are identified by indices. If a subdomain is not connected, its different components receive the same index. Likewise different surface patches, segment curves, or corners may share the same index. Each connected component of a feature will be accurately represented in the final mesh. Note however that the occurrence of multiply connected faces in the input complex may affect the relevance of internal topological checks performed by the mesh generator.</p>
<p>The domain is passed to the mesh generation function as a domain class, often called the oracle, that provides predicates and constructors related to the domain, the subdomains, and the boundary surface patches. Mainly, the oracle provides a predicate to test if a given query point belongs to the domain or not and to find in which subdomain it lies in the affirmative case. The domain class also provides predicates and constructors to test the intersection of a query line segment with the boundary surface patches and to construct intersection points, if any.</p>
<h3><a class="anchor" id="Periodic_3_mesh_3ImplicitInputDomain"></a>
Implicit Domains</h3>
<p>An implicit domain is a domain described by an implicit function. The bounding surface is described implicitly as the zero level set of a function defined over the three dimensional flat torus. The domain to be discretized is assumed to be the domain where the function has negative values.</p>
<h3><a class="anchor" id="Periodic_3_mesh_3InputDomainPeriodicity"></a>
Periodicity of the Input Domain</h3>
<p>As described in Section <a class="el" href="index.html#Periodic_3_mesh_3Mesh_3">Relation to the 3D Mesh Generation and 3D Periodic Triangulations Packages</a>, the periodic mesh is in fact constructed over a single cube of side <code>c</code> in \( \mathbb R^3\), the <em>canonical cube</em> of the flat torus \( \mathbb T_c^3\). The origin (given by three coordinates \( \alpha\), \( \beta\), and \( \gamma\)) of this cube and the period <code>c</code> are input parameters chosen by the user. The cube \( [\alpha,\alpha+c)\times[\beta,\beta+c)\times[\gamma,\gamma+c)\) contains exactly one representative of each element in \( \mathbb T_c^3\). Although the mesh is only constructed over the canonical cube, some of the oracles used during the generation of the mesh must sometimes be evaluated outside of the canonical cube. The implicit function describing the domain to be meshed must thus be defined over the whole Euclidean space and be periodic, with a period compatible with the canonical cube.</p>
<h3><a class="anchor" id="Periodic_3_mesh_3ArtificialPeriodicity"></a>
Enforcing Domain Periodicity</h3>
<p>The specifications of the input implicit function described in the previous section are quite restrictive. To relax these requirements, this package also offers a wrapper class, <code><a class="el" href="classCGAL_1_1Periodic__3__function__wrapper.html" title="The class Periodic_3_function_wrapper is a helper class designed to wrap an (a priori non-periodic) i...">CGAL::Periodic_3_function_wrapper</a></code>, to artificially construct periodic functions compatible with the user-defined canonical cube, from the values of an implicit function over the canonical cube. It is thus possible to construct periodic domains described by implicit functions that are not intrinsically periodic, for example a sphere (see <a class="el" href="index.html#fig__Periodic_3_mesh_3Periodic_implicit_sphere">Figure 56.4</a>) or a cone (see Section <a class="el" href="index.html#Periodic_3_mesh_3ConeWithSharpFeatures">Example of a Cone-like Periodic Domain</a>).</p>
<h2><a class="anchor" id="Periodic_3_mesh_3OutputMesh"></a>
Output Mesh</h2>
<p>The resulting mesh is output as a subcomplex of a <a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Periodic_3_triangulation_3.tag:../Periodic_3_triangulation_3/" href="../Periodic_3_triangulation_3/classCGAL_1_1Periodic__3__regular__triangulation__3.html">weighted Delaunay periodic 3D triangulation</a>, in a class that provides various iterators on mesh elements.</p>
<p>This periodic 3D triangulation provides approximations of the subdomains, surface patches, curves, and corners according to the restricted Delaunay triangulation paradigm. This means that each subdomain is approximated by the union of the tetrahedral cells whose circumcenters are located inside the domain (or subdomain). Each surface patch is approximated by the union of the Delaunay mesh facets whose dual Voronoi edges intersect the surface patch. Such mesh facets are called <em>surface facets</em> in the following. The 1-dimensional exposed features are approximated by sequences of mesh edges and the 0-dimensional exposed features are represented by mesh vertices.</p>
<p>It is possible to extract the facets of the complex (restricted to the canonical cube) as a <code><a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/BGL.tag:../BGL/" href="../BGL/classFaceGraph.html">FaceGraph</a></code>, using the function <code><a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Mesh_3.tag:../Mesh_3/" href="../Mesh_3/group__PkgMesh__3Functions.html#ga68ca38989087644fb6b893eb566be9ea">facets_in_complex_3_to_triangle_mesh()</a></code>.</p>
<h2><a class="anchor" id="Periodic_3_mesh_3DelaunayRefinement"></a>
Delaunay Refinement</h2>
<p>The mesh generation algorithm is mainly a Delaunay refinement process. This Delaunay refinement process is driven by criteria concerning either the size and shape of mesh cells and surface facets. The refinement process terminates when there are no more mesh cells or surface facets violating the criteria.</p>
<p>The criteria are designed to achieve a nice spread of the mesh vertices while ensuring the termination of the refinement process. Those criteria may be somehow tuned to the user needs to achieve for instance the respect of a sizing field by mesh elements, some topological conditions on the representation of boundary surfaces in the mesh, and/or some error bound for the approximation of boundary surfaces. To some extent, the user may tune the Delaunay refinement to a prescribed trade-off between mesh quality and mesh density. The mesh density refers to the number of mesh vertices and cells, i.e. to the complexity of the mesh. The mesh quality referred to here is measured by the radius edge ratio of surface facets end mesh cells, where the radius edge ratio of a simplex (triangle or tetrahedron) is the ratio between its circumradius and its shortest edge length.</p>
<h2><a class="anchor" id="Periodic_3_mesh_3Protectionof0and1dimensionalExposed"></a>
Protection of 0 and 1-dimensional Exposed Features</h2>
<p>If the domain description includes 0 dimensional features, the corresponding points are inserted into the Delaunay triangulation from the start.</p>
<p>If the domain has 1-dimensional exposed features, the method of protecting balls <a class="el" href="citelist.html#CITEREF_cgal:cdl-pdma-07">[2]</a>, <a class="el" href="citelist.html#CITEREF_cgal:cdr-drpsc-07">[3]</a> is used to achieve an accurate representation of those features in the mesh and to guarantee that the refinement process terminates whatever may be the dihedral angles formed by input surface patches incident to a given 1-feature or the angles formed by two 1-features incident to a 0-feature. See Section <a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Mesh_3.tag:../Mesh_3/" href="../Mesh_3/index.html#Mesh_3Protectionof0and1dimensionalExposed">Protection of 0 and 1-dimensional Exposed Features</a> in the documentation of the package <a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Manual.tag:../Manual/" href="../Manual/packages.html#PkgMesh_3Summary">3D Mesh Generation</a> for further information.</p>
<p>Section <a class="el" href="index.html#Periodic_3_mesh_3MeshingDomainswithSharpFeatures">Meshing Domains with Sharp Features</a> details how to prescribe sharp features and examples of periodic meshes with features.</p>
<h2><a class="anchor" id="Periodic_3_mesh_3OptimizationPhase"></a>
Optimization Phase</h2>
<p>The optimization phase is a succession of optimization processes which aim to improve the quality of the mesh in terms of shape of its elements. All the optimizers offered by the package <a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Manual.tag:../Manual/" href="../Manual/packages.html#PkgMesh_3Summary">3D Mesh Generation</a> are also available for periodic mesh generation:</p>
<ul>
<li>The Lloyd and ODT-smoother are global optimizers, moving the mesh vertices to minimize a mesh energy.</li>
<li>The perturber and the exuder are local optimizers, focusing on improving the worst mesh elements.</li>
</ul>
<p>See Sections <a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Mesh_3.tag:../Mesh_3/" href="../Mesh_3/index.html#Mesh_3OptimizationPhase">Optimization Phase</a>, <a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Mesh_3.tag:../Mesh_3/" href="../Mesh_3/index.html#Mesh_3TheOptimizationParameters">The Optimization Parameters</a>, and <a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Mesh_3.tag:../Mesh_3/" href="../Mesh_3/index.html#Mesh_3TuningMeshOptimization">Tuning Mesh Optimization</a> in the documentation of the package <a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Manual.tag:../Manual/" href="../Manual/packages.html#PkgMesh_3Summary">3D Mesh Generation</a> for further information.</p>
<h1><a class="anchor" id="Periodic_3_mesh_3_section_interface"></a>
Interface</h1>
<h2><a class="anchor" id="Periodic_3_mesh_3TheGlobalFunctions"></a>
The Global Functions</h2>
<p>A periodic 3D mesh generation process is launched through a call to one of the two following functions:</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> C3T3, <span class="keyword">class</span> PeriodicMeshDomain, <span class="keyword">class</span> MeshCriteria&gt;</div><div class="line">C3T3 <a class="code" href="group__PkgPeriodic__3__mesh__3Functions.html#ga0b7d3bf3e957fbf8ed46f9ed139502b5">make_periodic_3_mesh_3</a>(<span class="keyword">const</span> PeriodicMeshDomain&amp; domain,</div><div class="line">                            <span class="keyword">const</span> MeshCriteria&amp; criteria,</div><div class="line">                            parameters::internal::Features_options <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Mesh_3.tag:../Mesh_3/" href="../Mesh_3/group__PkgMesh__3Parameters.html#ga0a990b28d55157c62d4bfd2624d408af">features</a> = <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Mesh_3.tag:../Mesh_3/" href="../Mesh_3/group__PkgMesh__3Parameters.html#ga0a990b28d55157c62d4bfd2624d408af">parameters::features</a>(domain),</div><div class="line">                            parameters::internal::Lloyd_options <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Mesh_3.tag:../Mesh_3/" href="../Mesh_3/group__PkgMesh__3Parameters.html#gaa7254c80bba62400f43f1e49506b975a">lloyd</a> = <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Mesh_3.tag:../Mesh_3/" href="../Mesh_3/group__PkgMesh__3Parameters.html#ga6abfd3773eeb47d88ce6cffb91f14d2f">parameters::no_lloyd</a>(),</div><div class="line">                            parameters::internal::Odt_options <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Mesh_3.tag:../Mesh_3/" href="../Mesh_3/group__PkgMesh__3Parameters.html#gafbecfd22651a08e6812d8a5ad9b49852">odt</a> = <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Mesh_3.tag:../Mesh_3/" href="../Mesh_3/group__PkgMesh__3Parameters.html#ga1d041e8dbde3860cde3c20107225ecb1">parameters::no_odt</a>(),</div><div class="line">                            parameters::internal::Perturb_options <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Mesh_3.tag:../Mesh_3/" href="../Mesh_3/group__PkgMesh__3Parameters.html#gaedf18f7f3c4647ec5fce5d67e435757a">perturb</a> = <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Mesh_3.tag:../Mesh_3/" href="../Mesh_3/group__PkgMesh__3Parameters.html#gaedf18f7f3c4647ec5fce5d67e435757a">parameters::perturb</a>(),</div><div class="line">                            parameters::internal::Exude_options <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Mesh_3.tag:../Mesh_3/" href="../Mesh_3/group__PkgMesh__3Parameters.html#ga16694b09a2acc8ab3f26b7d57633ccb0">exude</a> = <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Mesh_3.tag:../Mesh_3/" href="../Mesh_3/group__PkgMesh__3Parameters.html#ga16694b09a2acc8ab3f26b7d57633ccb0">parameters::exude</a>());</div><div class="line"></div><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> C3T3, <span class="keyword">class</span> MeshDomain, <span class="keyword">class</span> MeshCriteria&gt;</div><div class="line"><span class="keywordtype">void</span> <a class="code" href="group__PkgPeriodic__3__mesh__3Functions.html#ga5856ae11a447d996a8b0cfe38c0d7618">refine_periodic_3_mesh_3</a>(C3T3&amp; c3t3,</div><div class="line">                              <span class="keyword">const</span> PeriodicMeshDomain&amp; domain,</div><div class="line">                              <span class="keyword">const</span> MeshCriteria&amp; criteria,</div><div class="line">                              parameters::internal::Lloyd_options <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Mesh_3.tag:../Mesh_3/" href="../Mesh_3/group__PkgMesh__3Parameters.html#gaa7254c80bba62400f43f1e49506b975a">lloyd</a> = <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Mesh_3.tag:../Mesh_3/" href="../Mesh_3/group__PkgMesh__3Parameters.html#ga6abfd3773eeb47d88ce6cffb91f14d2f">parameters::no_lloyd</a>(),</div><div class="line">                              parameters::internal::Odt_options <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Mesh_3.tag:../Mesh_3/" href="../Mesh_3/group__PkgMesh__3Parameters.html#gafbecfd22651a08e6812d8a5ad9b49852">odt</a> = <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Mesh_3.tag:../Mesh_3/" href="../Mesh_3/group__PkgMesh__3Parameters.html#ga1d041e8dbde3860cde3c20107225ecb1">parameters::no_odt</a>(),</div><div class="line">                              parameters::internal::Perturb_options <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Mesh_3.tag:../Mesh_3/" href="../Mesh_3/group__PkgMesh__3Parameters.html#gaedf18f7f3c4647ec5fce5d67e435757a">perturb</a> = <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Mesh_3.tag:../Mesh_3/" href="../Mesh_3/group__PkgMesh__3Parameters.html#gaedf18f7f3c4647ec5fce5d67e435757a">parameters::perturb</a>(),</div><div class="line">                              parameters::internal::Exude_options <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Mesh_3.tag:../Mesh_3/" href="../Mesh_3/group__PkgMesh__3Parameters.html#ga16694b09a2acc8ab3f26b7d57633ccb0">exude</a> = <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Mesh_3.tag:../Mesh_3/" href="../Mesh_3/group__PkgMesh__3Parameters.html#ga16694b09a2acc8ab3f26b7d57633ccb0">parameters::exude</a>());</div></div><!-- fragment --><p>The function <code><a class="el" href="group__PkgPeriodic__3__mesh__3Functions.html#ga0b7d3bf3e957fbf8ed46f9ed139502b5" title="The function make_periodic_3_mesh_3() is a 3D periodic mesh generator. ">make_periodic_3_mesh_3()</a></code> generates from scratch a periodic mesh of the input domain, while the function <code><a class="el" href="group__PkgPeriodic__3__mesh__3Functions.html#ga5856ae11a447d996a8b0cfe38c0d7618" title="The function refine_periodic_3_mesh_3() is a 3D periodic mesh generator. ">refine_periodic_3_mesh_3()</a></code> refines an existing periodic mesh of the input domain.</p>
<dl class="section warning"><dt>Warning</dt><dd>The triangulation must form at all times a simplicial complex within a single copy of the domain (see Sections <a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Periodic_3_triangulation_3.tag:../Periodic_3_triangulation_3/" href="../Periodic_3_triangulation_3/index.html#P3Triangulation3secspace">The Flat Torus</a> and <a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Periodic_3_triangulation_3.tag:../Periodic_3_triangulation_3/" href="../Periodic_3_triangulation_3/index.html#P3Triangulation3secintro">Representation</a> of the manual of 3D periodic triangulations). It is the responsibility of the user to provide a triangulation that satisfies this condition when calling the refinement function <code><a class="el" href="group__PkgPeriodic__3__mesh__3Functions.html#ga5856ae11a447d996a8b0cfe38c0d7618" title="The function refine_periodic_3_mesh_3() is a 3D periodic mesh generator. ">refine_periodic_3_mesh_3()</a></code>. The underlying triangulation of a mesh complex obtained through <code><a class="el" href="group__PkgPeriodic__3__mesh__3Functions.html#ga0b7d3bf3e957fbf8ed46f9ed139502b5" title="The function make_periodic_3_mesh_3() is a 3D periodic mesh generator. ">make_periodic_3_mesh_3()</a></code> or <code><a class="el" href="group__PkgPeriodic__3__mesh__3Functions.html#ga5856ae11a447d996a8b0cfe38c0d7618" title="The function refine_periodic_3_mesh_3() is a 3D periodic mesh generator. ">refine_periodic_3_mesh_3()</a></code> will always satisfy this condition.</dd></dl>
<p>The following sections describe the different template parameters (and their requirements) of these two global functions.</p>
<h2><a class="anchor" id="Periodic_3_mesh_3TheDataStructure"></a>
The Data Structure</h2>
<p>The template parameter <code>C3T3</code> is required to be a model of the concept <code><a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Mesh_3.tag:../Mesh_3/" href="../Mesh_3/classMeshComplex__3InTriangulation__3.html">MeshComplex_3InTriangulation_3</a></code>. This data structure is devised to represent a three-dimensional complex embedded in a periodic 3D triangulation. In both functions, an instance of type <code>C3T3</code> is used to maintain the current approximating simplicial mesh and to represent a single copy of the final periodic 3D mesh at the end of the procedure.</p>
<p>The embedding periodic 3D triangulation is required to be the nested type <code><a class="el" href="classCGAL_1_1Periodic__3__mesh__triangulation__3.html#aa66500d18c7aefce335a3b6c02df7654" title="The triangulation type to be used for the 3D triangulation embedding the mesh. ">CGAL::Periodic_3_mesh_triangulation_3::type</a></code>, provided by the class template <code><a class="el" href="classCGAL_1_1Periodic__3__mesh__triangulation__3.html" title="The class Periodic_3_mesh_triangulation_3 is a class template which provides the triangulation type t...">CGAL::Periodic_3_mesh_triangulation_3</a></code>. The type for this triangulation is a wrapper around the class <code><a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Periodic_3_triangulation_3.tag:../Periodic_3_triangulation_3/" href="../Periodic_3_triangulation_3/classCGAL_1_1Periodic__3__regular__triangulation__3.html">CGAL::Periodic_3_regular_triangulation_3</a></code> whose vertex and cell base classes are respectively models of the concepts <code><a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Mesh_3.tag:../Mesh_3/" href="../Mesh_3/classMeshVertexBase__3.html">MeshVertexBase_3</a></code> and <code><a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Mesh_3.tag:../Mesh_3/" href="../Mesh_3/classMeshCellBase__3.html">MeshCellBase_3</a></code>.</p>
<h2><a class="anchor" id="Periodic_3_mesh_3TheDomainOracleandtheFeaturesParameter"></a>
The Domain Oracle and the Features Parameter</h2>
<p>The template parameter <code>PeriodicMeshDomain</code> is required to be a model of the concept <code><a class="el" href="classPeriodic__3MeshDomain__3.html">Periodic_3MeshDomain_3</a></code>. The argument <code>domain</code> of type <code>PeriodicMeshDomain</code> is the sole link through which the periodic domain to be discretized is known by the mesh generation algorithm.</p>
<p>This concept provides, among others, member functions to test whether or not a query segment intersects boundary surfaces, and to compute an intersection point in the affirmative. The <code><a class="el" href="classPeriodic__3MeshDomain__3.html">Periodic_3MeshDomain_3</a></code> concept adds member functions which given a query point tell whether the point lies inside or outside the domain and in which subdomain the point lies, if inside.</p>
<p>If the domain description includes 0 and 1-dimensional features that have to be accurately represented in the final mesh, the template parameter <code>PeriodicMeshDomain</code> is required to be of a model of the concept <code><a class="el" href="classPeriodic__3MeshDomainWithFeatures__3.html">Periodic_3MeshDomainWithFeatures_3</a></code>, which mainly provides the incidence graph of 0, 1 and 2-dimensional features, and a member function to construct sample points on curves.</p>
<p>Users whose domain is a model of <code><a class="el" href="classPeriodic__3MeshDomainWithFeatures__3.html">Periodic_3MeshDomainWithFeatures_3</a></code> can choose to have the corners and curves of the domain represented in the mesh or not, using the following parameters: </p><ul>
<li>
<code><a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Mesh_3.tag:../Mesh_3/" href="../Mesh_3/group__PkgMesh__3Parameters.html#ga0a990b28d55157c62d4bfd2624d408af">parameters::features()</a></code> sets features according to the domain, i.e. 0 and 1-dimensional features are taken into account if <code>domain</code> is a <code><a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Mesh_3.tag:../Mesh_3/" href="../Mesh_3/classMeshDomainWithFeatures__3.html">MeshDomainWithFeatures_3</a></code>. </li>
<li>
<code><a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Mesh_3.tag:../Mesh_3/" href="../Mesh_3/group__PkgMesh__3Parameters.html#gaa3eb2cb65200b0331ef9d5f14b4a0535">parameters::no_features()</a></code> prevents the representation of 0 and 1-dimensional features in the mesh. This is useful to get a smooth and rough approximation of a domain with features. </li>
</ul>
<h2><a class="anchor" id="Periodic_3_mesh_3TheMeshingCriteria"></a>
The Meshing Criteria</h2>
<p>The template parameter <code>MeshCriteria</code> must be a model of the concept <code><a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Mesh_3.tag:../Mesh_3/" href="../Mesh_3/classMeshCriteria__3.html">MeshCriteria_3</a></code>, or a model of the refined concept <code><a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Mesh_3.tag:../Mesh_3/" href="../Mesh_3/classMeshCriteriaWithFeatures__3.html">MeshCriteriaWithFeatures_3</a></code> if the domain has exposed features. The argument of type <code>MeshCriteria</code> passed to the mesh generator specifies the size and shape requirements for the tetrahedra in the mesh and for the triangles in the boundary surface mesh. These criteria condition the rules that drive the refinement process. At the end of the refinement process, mesh elements satisfy the criteria. This may not be strictly true anymore after the optimization phase, but this last phase is devised to only improve the mesh quality.</p>
<p>The periodic mesher makes use of the same criteria as the non-periodic meshing functions. This is made possible because criteria use methods directly from the underlying triangulation, to know the smallest edge length of a triangle, for example. The periodicity is therefore taken into account at this level and no modification of the criteria classes are required.</p>
<p>The criteria for surface facets are governed by the four following parameters: </p><ul>
<li>
<em><code>facet_angle</code>.</em> This parameter controls the shape of surface facets. Specifically, it is a lower bound for the angle (in degree) of surface facets. When boundary surfaces are smooth, the termination of the meshing process is guaranteed if this angular bound is at most 30 degrees <a class="el" href="citelist.html#CITEREF_c-gqmgc-93">[4]</a>. </li>
<li>
<em><code>facet_size</code>.</em> This parameter controls the size of surface facets. Each surface facet has a surface Delaunay ball which is a ball circumscribing the surface facet and centered on the surface patch. The parameter <code>facet_size</code> is either a constant or a spatially variable scalar field, providing an upper bound for the radii of surface Delaunay balls. </li>
<li>
<em><code>facet_distance</code>.</em> This parameter controls the approximation error of boundary and subdivision surfaces. Specifically, it is either a constant or a spatially variable scalar field. It provides an upper bound for the distance between the circumcenter of a surface facet and the center of a surface Delaunay ball of this facet. </li>
<li>
<em><code>facet_topology</code>.</em> This parameters controls the set of topological constraints which have to be verified by each surface facet. By default, each vertex of a surface facet has to be located on a surface patch, on a curve, or on a corner. It can also be set to check whether the three vertices of a surface facet belongs to the same surface patch. This has to be done cautiously, as such a criterion needs that each intersection of input surface patches is an input 1-dimensional feature. </li>
</ul>
<p>The criteria for mesh cells are governed by two parameters: </p><ul>
<li>
<em><code>cell_radius_edge_ratio</code>.</em> This parameter controls the shape of mesh cells (but can't filter slivers, as we discussed earlier). It is an upper bound for the ratio between the circumradius of a mesh tetrahedron and its shortest edge. There is a theoretical bound for this parameter: the Delaunay refinement process is guaranteed to terminate for values of <code>cell_radius_edge_ratio</code> bigger than 2. </li>
<li>
<em><code>cell_size</code>.</em> This parameter controls the size of mesh tetrahedra. It is either a scalar or a spatially variable scalar field. It provides an upper bound on the circumradii of the mesh tetrahedra. </li>
</ul>
<p>If the domain has 1-dimensional exposed features, the <code>criteria</code> includes a sizing field to guide the sampling of 1-dimensional features with protecting balls centers. </p><ul>
<li>
<em><code>edge_size</code></em>. This constant or variable scalar field is used as an upper bound for the distance between two protecting ball centers that are consecutive on a 1-feature. This parameter has to be set to a positive value when 1-dimensional features protection is used. </li>
</ul>
<h1><a class="anchor" id="Periodic_3_mesh_3_section_examples"></a>
Examples</h1>
<p>This section presents various use cases of the periodic mesh generator.</p>
<h2><a class="anchor" id="Periodic_3_mesh_3SubMultipleCopies"></a>
Visualizing Multiple Copies of a Periodic Mesh</h2>
<p>Generated meshes can be output to the <code>.mesh</code> file format, which can be visualized with the demo of the package <a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Manual.tag:../Manual/" href="../Manual/packages.html#PkgPolyhedronSummary">3D Polyhedral Surface</a>. The function <a class="el" href="group__PkgPeriodic__3__mesh__3IOFunctions.html"><code>CGAL::output_periodic_mesh_to_medit()</code> </a> takes a stream, a mesh complex, and - optionally - the number of periodic copies that should be drawn, making it easier to observe the periodicity of the result. <a class="el" href="index.html#fig__Periodic_3_mesh_3Periodic_copies">Figure 56.2</a> illustrates the different output for the three possible number of copies: <code>1</code>, <code>4</code>, and <code>8</code>.</p>
<p><a class="anchor" id="fig__Periodic_3_mesh_3Periodic_copies"></a></p><center> <div class="image">
<img src="periodic_copies.jpg" style="max-width:90%;" />
</div>
 </center><p>  </p><div class="cgal_figure_caption">  <a class="el" href="index.html#fig__Periodic_3_mesh_3Periodic_copies">Figure 56.2</a> Example of a periodic mesh output in <code>1</code>, <code>4</code>, or <code>8</code> copies.  </div>  <br />

<p>In the following examples (except on <a class="el" href="index.html#fig__Periodic_3_mesh_3Periodic_multi_domain">Figure 56.6</a>), each copy of a periodic mesh will be attributed a unique color.</p>
<dl class="section warning"><dt>Warning</dt><dd>A single copy of the periodic mesh does not necessarily form a visually-pleasing mesh: there can be unexpected holes, disconnected elements, non-manifold locations, etc. This is because each copy is only made of unique elements and the periodic mesh only has meaning when considered with other neighboring periodic copies: a strange hole on the "left" of a copy is filled by a tetrahedron on its "right". <a class="el" href="index.html#fig__Periodic_3_mesh_3Periodic_protection">Figure 56.8</a> is an example of such phenomenon: These (purely visual) issues disappear when considering multiple copies together.</dd></dl>
<h2><a class="anchor" id="Periodic_3_mesh_33DDomainsImplicitIsosurfaces"></a>
3D Periodic Domains Bounded by Implicit Isosurfaces</h2>
<p>The following code produces a 3D periodic mesh for a domain whose boundary surface is an isosurface defined by an implicit function. Note the use of named parameters (from the Boost library) in the constructor of the <code>Mesh_criteria</code> instance. <a class="el" href="index.html#fig__Periodic_3_mesh_3Periodic_implicit_shape">Figure 56.3</a> shows the resulting mesh.</p>
<p><br />
<b>File</b> <a class="el" href="Periodic_3_mesh_3_2mesh_implicit_shape_8cpp-example.html">Periodic_3_mesh_3/mesh_implicit_shape.cpp</a> </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;CGAL/Periodic_3_mesh_3/config.h&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Exact_predicates_inexact_constructions_kernel.h&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;CGAL/make_periodic_3_mesh_3.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/optimize_periodic_3_mesh_3.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Periodic_3_mesh_3/IO/File_medit.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Periodic_3_mesh_triangulation_3.h&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Labeled_mesh_domain_3.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Mesh_complex_3_in_triangulation_3.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Mesh_criteria_3.h&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;CGAL/number_type_config.h&gt;</span> <span class="comment">// CGAL_PI</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;cmath&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;fstream&gt;</span></div><div class="line"></div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Kernel_23.tag:../Kernel_23/" href="../Kernel_23/classCGAL_1_1Exact__predicates__inexact__constructions__kernel.html">CGAL::Exact_predicates_inexact_constructions_kernel</a> K;</div><div class="line"><span class="keyword">typedef</span> K::FT                                               FT;</div><div class="line"><span class="keyword">typedef</span> K::Point_3                                          Point;</div><div class="line"><span class="keyword">typedef</span> K::Iso_cuboid_3                                     Iso_cuboid;</div><div class="line"></div><div class="line"><span class="comment">// Domain</span></div><div class="line"><span class="keyword">typedef</span> FT (Function)(<span class="keyword">const</span> Point&amp;);</div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Mesh_3.tag:../Mesh_3/" href="../Mesh_3/classCGAL_1_1Labeled__mesh__domain__3.html">CGAL::Labeled_mesh_domain_3&lt;K&gt;</a>                      Periodic_mesh_domain;</div><div class="line"></div><div class="line"><span class="comment">// Triangulation</span></div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Manual.tag:../Manual/" href="../Manual/classunspecified__type.html">CGAL::Periodic_3_mesh_triangulation_3&lt;Periodic_mesh_domain&gt;::type</a> Tr;</div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Mesh_3.tag:../Mesh_3/" href="../Mesh_3/classCGAL_1_1Mesh__complex__3__in__triangulation__3.html">CGAL::Mesh_complex_3_in_triangulation_3&lt;Tr&gt;</a>                       C3t3;</div><div class="line"></div><div class="line"><span class="comment">// Criteria</span></div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Mesh_3.tag:../Mesh_3/" href="../Mesh_3/classCGAL_1_1Mesh__criteria__3.html">CGAL::Mesh_criteria_3&lt;Tr&gt;</a>                           Periodic_mesh_criteria;</div><div class="line"></div><div class="line"><span class="comment">// To avoid verbose function and named parameters call</span></div><div class="line"><span class="keyword">using namespace </span><a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Mesh_3.tag:../Mesh_3/" href="../Mesh_3/namespaceCGAL_1_1parameters.html">CGAL::parameters</a>;</div><div class="line"></div><div class="line"><span class="comment">// Implicit function</span></div><div class="line">FT schwarz_p(<span class="keyword">const</span> Point&amp; p)</div><div class="line">{</div><div class="line">  <span class="keyword">const</span> FT x2 = std::cos( p.x() * 2 * CGAL_PI ),</div><div class="line">           y2 = std::cos( p.y() * 2 * CGAL_PI ),</div><div class="line">           z2 = std::cos( p.z() * 2 * CGAL_PI );</div><div class="line">  <span class="keywordflow">return</span> x2 + y2 + z2;</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>** argv)</div><div class="line">{</div><div class="line">  <span class="comment">// 'int' because the 'schwarz_p' function is periodic over the domain only if</span></div><div class="line">  <span class="comment">// the length of the side of the domain is an integer.</span></div><div class="line">  <span class="keywordtype">int</span> domain_size = (argc &gt; 1) ? atoi(argv[1]) : 1;</div><div class="line">  <span class="keywordtype">int</span> number_of_copies_in_output = (argc &gt; 2) ? atoi(argv[2]) : 4; <span class="comment">// can be 1, 2, 4, or 8</span></div><div class="line"></div><div class="line">  Iso_cuboid canonical_cube(0, 0, 0, domain_size, domain_size, domain_size);</div><div class="line"></div><div class="line">  Periodic_mesh_domain domain =</div><div class="line">    Periodic_mesh_domain::create_implicit_mesh_domain(schwarz_p, canonical_cube);</div><div class="line"></div><div class="line">  Periodic_mesh_criteria criteria(facet_angle = 30,</div><div class="line">                                  facet_size = 0.05 * domain_size,</div><div class="line">                                  facet_distance = 0.025 * domain_size,</div><div class="line">                                  cell_radius_edge_ratio = 2.,</div><div class="line">                                  cell_size = 0.05);</div><div class="line"></div><div class="line">  <span class="comment">// Mesh generation</span></div><div class="line">  C3t3 c3t3 = CGAL::make_periodic_3_mesh_3&lt;C3t3&gt;(domain, criteria);</div><div class="line"></div><div class="line">  std::ofstream medit_file(<span class="stringliteral">"output_implicit_shape.mesh"</span>);</div><div class="line">  <a class="code" href="group__PkgPeriodic__3__mesh__3IOFunctions.html#ga22e9a84d23dea5461571db65a2eb27a5">CGAL::output_periodic_mesh_to_medit</a>(medit_file, c3t3, number_of_copies_in_output);</div><div class="line"></div><div class="line">  std::cout &lt;&lt; <span class="stringliteral">"EXIT SUCCESS"</span> &lt;&lt; std::endl;</div><div class="line">  <span class="keywordflow">return</span> 0;</div><div class="line">}</div><div class="line"></div></div><!-- fragment --><p><a class="anchor" id="fig__Periodic_3_mesh_3Periodic_implicit_shape"></a></p><center> <div class="image">
<img src="periodic_implicit_domain.png" style="max-width:90%;" />
</div>
 </center><p>  </p><div class="cgal_figure_caption">  <a class="el" href="index.html#fig__Periodic_3_mesh_3Periodic_implicit_shape">Figure 56.3</a> A single copy of a periodic mesh produced from an implicit domain (left). Cut view (middle). Another cut is shown, using 8 copies (right).  </div>  <br />

<p>While the implicit function used in the previous example is defined and periodic over the complete space, it is also possible to consider non-periodic implicit functions defined entirely within the canonical cube (or over the whole space) by using the wrapper class <code><a class="el" href="classCGAL_1_1Periodic__3__function__wrapper.html" title="The class Periodic_3_function_wrapper is a helper class designed to wrap an (a priori non-periodic) i...">CGAL::Periodic_3_function_wrapper</a></code>. Values will then be periodically duplicated, creating a periodic function. For example, replacing the previous domain with the following non-periodic implicit function (a sphere):</p>
<div class="fragment"><div class="line">...</div><div class="line">typedef <a class="code" href="classCGAL_1_1Periodic__3__function__wrapper.html">CGAL::Periodic_3_function_wrapper&lt;Function, K&gt;</a>              Periodic_function;</div><div class="line">...</div><div class="line"><span class="comment">// A sphere centered on (0.5, 0.5, 0.5) with radius sqrt(0.2)</span></div><div class="line">FT sphere_function (<span class="keyword">const</span> Point&amp; p) { <span class="keywordflow">return</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Kernel_23.tag:../Kernel_23/" href="../Kernel_23/group__squared__distance__grp.html#ga1ff73525660a052564d33fbdd61a4f71">CGAL::squared_distance</a>(p, Point(0.5, 0.5, 0.5)) - 0.2; }</div><div class="line">...</div><div class="line">Iso_cuboid_3 canonical_cube(0, 0, 0, 1, 1, 1);</div><div class="line">Periodic_mesh_domain domain =</div><div class="line">  Periodic_mesh_domain::create_implicit_mesh_domain(</div><div class="line">    Periodic_function(sphere_function, canonical_cube), canonical_cube );</div><div class="line">...</div></div><!-- fragment --><p>will yield the mesh shown on <a class="el" href="index.html#fig__Periodic_3_mesh_3Periodic_implicit_sphere">Figure 56.4</a>.</p>
<p><a class="anchor" id="fig__Periodic_3_mesh_3Periodic_implicit_sphere"></a></p><center> <div class="image">
<img src="periodic_implicit_spheres.png" style="max-width:70%;" />
</div>
 </center><p>  </p><div class="cgal_figure_caption">  <a class="el" href="index.html#fig__Periodic_3_mesh_3Periodic_implicit_sphere">Figure 56.4</a> Periodic mesh of an implicit sphere that is entirely contained in the input cube, shown with 8 copies (left). A cut view along one of the axes (right).  </div>  <br />

<h3><a class="anchor" id="Periodic_3_mesh_33DDomainsImplicitIsosurfacesBothSides"></a>
Meshing the Interior and the Exterior of a Domain Bounded by an Isosurface</h3>
<p>In the case of periodic mesh generation, the exterior of an isosurface defined by an implicit function can also be meshed because it is a finite space. The class <code><a class="el" href="classCGAL_1_1Implicit__to__labeled__subdomains__function__wrapper.html" title="The class Implicit_to_labeled_subdomains_function_wrapper is a helper class designed to wrap an impli...">Implicit_to_labeled_subdomains_function_wrapper</a></code> is a convenient wrapper to achieve this by internally transforming the interior and the exterior as simply two subdomains to be meshed. Compared to the previous example, it can be simply achieved by adding the line </p><div class="fragment"><div class="line">...</div><div class="line">typedef <a class="code" href="classCGAL_1_1Implicit__to__labeled__subdomains__function__wrapper.html">CGAL::Implicit_to_labeled_subdomains_function_wrapper&lt;Function, K&gt;</a> Function_wrapper;</div><div class="line">...</div></div><!-- fragment --><p> and wrapping the function as follows: </p><div class="fragment"><div class="line">...</div><div class="line">Function_wrapper wrapper(schwarz_p);</div><div class="line">Periodic_mesh_domain domain(wrapper, canonical_cube);</div><div class="line">...</div></div><!-- fragment --><p><a class="el" href="index.html#fig__Periodic_3_mesh_3Periodic_implicit_interior_and_exterior">Figure 56.5</a> shows the periodic mesh obtained after this change. Note that both subdomains are meshed with different cell sizing fields, which can be obtained using the class <code><a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Mesh_3.tag:../Mesh_3/" href="../Mesh_3/classCGAL_1_1Mesh__constant__domain__field__3.html">Mesh_constant_domain_field_3</a></code>. See Example <a class="el" href="Periodic_3_mesh_3_2mesh_implicit_shape_with_subdomains_8cpp-example.html">mesh_implicit_shape_with_subdomains.cpp</a> for the complete code.</p>
<p><a class="anchor" id="fig__Periodic_3_mesh_3Periodic_implicit_interior_and_exterior"></a></p><center> <div class="image">
<img src="periodic_implicit_interior_and_exterior.jpg" style="max-width:70%;" />
</div>
 </center><p>  </p><div class="cgal_figure_caption">  <a class="el" href="index.html#fig__Periodic_3_mesh_3Periodic_implicit_interior_and_exterior">Figure 56.5</a> A periodic mesh (4 copies, left) of the same implicit function as in <a class="el" href="index.html#fig__Periodic_3_mesh_3Periodic_implicit_shape">Figure 56.3</a>), where both sides of the isosurface are now meshed. On the right, a cut view.  </div>  <br />

<h2><a class="anchor" id="Periodic_3_mesh_3MeshingMultipleDomains"></a>
Meshing Multiple Domains</h2>
<p>The following code produces a 3D periodic mesh for a domain consisting of a combination of the two implicit functions used in the previous example: a sphere is encompassed within the implicit domain of <a class="el" href="index.html#fig__Periodic_3_mesh_3Periodic_implicit_shape">Figure 56.3</a>. The class <code><a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Mesh_3.tag:../Mesh_3/" href="../Mesh_3/classCGAL_1_1Implicit__multi__domain__to__labeling__function__wrapper.html">Implicit_multi_domain_to_labeling_function_wrapper</a></code> is used as model of <code><a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Surface_mesher.tag:../Surface_mesher/" href="../Surface_mesher/classImplicitFunction.html">ImplicitFunction</a></code>, required by the class <code><a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Mesh_3.tag:../Mesh_3/" href="../Mesh_3/classCGAL_1_1Labeled__mesh__domain__3.html">Labeled_mesh_domain_3</a></code>. The set of subdomains is given by a vector of vector of signs. Each subdomain corresponds to a sign vector <code>[s1, s2, ..., sn]</code>, where <code>si</code> is the sign of the function <code>fi(p)</code> at a point <code>p</code> of the subdomain. <a class="el" href="index.html#fig__Periodic_3_mesh_3Periodic_multi_domain">Figure 56.6</a> shows a view and a cut view of the resulting mesh.</p>
<p><br />
<b>File</b> <a class="el" href="Periodic_3_mesh_3_2mesh_implicit_multi_domain_8cpp-example.html">Periodic_3_mesh_3/mesh_implicit_multi_domain.cpp</a> </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;CGAL/Periodic_3_mesh_3/config.h&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Exact_predicates_inexact_constructions_kernel.h&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;CGAL/make_periodic_3_mesh_3.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Periodic_3_mesh_3/IO/File_medit.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Periodic_3_mesh_triangulation_3.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Periodic_3_function_wrapper.h&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Implicit_to_labeling_function_wrapper.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Labeled_mesh_domain_3.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Mesh_complex_3_in_triangulation_3.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Mesh_criteria_3.h&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;CGAL/number_type_config.h&gt;</span> <span class="comment">// CGAL_PI</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;cmath&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;fstream&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;string&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;vector&gt;</span></div><div class="line"></div><div class="line"><span class="comment">// Kernel</span></div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Kernel_23.tag:../Kernel_23/" href="../Kernel_23/classCGAL_1_1Exact__predicates__inexact__constructions__kernel.html">CGAL::Exact_predicates_inexact_constructions_kernel</a> K;</div><div class="line"><span class="keyword">typedef</span> K::FT                                               FT;</div><div class="line"><span class="keyword">typedef</span> K::Point_3                                          Point;</div><div class="line"><span class="keyword">typedef</span> K::Iso_cuboid_3                                     Iso_cuboid;</div><div class="line"></div><div class="line"><span class="comment">// Domain</span></div><div class="line"><span class="keyword">typedef</span> FT (*Function)(<span class="keyword">const</span> Point&amp;);</div><div class="line">  <span class="comment">// This wrapper is needed to make 'sphere_function' periodic.</span></div><div class="line"><span class="keyword">typedef</span> <a class="code" href="classCGAL_1_1Periodic__3__function__wrapper.html">CGAL::Periodic_3_function_wrapper&lt;Function, K&gt;</a>      Periodic_function;</div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Mesh_3.tag:../Mesh_3/" href="../Mesh_3/classCGAL_1_1Implicit__multi__domain__to__labeling__function__wrapper.html">CGAL::Implicit_multi_domain_to_labeling_function_wrapper&lt;Periodic_function&gt;</a> Multi_domain_wrapper;</div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Mesh_3.tag:../Mesh_3/" href="../Mesh_3/classCGAL_1_1Labeled__mesh__domain__3.html">CGAL::Labeled_mesh_domain_3&lt;K&gt;</a>                      Periodic_mesh_domain;</div><div class="line"></div><div class="line"><span class="comment">// Triangulation</span></div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Manual.tag:../Manual/" href="../Manual/classunspecified__type.html">CGAL::Periodic_3_mesh_triangulation_3&lt;Periodic_mesh_domain&gt;::type</a>  Tr;</div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Mesh_3.tag:../Mesh_3/" href="../Mesh_3/classCGAL_1_1Mesh__complex__3__in__triangulation__3.html">CGAL::Mesh_complex_3_in_triangulation_3&lt;Tr&gt;</a>                        C3t3;</div><div class="line"></div><div class="line"><span class="comment">// Criteria</span></div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Mesh_3.tag:../Mesh_3/" href="../Mesh_3/classCGAL_1_1Mesh__criteria__3.html">CGAL::Mesh_criteria_3&lt;Tr&gt;</a>                           Periodic_mesh_criteria;</div><div class="line"></div><div class="line"><span class="comment">// To avoid verbose function and named parameters call</span></div><div class="line"><span class="keyword">using namespace </span><a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Mesh_3.tag:../Mesh_3/" href="../Mesh_3/namespaceCGAL_1_1parameters.html">CGAL::parameters</a>;</div><div class="line"></div><div class="line"><span class="comment">// Implicit functions</span></div><div class="line">FT sphere_function(<span class="keyword">const</span> Point&amp; p)</div><div class="line">{</div><div class="line">  <span class="keywordflow">return</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Kernel_23.tag:../Kernel_23/" href="../Kernel_23/group__squared__distance__grp.html#ga1ff73525660a052564d33fbdd61a4f71">CGAL::squared_distance</a>(p, Point(0.5, 0.5, 0.5)) - 0.15;</div><div class="line">}</div><div class="line"></div><div class="line">FT schwarz_p(<span class="keyword">const</span> Point&amp; p)</div><div class="line">{</div><div class="line">  <span class="keyword">const</span> FT x2 = std::cos( p.x() * 2 * CGAL_PI ),</div><div class="line">           y2 = std::cos( p.y() * 2 * CGAL_PI ),</div><div class="line">           z2 = std::cos( p.z() * 2 * CGAL_PI );</div><div class="line"></div><div class="line">  <span class="keywordflow">return</span> x2 + y2 + z2;</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>** argv)</div><div class="line">{</div><div class="line">  <span class="keywordtype">int</span> domain_size = (argc &gt; 1) ? atoi(argv[1]) : 1;</div><div class="line">  <span class="keywordtype">int</span> number_of_copies_in_output = (argc &gt; 2) ? atoi(argv[2]) : 4; <span class="comment">// can be 1, 2, 4, or 8</span></div><div class="line"></div><div class="line">  Iso_cuboid canonical_cube(0, 0, 0, domain_size, domain_size, domain_size);</div><div class="line"></div><div class="line">  std::vector&lt;Periodic_function&gt; funcs;</div><div class="line">  funcs.push_back(Periodic_function(&amp;schwarz_p, canonical_cube));</div><div class="line">  funcs.push_back(Periodic_function(&amp;sphere_function, canonical_cube));</div><div class="line"></div><div class="line">  <span class="comment">// The vector of vectors of sign is passed as a vector of strings (since a string</span></div><div class="line">  <span class="comment">// is a vector of chars)</span></div><div class="line">  std::vector&lt;std::string&gt; vps;</div><div class="line">  vps.push_back(<span class="stringliteral">"--"</span>);</div><div class="line">  vps.push_back(<span class="stringliteral">"-+"</span>);</div><div class="line"></div><div class="line">  Multi_domain_wrapper multi_domain_function(funcs, vps);</div><div class="line">  Periodic_mesh_domain domain(multi_domain_function, canonical_cube);</div><div class="line"></div><div class="line">  Periodic_mesh_criteria criteria(facet_angle = 30,</div><div class="line">                                  facet_size = 0.04,</div><div class="line">                                  facet_distance = 0.025,</div><div class="line">                                  cell_radius_edge_ratio = 2.,</div><div class="line">                                  cell_size = 0.04);</div><div class="line"></div><div class="line">  <span class="comment">// Mesh generation</span></div><div class="line">  C3t3 c3t3 = CGAL::make_periodic_3_mesh_3&lt;C3t3&gt;(domain, criteria);</div><div class="line"></div><div class="line">  <span class="comment">// Output</span></div><div class="line">  std::ofstream medit_file(<span class="stringliteral">"output_multi_domain.mesh"</span>);</div><div class="line">  CGAL::output_periodic_mesh_to_medit&lt;C3t3&gt;(medit_file, c3t3, number_of_copies_in_output,</div><div class="line">                                            <span class="keyword">false</span> <span class="comment">/*do not associate different colors to each copy*/</span>,</div><div class="line">                                            <span class="keyword">false</span> <span class="comment">/*do not rebind*/</span>, <span class="keyword">true</span> <span class="comment">/*show patches*/</span>);</div><div class="line"></div><div class="line">  std::cout &lt;&lt; <span class="stringliteral">"EXIT SUCCESS"</span> &lt;&lt; std::endl;</div><div class="line">  <span class="keywordflow">return</span> 0;</div><div class="line">}</div></div><!-- fragment --><p><a class="anchor" id="fig__Periodic_3_mesh_3Periodic_multi_domain"></a></p><center> <div class="image">
<img src="periodic_implicit_multi_domain.jpg" style="max-width:90%;" />
</div>
 </center><p>  </p><div class="cgal_figure_caption">  <a class="el" href="index.html#fig__Periodic_3_mesh_3Periodic_multi_domain">Figure 56.6</a> A periodic mesh produced by a combination of implicit functions (with 8 copies, left). Cut view without (middle) and with (right) the internal tetrahedra.  </div>  <br />

<h2><a class="anchor" id="Periodic_3_mesh_3Optimizers"></a>
Tuning Mesh Optimization</h2>
<p>In the previous examples, the mesh generation is launched through a call <code><a class="el" href="group__PkgPeriodic__3__mesh__3Functions.html#ga0b7d3bf3e957fbf8ed46f9ed139502b5" title="The function make_periodic_3_mesh_3() is a 3D periodic mesh generator. ">make_periodic_3_mesh_3()</a></code> with a minimal number of parameters. In such cases, the default optimization strategy is applied: after the Delaunay refinement process two optimization steps are performed, a perturbation and a sliver exudation. The following example shows how to enable and disable the various optimization methods. <a class="el" href="index.html#fig__Periodic_3_mesh_3Periodic_multi_domain">Figure 56.6</a> shows the resulting periodic mesh before and after optimizations.</p>
<p><br />
<b>File</b> <a class="el" href="Periodic_3_mesh_3_2mesh_implicit_shape_with_optimizers_8cpp-example.html">Periodic_3_mesh_3/mesh_implicit_shape_with_optimizers.cpp</a> </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;CGAL/Periodic_3_mesh_3/config.h&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Exact_predicates_inexact_constructions_kernel.h&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;CGAL/make_periodic_3_mesh_3.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/optimize_periodic_3_mesh_3.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Periodic_3_mesh_triangulation_3.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Periodic_3_mesh_3/IO/File_medit.h&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Labeled_mesh_domain_3.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Mesh_complex_3_in_triangulation_3.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Mesh_criteria_3.h&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;CGAL/number_type_config.h&gt;</span> <span class="comment">// CGAL_PI</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;cmath&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;fstream&gt;</span></div><div class="line"></div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Kernel_23.tag:../Kernel_23/" href="../Kernel_23/classCGAL_1_1Exact__predicates__inexact__constructions__kernel.html">CGAL::Exact_predicates_inexact_constructions_kernel</a> K;</div><div class="line"><span class="keyword">typedef</span> K::FT                                               FT;</div><div class="line"><span class="keyword">typedef</span> K::Point_3                                          Point;</div><div class="line"><span class="keyword">typedef</span> K::Iso_cuboid_3                                     Iso_cuboid;</div><div class="line"></div><div class="line"><span class="comment">// Domain</span></div><div class="line"><span class="keyword">typedef</span> FT (Function)(<span class="keyword">const</span> Point&amp;);</div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Mesh_3.tag:../Mesh_3/" href="../Mesh_3/classCGAL_1_1Labeled__mesh__domain__3.html">CGAL::Labeled_mesh_domain_3&lt;K&gt;</a>                      Periodic_mesh_domain;</div><div class="line"></div><div class="line"><span class="comment">// Triangulation</span></div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Manual.tag:../Manual/" href="../Manual/classunspecified__type.html">CGAL::Periodic_3_mesh_triangulation_3&lt;Periodic_mesh_domain&gt;::type</a> Tr;</div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Mesh_3.tag:../Mesh_3/" href="../Mesh_3/classCGAL_1_1Mesh__complex__3__in__triangulation__3.html">CGAL::Mesh_complex_3_in_triangulation_3&lt;Tr&gt;</a>                       C3t3;</div><div class="line"></div><div class="line"><span class="comment">// Criteria</span></div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Mesh_3.tag:../Mesh_3/" href="../Mesh_3/classCGAL_1_1Mesh__criteria__3.html">CGAL::Mesh_criteria_3&lt;Tr&gt;</a>                           Periodic_mesh_criteria;</div><div class="line"></div><div class="line"><span class="comment">// To avoid verbose function and named parameters call</span></div><div class="line"><span class="keyword">using namespace </span><a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Mesh_3.tag:../Mesh_3/" href="../Mesh_3/namespaceCGAL_1_1parameters.html">CGAL::parameters</a>;</div><div class="line"></div><div class="line"><span class="comment">// Implicit function</span></div><div class="line">FT double_p(<span class="keyword">const</span> Point&amp; p)</div><div class="line">{</div><div class="line">  <span class="keyword">const</span> FT cx = std::cos(2 * CGAL_PI * p.x()),</div><div class="line">           cy = std::cos(2 * CGAL_PI * p.y()),</div><div class="line">           cz = std::cos(2 * CGAL_PI * p.z());</div><div class="line">  <span class="keyword">const</span> FT c2x = std::cos(4 * CGAL_PI * p.x()),</div><div class="line">           c2y = std::cos(4 * CGAL_PI * p.y()),</div><div class="line">           c2z = std::cos(4 * CGAL_PI * p.z());</div><div class="line"></div><div class="line">  <span class="keywordflow">return</span> 0.5 * (cx*cy + cy*cz + cz*cx) + 0.2 * (c2x + c2y + c2z);</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>** argv)</div><div class="line">{</div><div class="line">  <span class="comment">// 'int' because the 'double_p' function is periodic over the domain only if</span></div><div class="line">  <span class="comment">// the length of the side of the domain is an integer</span></div><div class="line">  <span class="keywordtype">int</span> domain_size = (argc &gt; 1) ? atoi(argv[1]) : 1;</div><div class="line">  <span class="keywordtype">int</span> number_of_copies_in_output = (argc &gt; 2) ? atoi(argv[2]) : 8; <span class="comment">// can be 1, 2, 4, or 8</span></div><div class="line"></div><div class="line">  Iso_cuboid canonical_cube(0, 0, 0, domain_size, domain_size, domain_size);</div><div class="line"></div><div class="line">  <span class="comment">// there is no need for periodicity... ?</span></div><div class="line">  Periodic_mesh_domain domain =</div><div class="line">    Periodic_mesh_domain::create_implicit_mesh_domain(double_p, canonical_cube);</div><div class="line"></div><div class="line">  Periodic_mesh_criteria criteria(facet_angle = 30,</div><div class="line">                                  facet_size = 0.05 * domain_size,</div><div class="line">                                  facet_distance = 0.025 * domain_size,</div><div class="line">                                  cell_radius_edge_ratio = 2.,</div><div class="line">                                  cell_size = 0.05);</div><div class="line"></div><div class="line">  <span class="comment">// Mesh generation with optimizers</span></div><div class="line">  C3t3 c3t3 = CGAL::make_periodic_3_mesh_3&lt;C3t3&gt;(domain, criteria,</div><div class="line">                                                 <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Mesh_3.tag:../Mesh_3/" href="../Mesh_3/group__PkgMesh__3Parameters.html#gafbecfd22651a08e6812d8a5ad9b49852">odt</a>(convergence=0.03, freeze_bound=0.02, time_limit=30),</div><div class="line">                                                 <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Mesh_3.tag:../Mesh_3/" href="../Mesh_3/group__PkgMesh__3Parameters.html#gaa7254c80bba62400f43f1e49506b975a">lloyd</a>(max_iteration_number=10),</div><div class="line">                                                 <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Mesh_3.tag:../Mesh_3/" href="../Mesh_3/group__PkgMesh__3Parameters.html#gaedf18f7f3c4647ec5fce5d67e435757a">perturb</a>(sliver_bound=10, time_limit=30),</div><div class="line">                                                 <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Mesh_3.tag:../Mesh_3/" href="../Mesh_3/group__PkgMesh__3Parameters.html#ga16694b09a2acc8ab3f26b7d57633ccb0">exude</a>(sliver_bound=10, time_limit=0));</div><div class="line"></div><div class="line">  std::ofstream medit_file(<span class="stringliteral">"output_implicit_shape_optimized.mesh"</span>);</div><div class="line">  <a class="code" href="group__PkgPeriodic__3__mesh__3IOFunctions.html#ga22e9a84d23dea5461571db65a2eb27a5">CGAL::output_periodic_mesh_to_medit</a>(medit_file, c3t3);</div><div class="line"></div><div class="line">  <span class="comment">// Below, the mesh generation and the optimizations are done in several calls</span></div><div class="line">  C3t3 c3t3_bis = CGAL::make_periodic_3_mesh_3&lt;C3t3&gt;(domain, criteria,</div><div class="line">                                                     <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Mesh_3.tag:../Mesh_3/" href="../Mesh_3/group__PkgMesh__3Parameters.html#ga1d041e8dbde3860cde3c20107225ecb1">no_odt</a>(), <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Mesh_3.tag:../Mesh_3/" href="../Mesh_3/group__PkgMesh__3Parameters.html#ga6abfd3773eeb47d88ce6cffb91f14d2f">no_lloyd</a>(),</div><div class="line">                                                     <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Mesh_3.tag:../Mesh_3/" href="../Mesh_3/group__PkgMesh__3Parameters.html#ga5714d10decd9eecd30997572b785e03b">no_perturb</a>(), <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Mesh_3.tag:../Mesh_3/" href="../Mesh_3/group__PkgMesh__3Parameters.html#ga0b79c473082a4ec2a45ed1497f3ac873">no_exude</a>());</div><div class="line"></div><div class="line">  std::ofstream medit_file_bis(<span class="stringliteral">"output_implicit_shape_non-optimized.mesh"</span>);</div><div class="line">  <a class="code" href="group__PkgPeriodic__3__mesh__3IOFunctions.html#ga22e9a84d23dea5461571db65a2eb27a5">CGAL::output_periodic_mesh_to_medit</a>(medit_file_bis, c3t3_bis);</div><div class="line"></div><div class="line">  <span class="comment">// Now, call each optimizer with its global function</span></div><div class="line">  <a class="code" href="group__PkgPeriodic__3__mesh__3Functions.html#ga98171a3e9d5208454d13cb52b8815737">CGAL::odt_optimize_periodic_3_mesh_3</a>(c3t3_bis, domain, convergence=0.03, freeze_bound=0.02, time_limit=30);</div><div class="line">  <a class="code" href="group__PkgPeriodic__3__mesh__3Functions.html#gad04cbbb510f43fbc760c95e1b2ac170f">CGAL::lloyd_optimize_periodic_3_mesh_3</a>(c3t3_bis, domain, max_iteration_number=10);</div><div class="line">  <a class="code" href="group__PkgPeriodic__3__mesh__3Functions.html#ga423a8902ca11f0f01bb30aa5344fda55">CGAL::perturb_periodic_3_mesh_3</a>(c3t3_bis, domain, sliver_bound=10, time_limit=30);</div><div class="line">  <a class="code" href="group__PkgPeriodic__3__mesh__3Functions.html#ga3c195958b87a6e501b37d10f29f0c0a8">CGAL::exude_periodic_3_mesh_3</a>(c3t3_bis, sliver_bound=10, time_limit=0);</div><div class="line"></div><div class="line">  std::ofstream medit_file_ter(<span class="stringliteral">"output_implicit_shape_two_steps.mesh"</span>);</div><div class="line">  <a class="code" href="group__PkgPeriodic__3__mesh__3IOFunctions.html#ga22e9a84d23dea5461571db65a2eb27a5">CGAL::output_periodic_mesh_to_medit</a>(medit_file_ter, c3t3_bis, number_of_copies_in_output);</div><div class="line"></div><div class="line">  std::cout &lt;&lt; <span class="stringliteral">"EXIT SUCCESS"</span> &lt;&lt; std::endl;</div><div class="line">  <span class="keywordflow">return</span> 0;</div><div class="line">}</div><div class="line"></div></div><!-- fragment --><p><a class="anchor" id="fig__Periodic_3_mesh_3Periodic_optimizers"></a></p><center> <div class="image">
<img src="periodic_implicit_optimizers.png" style="max-width:90%;" />
</div>
 </center><p>  </p><div class="cgal_figure_caption">  <a class="el" href="index.html#fig__Periodic_3_mesh_3Periodic_optimizers">Figure 56.7</a> Compared effect of a mesh pre- and post-optimization using all available optimizers. The numbers under the histograms give the measure in degrees of the smallest and biggest dihedral angles in the mesh.  </div>  <br />

<h2><a class="anchor" id="Periodic_3_mesh_3MeshingDomainswithSharpFeatures"></a>
Meshing Domains with Sharp Features</h2>
<p>The periodic mesh generator currently operates on domains described by one or multiple implicit functions. Sharp features to be preserved must then be explicitly specified by hand by the user, using the mesh domain class <code><a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Mesh_3.tag:../Mesh_3/" href="../Mesh_3/classCGAL_1_1Mesh__domain__with__polyline__features__3.html">CGAL::Mesh_domain_with_polyline_features_3</a></code> and its functions <code>add_corners()</code> and <code>add_features()</code>. These functions allow to specify curves (as a polyline – a list of points with two consecutive points forming a segment of the curve) and corners which should appear in the final mesh. Note that the discretization of the specified curves might change: for example, a curve might be subdivided in smaller segments or simplified in larger segments, but the prescribed geometry will still be present in the final mesh.</p>
<p>To ensure the good protection of features, some requirements are put on the curves and corners that are specified by the user:</p><ul>
<li>A corner can only belong to a curve if it is an endpoint of that curve.</li>
<li>A curve cannot self-intersect, except at its endpoint (it then forms a so-called <code>cycle</code>).</li>
<li>Two curves cannot intersect, except at a common endpoint.</li>
</ul>
<dl class="section warning"><dt>Warning</dt><dd>For conveniency, curves and corners do not need to be restricted to the canonical cube, but users should be mindful that curves and corners will exist in all periodic copies and the requirements described above must be satisfied. For example, if considering the unit cube as canonical cube, it is not valid to add the segment <code>(2,2,2)--(3,3,3)</code> as feature and the point <code>(1.5, 1.5, 1.5)</code> as corner: once the periodicity is taken in account, the point is actually the middle of the segment.</dd></dl>
<h3><a class="anchor" id="Periodic_3_mesh_3ConeWithSharpFeatures"></a>
Example of a Cone-like Periodic Domain</h3>
<p>The example below uses two different types of protecting features: a cycle to protect the base of the cone, and a corner at the apex of a cone, which ensures that the apex will appear in the mesh. <a class="el" href="index.html#fig__Periodic_3_mesh_3Periodic_protection">Figure 56.8</a> shows the comparison between the same domain meshed with the same criteria when protection is disabled and enabled.</p>
<p>Note the use of a more complex intrinsically non-periodic implicit function as input domain.</p>
<p><br />
<b>File</b> <a class="el" href="Periodic_3_mesh_3_2mesh_implicit_shape_with_features_8cpp-example.html">Periodic_3_mesh_3/mesh_implicit_shape_with_features.cpp</a> </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;CGAL/Periodic_3_mesh_3/config.h&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Exact_predicates_inexact_constructions_kernel.h&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;CGAL/make_periodic_3_mesh_3.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Periodic_3_mesh_3/IO/File_medit.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Periodic_3_mesh_triangulation_3.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Periodic_3_function_wrapper.h&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Labeled_mesh_domain_3.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Mesh_complex_3_in_triangulation_3.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Mesh_criteria_3.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Mesh_domain_with_polyline_features_3.h&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;algorithm&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;cmath&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;fstream&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;list&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;vector&gt;</span></div><div class="line"></div><div class="line"><span class="comment">// Kernel</span></div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Kernel_23.tag:../Kernel_23/" href="../Kernel_23/classCGAL_1_1Exact__predicates__inexact__constructions__kernel.html">CGAL::Exact_predicates_inexact_constructions_kernel</a>         K;</div><div class="line"></div><div class="line"><span class="comment">// Domain</span></div><div class="line"><span class="keyword">typedef</span> K::FT                                                       FT;</div><div class="line"><span class="keyword">typedef</span> K::Point_3                                                  Point;</div><div class="line"><span class="keyword">typedef</span> K::Iso_cuboid_3                                             Iso_cuboid;</div><div class="line"></div><div class="line"><span class="keyword">typedef</span> FT (Function)(<span class="keyword">const</span> Point&amp;);</div><div class="line"><span class="keyword">typedef</span> <a class="code" href="classCGAL_1_1Periodic__3__function__wrapper.html">CGAL::Periodic_3_function_wrapper&lt;Function, K&gt;</a>              Periodic_function;</div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Mesh_3.tag:../Mesh_3/" href="../Mesh_3/classCGAL_1_1Mesh__domain__with__polyline__features__3.html">CGAL::Mesh_domain_with_polyline_features_3&lt;CGAL::Labeled_mesh_domain_3&lt;K&gt;</a> &gt; Periodic_mesh_domain;</div><div class="line"></div><div class="line"><span class="comment">// Polyline</span></div><div class="line"><span class="keyword">typedef</span> std::vector&lt;Point&gt;                                          Polyline_3;</div><div class="line"><span class="keyword">typedef</span> std::list&lt;Polyline_3&gt;                                       Polylines;</div><div class="line"></div><div class="line"><span class="comment">// Triangulation</span></div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Manual.tag:../Manual/" href="../Manual/classunspecified__type.html">CGAL::Periodic_3_mesh_triangulation_3&lt;Periodic_mesh_domain&gt;::type</a>             Tr;</div><div class="line"></div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Mesh_3.tag:../Mesh_3/" href="../Mesh_3/classCGAL_1_1Mesh__complex__3__in__triangulation__3.html">CGAL::Mesh_complex_3_in_triangulation_3</a>&lt;</div><div class="line">          Tr, Periodic_mesh_domain::Corner_index, Periodic_mesh_domain::Curve_index&gt;  C3t3;</div><div class="line"></div><div class="line"><span class="comment">// Criteria</span></div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Mesh_3.tag:../Mesh_3/" href="../Mesh_3/classCGAL_1_1Mesh__criteria__3.html">CGAL::Mesh_criteria_3&lt;Tr&gt;</a>                                   Periodic_mesh_criteria;</div><div class="line"></div><div class="line"><span class="comment">// To avoid verbose function and named parameters call</span></div><div class="line"><span class="keyword">using namespace </span><a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Mesh_3.tag:../Mesh_3/" href="../Mesh_3/namespaceCGAL_1_1parameters.html">CGAL::parameters</a>;</div><div class="line"></div><div class="line"><span class="comment">// Implicit function</span></div><div class="line"><span class="keyword">static</span> <span class="keyword">const</span> FT cx = 0.51, cy = 0.51, cz = 0.5;</div><div class="line"><span class="keyword">static</span> <span class="keyword">const</span> FT scale = 0.9;</div><div class="line">FT cone_function(<span class="keyword">const</span> Point&amp; p)</div><div class="line">{</div><div class="line">  <span class="keyword">const</span> FT x = p.x(), y = p.y(), z = p.z();</div><div class="line"></div><div class="line">  <span class="keywordflow">if</span> (((x-cx)*(x-cx) + (y-cy)*(y-cy)) &gt; scale * (z-cz)*(z-cz))</div><div class="line">    <span class="keywordflow">return</span> 1; <span class="comment">// outside</span></div><div class="line">  <span class="keywordflow">else</span></div><div class="line">    <span class="keywordflow">return</span> -1; <span class="comment">// inside</span></div><div class="line">}</div><div class="line"></div><div class="line"><span class="comment">// To obtain a good looking mesh at the base of the cone, we protect the base circle</span></div><div class="line"><span class="keywordtype">void</span> cone_polylines(Polylines&amp; polylines)</div><div class="line">{</div><div class="line">  <span class="keyword">const</span> FT z = 0.;</div><div class="line">  <span class="keyword">const</span> FT radius_at_z = CGAL::sqrt(scale * cz * cz);</div><div class="line"></div><div class="line">  Polyline_3 polyline;</div><div class="line">  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;360; ++i)</div><div class="line">  {</div><div class="line">    polyline.push_back(Point(cx + radius_at_z * std::sin(i*CGAL_PI/180),</div><div class="line">                             cy + radius_at_z * std::cos(i*CGAL_PI/180),</div><div class="line">                             z));</div><div class="line">  }</div><div class="line">  polyline.push_back(polyline.front()); <span class="comment">// close the line</span></div><div class="line"></div><div class="line">  polylines.push_back(polyline);</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>** argv)</div><div class="line">{</div><div class="line">  <span class="keywordtype">int</span> number_of_copies_in_output = (argc &gt; 1) ? atoi(argv[1]) : 8; <span class="comment">// can be 1, 2, 4, or 8</span></div><div class="line"></div><div class="line">  <span class="comment">// Domain</span></div><div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> domain_size = 1;</div><div class="line">  Iso_cuboid canonical_cube(0, 0, 0, domain_size, domain_size, domain_size);</div><div class="line"></div><div class="line">  Periodic_mesh_domain domain =</div><div class="line">    Periodic_mesh_domain::create_implicit_mesh_domain(</div><div class="line">      Periodic_function(cone_function, canonical_cube), canonical_cube);</div><div class="line"></div><div class="line">  <span class="comment">// Mesh criteria</span></div><div class="line">  Periodic_mesh_criteria criteria(edge_size = 0.02 * domain_size,</div><div class="line">                                  facet_angle = 0.05 * domain_size,</div><div class="line">                                  facet_size = 0.02 * domain_size,</div><div class="line">                                  cell_radius_edge_ratio = 2,</div><div class="line">                                  cell_size = 0.5);</div><div class="line"></div><div class="line">  <span class="comment">// Create the features that we want to preserve</span></div><div class="line">  Polylines polylines;</div><div class="line">  cone_polylines(polylines);</div><div class="line"></div><div class="line">  <span class="comment">// Insert the features in the domain</span></div><div class="line">  domain.add_features(polylines.begin(), polylines.end());</div><div class="line"></div><div class="line">  <span class="comment">// Insert a corner to make sure the apex of the cone is present in the mesh</span></div><div class="line">  domain.add_corner(Point(0.51, 0.51, 0.5));</div><div class="line"></div><div class="line">  <span class="comment">// Mesh generation WITHOUT feature preservation (and no optimizers)</span></div><div class="line">  C3t3 c3t3 = CGAL::make_periodic_3_mesh_3&lt;C3t3&gt;(domain, criteria, <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Mesh_3.tag:../Mesh_3/" href="../Mesh_3/group__PkgMesh__3Parameters.html#gaa3eb2cb65200b0331ef9d5f14b4a0535">no_features</a>(),</div><div class="line">                                                 <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Mesh_3.tag:../Mesh_3/" href="../Mesh_3/group__PkgMesh__3Parameters.html#ga0b79c473082a4ec2a45ed1497f3ac873">no_exude</a>(), <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Mesh_3.tag:../Mesh_3/" href="../Mesh_3/group__PkgMesh__3Parameters.html#ga5714d10decd9eecd30997572b785e03b">no_perturb</a>());</div><div class="line">  std::ofstream medit_file(<span class="stringliteral">"output_implicit_shape_without_protection.mesh"</span>);</div><div class="line">  <a class="code" href="group__PkgPeriodic__3__mesh__3IOFunctions.html#ga22e9a84d23dea5461571db65a2eb27a5">CGAL::output_periodic_mesh_to_medit</a>(medit_file, c3t3, number_of_copies_in_output);</div><div class="line"></div><div class="line">  <span class="comment">// Mesh generation WITH feature preservation (and no optimizers)</span></div><div class="line">  C3t3 c3t3_bis = CGAL::make_periodic_3_mesh_3&lt;C3t3&gt;(domain, criteria, <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Mesh_3.tag:../Mesh_3/" href="../Mesh_3/group__PkgMesh__3Parameters.html#ga0a990b28d55157c62d4bfd2624d408af">features</a>(),</div><div class="line">                                                     <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Mesh_3.tag:../Mesh_3/" href="../Mesh_3/group__PkgMesh__3Parameters.html#ga0b79c473082a4ec2a45ed1497f3ac873">no_exude</a>(), <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Mesh_3.tag:../Mesh_3/" href="../Mesh_3/group__PkgMesh__3Parameters.html#ga5714d10decd9eecd30997572b785e03b">no_perturb</a>());</div><div class="line">  std::ofstream medit_file_bis(<span class="stringliteral">"output_implicit_shape_with_protection.mesh"</span>);</div><div class="line">  <a class="code" href="group__PkgPeriodic__3__mesh__3IOFunctions.html#ga22e9a84d23dea5461571db65a2eb27a5">CGAL::output_periodic_mesh_to_medit</a>(medit_file_bis, c3t3_bis, number_of_copies_in_output);</div><div class="line"></div><div class="line">  std::cout &lt;&lt; <span class="stringliteral">"EXIT SUCCESS"</span> &lt;&lt; std::endl;</div><div class="line">  <span class="keywordflow">return</span> 0;</div><div class="line">}</div></div><!-- fragment --><p><a class="anchor" id="fig__Periodic_3_mesh_3Periodic_protection"></a></p><center> <div class="image">
<img src="periodic_implicit_protection.jpg" style="max-width:90%;" />
</div>
 </center><p>  </p><div class="cgal_figure_caption">  <a class="el" href="index.html#fig__Periodic_3_mesh_3Periodic_protection">Figure 56.8</a> A periodic mesh obtained with a cone-like periodic implicit function (8 copies are drawn). The base and the apex of the cone are badly approximated when protection is unused (left). Using protection, we obtain a faithful approximation. (Facets seemingly disconnected from other facets of the same color are due to the fact that a single copy of the mesh does not necessarily form a visually pleasing mesh by itself; see Section <a class="el" href="index.html#Periodic_3_mesh_3SubMultipleCopies">Visualizing Multiple Copies of a Periodic Mesh</a> for more details.)  </div>  <br />

<h3><a class="anchor" id="Periodic_3_mesh_3InfiniteFeatures"></a>
Example of Protecting Curves Extending Continuously Over Multiple Periodic Copies</h3>
<p>It is possible to prescribe features that will, due to periodicity, form a continuous polyline that extends infinitely in space. A simple example of such occurrence is the segment <code>(0,0,0) -- (1,1,1)</code> when considering the unit cube as canonical cube. <a class="el" href="index.html#fig__Periodic_3_mesh_3Periodic_protection">Figure 56.8</a> shows an implicit function describing a square-based prism such that the axis of the prism is the (Oz) axis. (The prism is thus 'cut' into 4 pieces when considered within a single copy of the periodic space.) The canonical cube is the unit cube and the following polylines have been specified to protect edges: </p><div class="fragment"><div class="line"><span class="comment">// These are four vertical edges (orthogonal to xOy), strictly in the domain.</span></div><div class="line"><span class="comment">// They correspond to the four sharp edges of the prism.</span></div><div class="line">LV0: ( 0.3,  0.3, -1) -- ( 0.3,  0.3, 0) <span class="comment">// canonically, (0.3, 0.3, 0) -- (0.3, 0.3, 1)</span></div><div class="line">LV1: ( 1.7,  1.7,  2) -- ( 1.7,  1.7, 3) <span class="comment">// canonically, (0.7, 0.7, 0) -- (0.7, 0.7, 1)</span></div><div class="line">LV2: ( 0.7,  0.3,  4) -- ( 0.7,  0.3, 5) <span class="comment">// canonically, (0.7, 0.3, 0) -- (0.7, 0.3, 1)</span></div><div class="line">LV3: (-0.7, -0.3,  6) -- (-0.7, -0.3, 7) <span class="comment">// canonically, (0.3, 0.7, 0) -- (0.3, 0.7, 1)</span></div><div class="line"></div><div class="line"><span class="comment">// These are four vertical edges (orthogonal to xOy) on the border of the domain.</span></div><div class="line"><span class="comment">// The prism does not intrinsically possess a sharp feature at these locations;</span></div><div class="line"><span class="comment">// rather, these edges are protected to artificially create features on the border of the domain.</span></div><div class="line">LV4: (0.3, 0,   0) -- (0.3, 0,   1)</div><div class="line">LV5: (0,   1.3, 0) -- (0,   1.3, 1) <span class="comment">// canonically, (0.,  0.3, 0) -- (0.,  0.3, 1)</span></div><div class="line">LV6: (0,   0.7, 0) -- (0,   0.7, 1)</div><div class="line">LV7: (2.7, 2,   0) -- (2.7, 2,   1) <span class="comment">// canonically, (0.7, 0.,  0) -- (0.7, 0.,  1)</span></div><div class="line"></div><div class="line"><span class="comment">// These are four horizontal edges (in the plane xOy) on the border of the domain.</span></div><div class="line"><span class="comment">// As the last four polylines, these polylines do not correspond to a sharp feature</span></div><div class="line"><span class="comment">// on the prism, but are rather just for aesthetics.</span></div><div class="line"><span class="comment">//</span></div><div class="line"><span class="comment">// Note that these polylines cross the border of the input cube.</span></div><div class="line">LH0: ( 0.3,  0.3, 0) -- ( 0.3, -0.3, 0)</div><div class="line">LH1: ( 0.3, -0.3, 1) -- (-0.3, -0.3, 1)</div><div class="line">LH2: (-0.3, -0.3, 2) -- (-0.3,  0.3, 2)</div><div class="line">LH3: (-0.3,  0.3, 3) -- ( 0.3,  0.3, 3)</div></div><!-- fragment --><p><a class="anchor" id="fig__Periodic_3_mesh_3Periodic_protection_infinite"></a></p><center> <div class="image">
<img src="periodic_implicit_protection_bis.jpg" style="max-width:90%;" />
</div>
 </center><p>  </p><div class="cgal_figure_caption">  <a class="el" href="index.html#fig__Periodic_3_mesh_3Periodic_protection_infinite">Figure 56.9</a> A periodic mesh without (left) and with (right) sharp features protection.  </div>  <br />

<h2><a class="anchor" id="Periodic_3_mesh_3ComplexExamples"></a>
Further Examples</h2>
<p>Advanced use cases of the 3D mesh generator with implicit domains, its optimizers, and protection mechanisms can be found in Section <a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Mesh_3.tag:../Mesh_3/" href="../Mesh_3/index.html#Mesh_3_section_examples">Examples</a> of the package <a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Manual.tag:../Manual/" href="../Manual/packages.html#PkgMesh_3Summary">3D Mesh Generation</a>.</p>
<h1><a class="anchor" id="Periodic_3_mesh_3DesignAndImpl"></a>
Design and Implementation History</h1>
<h2><a class="anchor" id="Periodic_3_mesh_3TheoreticalFoundations"></a>
Theoretical Foundations</h2>
<p>Theoretical foundations of periodic meshes are explained in detail in the package <a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Manual.tag:../Manual/" href="../Manual/packages.html#PkgPeriodic3Triangulation3Summary">3D Periodic Triangulations</a>. For the theoretical foundations of the mesh generation process, see Section <a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Mesh_3.tag:../Mesh_3/" href="../Mesh_3/index.html#Mesh_3TheoreticalFoundations">Theoretical Foundations</a> of the package <a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Manual.tag:../Manual/" href="../Manual/packages.html#PkgMesh_3Summary">3D Mesh Generation</a>.</p>
<h2><a class="anchor" id="Periodic_3_mesh_3ImplementationHistory"></a>
Implementation History</h2>
<p>The work on this package started during the PhD thesis of Mikhail Bogdanov, advised by Monique Teillaud, which resulted in a first prototype.</p>
<p>From the beginning of 2014, most of the work was performed by Aymeric Pellé, in collaboration with Monique Teillaud. Their collaboration produced a first set of design and specifications <a class="el" href="citelist.html#CITEREF_cgal:pt-rs-14">[6]</a>.</p>
<p>This initial implementation was enhanced by Mael Rouxel-Labbé in 2017, in collaboration with Monique Teillaud, to provide a more robust implementation, integrate optimizations, handle 0- and 1-dimensional features, and publish the first version of this package. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<!-- The footer div is not part of the default but we require it to
move the footer to the bottom of the page. -->
<div id="footer">
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Mon Oct 1 2018 11:58:40 for CGAL 4.13 - 3D Periodic Mesh Generation by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen" /></a> 1.8.13 </li>
  </ul>
</div>
</div>
</body>


</html>
