<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="canonical" href="https://doc.cgal.org/latest/Mesh_3/index.html"/>

<link rel="icon" type="image/png" href="../Manual/g-196x196-doc.png" />
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8" />
<meta http-equiv="X-UA-Compatible" content="IE=9" />
<meta name="generator" content="Doxygen 1.8.13" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>CGAL 4.13 - 3D Mesh Generation: User Manual</title>
<!-- <link href="../Manual/tabs.css" rel="stylesheet" type="text/css"/> -->
<script type="text/javascript" src="../Manual/jquery.js"></script>
<script type="text/javascript" src="../Manual/dynsections.js"></script>
<!-- Manually include treeview and search to avoid bloat and to fix
     paths to the directory Manual . -->
<!-- $.treeview -->
<!-- $.search -->
<link href="navtree.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="../Manual/resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="../Manual/search/search.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="../Manual/search/searchdata.js"></script>
<script type="text/javascript" src="../Manual/search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="../Manual/search/search.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="../Manual/search/search.js"></script>
<!-- Manually done below. -->
<link href="../Manual/stylesheet.css" rel="stylesheet" type="text/css" />
<!-- This should probably be an extrastylesheet instead of hardcoded. -->
<link href="../Manual/cgal_stylesheet.css" rel="stylesheet" type="text/css" />
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js"></script>
<script src="../Manual/hacks.js" type="text/javascript"></script>
<script src="modules.js" type="text/javascript"></script>
</head>
<body>
<!-- Custom mathjax -->
<!-- TODO: Remove this with MATHJAX_CODEFILE -->
<span style="display:none">\( \newcommand{\E}{\mathrm{E}} \) \( \newcommand{\A}{\mathrm{A}} \)
\( \newcommand{\R}{\mathrm{R}} \) \( \newcommand{\N}{\mathrm{N}} \) \( \newcommand{\Q}{\mathrm{Q}} \) \( \newcommand{\Z}{\mathrm{Z}} \)
\(
\def\ccSum #1#2#3{
  \sum_{#1}^{#2}{#3}
}
\def\ccProd #1#2#3{
  \sum_{#1}^{#2}{#3}
}\)
</span>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="back-nav">
  <ul>
    <li><a href="https://www.cgal.org/">cgal.org</a></li>
    <li><a href="../Manual/index.html">Top</a></li>
    <li><a href="../Manual/general_intro.html">Getting Started</a></li>
    <li><a href="../Manual/tutorials.html">Tutorials</a></li>
    <li><a href="../Manual/packages.html">Package Overview</a></li>
    <li><a href="../Manual/how_to_cite_cgal.html">Acknowledging CGAL</a></li>
  </ul>
  <!-- In a package SEARCHENGINE = false, so we cannot use 
       insertion. That's why we have to do it manually here. Notice
       that we also take pngs from the Manual. -->
  <div id="MSearchBox" class="MSearchBoxInactive">
    <span class="left">
      <img id="MSearchSelect" src="../Manual/search/mag_sel.png" onmouseover="return searchBox.OnSearchSelectShow()" onmouseout="return searchBox.OnSearchSelectHide()" alt="" />
      <input type="text" id="MSearchField" value="Search" accesskey="S" onfocus="searchBox.OnSearchFieldFocus(true)" onblur="searchBox.OnSearchFieldFocus(false)" onkeyup="searchBox.OnSearchFieldChange(event)" />
    </span><span class="right">
      <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../Manual/search/close.png" alt="" /></a>
    </span>
  </div>
</div>
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">CGAL 4.13 - 3D Mesh Generation
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- Code below is usually inserted by doxygen when SEARCHENGINE =
     true. Notice that the path to the search directory is adjusted to
     the top-level.-->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../Manual/search",false,'Search');
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow" onmouseover="return searchBox.OnSearchSelectShow()" onmouseout="return searchBox.OnSearchSelectHide()" onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>
<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" name="MSearchResults" id="MSearchResults">
</iframe>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync" style="display: none"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('index.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">User Manual </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="Chapter_3D_Mesh_Generation"></a><a class="anchor" id="userchaptermesh3"></a></p><dl class="section author"><dt>Authors</dt><dd>Pierre Alliez, Clément Jamin, Laurent Rineau, Stéphane Tayeb, Jane Tournois, Mariette Yvinec  <div id="autotoc" class="toc"></div> </dd></dl>
<p><a class="anchor" id="fig__figuremultilabel_mesher"></a></p><div class="image">
<img src="multilabel_mesher.jpg" alt="multilabel_mesher.jpg" />
</div>
   <div class="cgal_figure_caption">  <a class="el" href="index.html#fig__figuremultilabel_mesher">Figure 55.1</a> Cut-view of a multi-domain 3D mesh generated from a segmented image.  </div>  <br />

<h1><a class="anchor" id="Mesh_3_section_intro"></a>
Introduction</h1>
<p>This package is devoted to the generation of isotropic simplicial meshes discretizing 3D domains. The domain to be meshed is a subset of 3D space, required to be bounded. The domain may be connected or composed of multiple components and/or subdivided in several subdomains.</p>
<p>Boundary and subdivision surfaces are either smooth or piecewise smooth surfaces, formed with planar or curved surface patches. Surfaces may exhibit 1-dimensional features (e.g. crease edges) and 0-dimensional features (e.g. singular points as corners tips, cusps or darts), that have to be fairly approximated in the mesh.</p>
<p>The output mesh is a 3-dimensional triangulation, including subcomplexes that approximate each input domain feature: subdomain, boundary surface patch or input domain feature with dimension 0 or 1. Thus, the output mesh includes a 3D submesh covering each subdomain, a surface mesh approximating each boundary or subdividing surface patch, a polyline approximation for each 1-dimensional feature and of course a vertex on each corner.</p>
<p>The main entry points of the package are two global functions that respectively generate and refine such meshes. The mesh generator is customized to output a mesh that fits as much as possible the user needs, for instance in terms of sizing field or with respect to some user customized quality criteria.</p>
<p>The meshing engine used in this mesh generator is based on Delaunay refinement <a class="el" href="citelist.html#CITEREF_c-gqmgc-93">[9]</a>, <a class="el" href="citelist.html#CITEREF_r-draq2d-95">[15]</a>, <a class="el" href="citelist.html#CITEREF_s-tmgdr-98">[16]</a>. It uses the notion of restricted Delaunay triangulation to approximate 1-dimensional curves and surface patches <a class="el" href="citelist.html#CITEREF_cgal:bo-pgsms-05">[2]</a>. Before the refinement, a mechanism of protecting balls is set up on 1-dimensional features, if any, to ensure a fair representation of those features in the mesh, and also to guarantee the termination of the refinement process, whatever may be the input geometry, in particular whatever small angles the boundary and subdivision surface patches may form <a class="el" href="citelist.html#CITEREF_cgal:cdl-pdma-07">[7]</a>, <a class="el" href="citelist.html#CITEREF_cgal:cdr-drpsc-07">[8]</a>. The Delaunay refinement is followed by a mesh optimization phase to remove slivers and provide a good quality mesh.</p>
<p>Optionally, the meshing and optimization algorithms support multi-core shared-memory architectures to take advantage of available parallelism.</p>
<h2><a class="anchor" id="Mesh_3InputDomain"></a>
Input Domain</h2>
<p>The domain to be meshed is assumed to be bounded and representable as a pure 3D complex. A 3D complex is a set of faces with dimension 0, 1, 2, and 3 such that all faces are pairwise interior disjoint and the boundary of each face of the complex is the union of lower-dimensional faces of the complex. The 3D complex is pure, meaning that each face is included in a face of dimension 3, so that the complex is entirely described by the set of its 3D faces and their subfaces. However the 3D complex needs not be connected. The set of faces with dimension lower or equal than 2 forms a 2D subcomplex which needs not be manifold, neither pure, nor connected: some 3D faces may have dangling 2D or 1D faces in their boundary faces.</p>
<p>In the rest of the documentation, we will refer to the input 3D complex as the input domain. The faces of the input domain with dimension 0, 1, 2, and 3 are called respectively <em>corners</em>, <em>curves</em>, <em>surface patches</em>, and <em>subdomains</em> to clearly distinguish them from the faces of the mesh that are called vertices, edges, facets, and cells.</p>
<p>Note that the input complex faces are not required to be linear nor smooth. Surface patches, for instance, may be smooth surface patches or portions of surface meshes with boundaries. Curves may be for instance straight segments, parameterized curves or polylines. Each of those features will be accurately represented in the final mesh.</p>
<p>The 0 and 1-dimensional features of the input domain are usually singular points of the subdomain boundaries, however this is not required. Furthermore, those features are not required to cover all the subdomains boundaries singularities but only those that need to be accurately represented in the final mesh. In the following, we say that a domain has <em>features</em> when it has 0 and 1-dimensional features that need to be accurately represented in the mesh, and we call those features <em>exposed features</em>. Therefore, a domain may be without features either because all boundary surface patches are smooth closed surfaces, or simply because the curves joining different surface patches and the singularities of those patches need not be accurately approximated in the final mesh.</p>
<p>Note also that input complex faces are not required to be connected. Faces of the input domain are identified by indices. If a subdomain is not connected, its different components receive the same index. Likewise different surface patches, curves, or corners may share the same index. Each connected component of a feature will be accurately represented in the final mesh. Note however that the occurrence of multiply connected faces in the input complex may affect the relevance of internal topological checks performed by the mesh generator.</p>
<p>The domain is passed to the mesh generation function as a domain class, often called the oracle, that provides predicates and constructors related to the domain, the subdomains, the boundary surface patches, and also the 0 and 1-dimensional exposed features, if any. Mainly, the oracle provides a predicate to test if a given query point belongs to the domain or not and to find in which subdomain it lies in, in the affirmative case. The domain class also provides predicates and constructors to test the intersection of a query line segment with the boundary surface patches and to construct intersection points, if any. Lastly, if the input domain includes 1-dimensional exposed features, the domain class provides a way to construct sample points on these features.</p>
<p>The current implementation provides classes to represent domains bounded by isosurfaces of implicit functions, polyhedral domains, and domains defined through 3D labeled images. Currently, 1-dimensional features may be defined as segments and polyline segments.</p>
<h2><a class="anchor" id="Mesh_3OutputMesh"></a>
Output Mesh</h2>
<p>The resulting mesh is output as a subcomplex of a <a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Triangulation_3.tag:../Triangulation_3/" href="../Triangulation_3/classCGAL_1_1Regular__triangulation__3.html">weighted Delaunay 3D triangulation</a>, in a class providing various iterators on mesh elements.</p>
<p>The 3D triangulation provides approximations of the subdomains, surface patches, curves, and corners according to the restricted Delaunay triangulation paradigm. This means that each subdomain is approximated by the union of the tetrahedral cells whose circumcenters are located inside the domain (or subdomain). Each surface patch is approximated by the union of the Delaunay mesh facets whose dual Voronoi edges intersect the surface patch. Such mesh facets are called <em>surface facets</em> in the following. The 1-dimensional exposed features are approximated by sequences of mesh edges and the 0-dimensional exposed features are represented by mesh vertices.</p>
<p>It is possible to extract the facets of the complex as a <code><a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/BGL.tag:../BGL/" href="../BGL/classFaceGraph.html">FaceGraph</a></code>, using the function <code><a class="el" href="group__PkgMesh__3Functions.html#ga68ca38989087644fb6b893eb566be9ea" title="builds a TriangleMesh from the surface facets, with a consistent orientation at the interface of two ...">facets_in_complex_3_to_triangle_mesh()</a></code>.</p>
<h2><a class="anchor" id="Mesh_3DelaunayRefinement"></a>
Delaunay Refinement</h2>
<p><a class="anchor" id="introsecparam"></a> The mesh generation algorithm is mainly a Delaunay refinement process. The Delaunay refinement is preceded by a protecting phase to ensure an accurate representation of 1-dimensional features, if any, and followed by an optimization phase to achieve a good quality mesh.</p>
<p>The Delaunay refinement process is driven by criteria concerning either the size and shape of mesh cells and surface facets. The refinement process terminates when there are no more mesh cells or surface facets violating the criteria.</p>
<p>The criteria are designed to achieve a nice spread of the mesh vertices while ensuring the termination of the refinement process. Those criteria may be somehow tuned to the user needs to achieve for instance the respect of a sizing field by mesh elements, some topological conditions on the representation of boundary surfaces in the mesh, and/or some error bound for the approximation of boundary surfaces. To some extent, the user may tune the Delaunay refinement to a prescribed trade-off between mesh quality and mesh density. The mesh density refers to the number of mesh vertices and cells, i.e. to the complexity of the mesh. The mesh quality referred to here is measured by the radius edge ratio of surface facets end mesh cells, where the radius edge ratio of a simplex (triangle or tetrahedron) is the ratio between its circumradius and its shortest edge length.</p>
<h2><a class="anchor" id="Mesh_3Protectionof0and1dimensionalExposed"></a>
Protection of 0 and 1-dimensional Exposed Features</h2>
<p>If the domain description includes 0 dimensional features, the corresponding points are inserted into the Delaunay triangulation from the start.</p>
<p>If the domain has 1-dimensional exposed features, the method of protecting balls <a class="el" href="citelist.html#CITEREF_cgal:cdl-pdma-07">[7]</a>, <a class="el" href="citelist.html#CITEREF_cgal:cdr-drpsc-07">[8]</a> is used to achieve an accurate representation of those features in the mesh and to guarantee that the refinement process terminates whatever may be the dihedral angles formed by input surface patches incident to a given 1-feature or the angles formed by two 1-features incident to a 0-feature.</p>
<p>According to this method, the 1-dimensional features are sampled with points and covered by protecting balls centered on the sample points, in such a way that:</p><ul>
<li>no three balls intersect;</li>
<li>no pair of balls centered on different 1-features intersect.</li>
</ul>
<p>The triangulation embedding the mesh is in fact a weighted Delaunay triangulation, and the triangulation is initialized by the insertion of all the protecting balls, regarded as weighted points. The Delaunay refinement process is then launched as before except that refinement points are no longer circumcenters but are weighted circumcenters. All Steiner vertices inserted by the refinement process are given a zero weight. The method guarantees:</p><ul>
<li>that each segment joining two successive centers on a 1-dimensional feature will stay in the triangulation, thus ensuring an accurate approximation of the 1-dimensional features;</li>
<li>that the refinement process will never try to insert a refinement point in the union of the protecting balls, which ensures the termination of the refinement process.</li>
</ul>
<h2><a class="anchor" id="Mesh_3OptimizationPhase"></a>
Optimization Phase</h2>
<p>Any tetrahedron that is quasi degenerate has a big radius edge ratio, except those belonging to the family of slivers. A sliver is easily obtained as the convex hull of 4 points close to the equatorial circle of a 3D ball and roughly equally spread along this circle. The Delaunay refinement tracks tetrahedra with big radius edge ratio and therefore eliminates all kinds of badly shaped tetrahedra except slivers.</p>
<p>Therefore, some sliver-shaped tetrahedra may still be present in the mesh at the end of the refinement process. The optimization phase aims to eliminate these slivers.</p>
<p>The optimization phase is a sequence of optimization processes, amongst the following available optimizers: an ODT-smoother, a Lloyd-smoother, a sliver perturber, and a sliver exuder.</p>
<p>The Lloyd and ODT-smoother are global optimizers moving the mesh vertices to minimize a mesh energy. Those optimizers are described respectively in <a class="el" href="citelist.html#CITEREF_cgal:dfg-cvtaa-99t">[11]</a>, <a class="el" href="citelist.html#CITEREF_cgal:dw-tmgob-02">[10]</a> and in <a class="el" href="citelist.html#CITEREF_cgal::c-mssbo-04">[5]</a>, <a class="el" href="citelist.html#CITEREF_cgal:acyd-vtm-05">[1]</a>. In both cases the mesh energy is the <code>L1</code> error resulting from the interpolation of the function \( f(x) =x^2\) by a piecewise linear function. In the case of the Lloyd smoother, the interpolation is linear in each Voronoi cell of the set of mesh vertices. In the case of the ODT-smoother, the interpolation is linear in each cell of the Delaunay triangulation of the mesh vertices, hence the name <code>ODT</code> which is an abbreviation for <em>Optimal Delaunay Triangulation</em>.</p>
<p><a class="anchor" id="fig__mesh_3paraboloid"></a></p><div class="image">
<img src="paraboloid.jpg" alt="paraboloid.jpg" />
</div>
   <div class="cgal_figure_caption">  <a class="el" href="index.html#fig__mesh_3paraboloid">Figure 55.2</a> The one dimensional illustration of the mesh energy minimized by ODT (left) and Lloyd (right) smoothers.  </div>  <br />

<p>The Lloyd optimizer is known to be blind to the occurrence of slivers in the mesh while the ODT-smoother tends to chase them out. Both of them are global optimizers, meaning that they try to improve the whole mesh rather than focusing on the worst elements. However, both are empirically known to be very efficient as a preliminary step of optimization as they tend to enhance the efficiency of the perturber and/or the exuder applied afterwards, see <a class="el" href="index.html#fig__figureoptimization">Figure 55.3</a></p>
<p>The perturber and the exuder focus on improving the worst mesh elements. The perturber <a class="el" href="citelist.html#CITEREF_cgal:tsa-ps3dd-09">[17]</a> improves the meshes by local changes in the vertices positions aiming to make slivers disappear. The exuder <a class="el" href="citelist.html#CITEREF_cgal:cdeft-slive-00">[6]</a> chases the remaining slivers by re-weighting mesh vertices with optimal weights.</p>
<p>Each optimization process can be activated or not, and tuned according to the user requirements and the available time. By default, only the perturber and the exuder are activated.</p>
<p>Optimization processes are designed to improve mesh quality. However, beware that such an improvement is obtained by perturbing mesh vertices and modifying the mesh connectivity which has an impact on the strict compliance to the refinement criteria. Though a strict compliance to mesh criteria is granted at the end of the Delaunay refinement, this may no longer be true after some optimization processes. Also beware that the default behavior does involve some optimization processes.</p>
<p><a class="anchor" id="fig__figureoptimization"></a></p><div class="image">
<img src="optimization.jpg" alt="optimization.jpg" />
</div>
   <div class="cgal_figure_caption">  <a class="el" href="index.html#fig__figureoptimization">Figure 55.3</a> Compared effect of a global optimizer and the perturber. The left part shows the distribution of dihedral angles of mesh cells, right after Delaunay refinement (top), after some ODT smoothing (middle) and after perturbation (bottom). The numbers under the histograms give the measure in degrees of the smallest and biggest dihedral angles in the mesh.  </div>  <br />

<h1><a class="anchor" id="Mesh_3_section_interface"></a>
Interface</h1>
<h2><a class="anchor" id="Mesh_3TheGlobalFunctions"></a>
The Global Functions</h2>
<p>A 3D mesh generation process is launched through a call to one of the two following functions:</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> C3T3, <span class="keyword">class</span> MeshDomain, <span class="keyword">class</span> MeshCriteria&gt;</div><div class="line">C3T3 <a class="code" href="group__PkgMesh__3Functions.html#ga1ee73dc372985c6aeef85f2415fac0ba">make_mesh_3</a>(<span class="keyword">const</span> MeshDomain&amp; domain,</div><div class="line">                 <span class="keyword">const</span> MeshCriteria&amp; criteria,</div><div class="line">                 parameters::internal::Features_options <a class="code" href="group__PkgMesh__3Parameters.html#ga0a990b28d55157c62d4bfd2624d408af">features</a> = <a class="code" href="group__PkgMesh__3Parameters.html#ga0a990b28d55157c62d4bfd2624d408af">parameters::features</a>(domain),</div><div class="line">                 parameters::internal::Lloyd_options <a class="code" href="group__PkgMesh__3Parameters.html#gaa7254c80bba62400f43f1e49506b975a">lloyd</a> = <a class="code" href="group__PkgMesh__3Parameters.html#ga6abfd3773eeb47d88ce6cffb91f14d2f">parameters::no_lloyd</a>(),</div><div class="line">                 parameters::internal::Odt_options <a class="code" href="group__PkgMesh__3Parameters.html#gafbecfd22651a08e6812d8a5ad9b49852">odt</a> = <a class="code" href="group__PkgMesh__3Parameters.html#ga1d041e8dbde3860cde3c20107225ecb1">parameters::no_odt</a>(),</div><div class="line">                 parameters::internal::Perturb_options <a class="code" href="group__PkgMesh__3Parameters.html#gaedf18f7f3c4647ec5fce5d67e435757a">perturb</a> = <a class="code" href="group__PkgMesh__3Parameters.html#gaedf18f7f3c4647ec5fce5d67e435757a">parameters::perturb</a>(),</div><div class="line">                 parameters::internal::Exude_options <a class="code" href="group__PkgMesh__3Parameters.html#ga16694b09a2acc8ab3f26b7d57633ccb0">exude</a> = <a class="code" href="group__PkgMesh__3Parameters.html#ga16694b09a2acc8ab3f26b7d57633ccb0">parameters::exude</a>());</div><div class="line"></div><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> C3T3, <span class="keyword">class</span> MeshDomain, <span class="keyword">class</span> MeshCriteria&gt;</div><div class="line"><span class="keywordtype">void</span> <a class="code" href="group__PkgMesh__3Functions.html#gac5a80764f9615b55c9dc60ab055e06ba">refine_mesh_3</a>(C3T3&amp; c3t3,</div><div class="line">                   <span class="keyword">const</span> MeshDomain&amp; domain,</div><div class="line">                   <span class="keyword">const</span> MeshCriteria&amp; criteria,</div><div class="line">                   parameters::internal::Lloyd_options <a class="code" href="group__PkgMesh__3Parameters.html#gaa7254c80bba62400f43f1e49506b975a">lloyd</a> = <a class="code" href="group__PkgMesh__3Parameters.html#ga6abfd3773eeb47d88ce6cffb91f14d2f">parameters::no_lloyd</a>(),</div><div class="line">                   parameters::internal::Odt_options <a class="code" href="group__PkgMesh__3Parameters.html#gafbecfd22651a08e6812d8a5ad9b49852">odt</a> = <a class="code" href="group__PkgMesh__3Parameters.html#ga1d041e8dbde3860cde3c20107225ecb1">parameters::no_odt</a>(),</div><div class="line">                   parameters::internal::Perturb_options <a class="code" href="group__PkgMesh__3Parameters.html#gaedf18f7f3c4647ec5fce5d67e435757a">perturb</a> = <a class="code" href="group__PkgMesh__3Parameters.html#gaedf18f7f3c4647ec5fce5d67e435757a">parameters::perturb</a>(),</div><div class="line">                   parameters::internal::Exude_options <a class="code" href="group__PkgMesh__3Parameters.html#ga16694b09a2acc8ab3f26b7d57633ccb0">exude</a> = <a class="code" href="group__PkgMesh__3Parameters.html#ga16694b09a2acc8ab3f26b7d57633ccb0">parameters::exude</a>());</div></div><!-- fragment --><p>The function <code><a class="el" href="group__PkgMesh__3Functions.html#ga1ee73dc372985c6aeef85f2415fac0ba" title="The function make_mesh_3() is a 3D mesh generator. ">make_mesh_3()</a></code> generates from scratch a mesh of the input domain, while the function <code><a class="el" href="group__PkgMesh__3Functions.html#gac5a80764f9615b55c9dc60ab055e06ba" title="The function refine_mesh_3() is a 3D mesh generator. ">refine_mesh_3()</a></code> refines an existing mesh of the input domain. Note that as the protection of 0 and 1-dimensional features does not rely on Delaunay refinement, the function <code><a class="el" href="group__PkgMesh__3Functions.html#gac5a80764f9615b55c9dc60ab055e06ba" title="The function refine_mesh_3() is a 3D mesh generator. ">refine_mesh_3()</a></code> has no parameter to preserve features.</p>
<p>The following sections describe the different template parameters (and their requirements) of these two global functions.</p>
<h2><a class="anchor" id="Mesh_3TheDataStructure"></a>
The Data Structure</h2>
<p>The template parameter <code>C3T3</code> is required to be a model of the concept <code><a class="el" href="classMeshComplex__3InTriangulation__3.html" title="The concept MeshComplex_3InTriangulation_3 describes a data structure to represent and maintain a 3D ...">MeshComplex_3InTriangulation_3</a></code>, a data structure devised to represent a three dimensional complex embedded in a 3D triangulation. In both functions, an instance of type <code>C3T3</code> is used to maintain the current approximating simplicial mesh and to represent the final 3D mesh at the end of the procedure.</p>
<p>The embedding 3D triangulation is required to be the nested type <code><a class="el" href="structCGAL_1_1Mesh__triangulation__3.html#a590256907c0dd141d597eaea27134d11" title="The triangulation type to be used for the 3D triangulation embedding the mesh. ">CGAL::Mesh_triangulation_3::type</a></code>, provided by the class template <code><a class="el" href="structCGAL_1_1Mesh__triangulation__3.html" title="The class Mesh_triangulation_3 is a class template which provides the triangulation type to be used f...">CGAL::Mesh_triangulation_3</a></code>. The type for this triangulation is a wrapper around the class <code><a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Triangulation_3.tag:../Triangulation_3/" href="../Triangulation_3/classCGAL_1_1Regular__triangulation__3.html">CGAL::Regular_triangulation_3</a></code> whose vertex and cell base classes are respectively models of the concepts <code><a class="el" href="classMeshVertexBase__3.html" title="The concept MeshVertexBase_3 describes the requirements for the Vertex type of the triangulation used...">MeshVertexBase_3</a></code> and <code><a class="el" href="classMeshCellBase__3.html" title="The concept MeshCellBase_3 describes the requirements for the Cell type of the triangulation used in ...">MeshCellBase_3</a></code>.</p>
<h2><a class="anchor" id="Mesh_3TheDomainOracleandtheFeaturesParameter"></a>
The Domain Oracle and the Features Parameter</h2>
<p>The template parameter <code>MeshDomain</code> is required to be a model of the concept <code><a class="el" href="classMeshDomain__3.html" title="The concept MeshDomain_3 describes the knowledge required on the object to be discretized. The concept MeshDomain_3 is the concept to be used when the input domain does not have  or -dimensional features that need to be accurately approximated by the mesh. In such a case, the queries issued by the meshing process concern only the faces of the input domain with dimension  and , that are respectively called subdomains and surface patches. ">MeshDomain_3</a></code>. The argument <code>domain</code> of type <code>MeshDomain</code> is the sole link through which the domain to be discretized is known by the mesh generation algorithm.</p>
<p>This concept provides, among others, member functions to test whether or not a query segment intersects boundary surfaces, and to compute an intersection point in the affirmative. The <code><a class="el" href="classMeshDomain__3.html" title="The concept MeshDomain_3 describes the knowledge required on the object to be discretized. The concept MeshDomain_3 is the concept to be used when the input domain does not have  or -dimensional features that need to be accurately approximated by the mesh. In such a case, the queries issued by the meshing process concern only the faces of the input domain with dimension  and , that are respectively called subdomains and surface patches. ">MeshDomain_3</a></code> concept adds member functions which given a query point tell whether the point lies inside or outside the domain and in which subdomain the point lies, if inside.</p>
<p>If the domain description includes 0 and 1-dimensional features that have to be accurately represented in the final mesh, the template parameter <code>MeshDomain</code> is required to be of a model of the concept <code><a class="el" href="classMeshDomainWithFeatures__3.html" title="The concept MeshDomainWithFeatures_3 refines the concept MeshDomain_3. While the concept MeshDomain_3...">MeshDomainWithFeatures_3</a></code>. The concept <code><a class="el" href="classMeshDomainWithFeatures__3.html" title="The concept MeshDomainWithFeatures_3 refines the concept MeshDomain_3. While the concept MeshDomain_3...">MeshDomainWithFeatures_3</a></code> mainly provides the incidence graph of 0, 1 and 2-dimensional features, and a member function to construct sample points on curves.</p>
<p>Users whose domain is a model of <code><a class="el" href="classMeshDomainWithFeatures__3.html" title="The concept MeshDomainWithFeatures_3 refines the concept MeshDomain_3. While the concept MeshDomain_3...">MeshDomainWithFeatures_3</a></code> can choose to have the corners and curves of the domain represented in the mesh or not, using the following parameters: </p><ul>
<li>
<a class="el" href="group__PkgMesh__3Parameters.html#ga0a990b28d55157c62d4bfd2624d408af"><code>parameters::features(domain)</code> </a> sets features according to the domain, i.e. 0 and 1-dimensional features are taken into account if <code>domain</code> is a <code><a class="el" href="classMeshDomainWithFeatures__3.html" title="The concept MeshDomainWithFeatures_3 refines the concept MeshDomain_3. While the concept MeshDomain_3...">MeshDomainWithFeatures_3</a></code>. </li>
<li>
<code><a class="el" href="group__PkgMesh__3Parameters.html#gaa3eb2cb65200b0331ef9d5f14b4a0535" title="The function parameters::no_features() allows the user to prevent the handling of 0 and 1-dimensional...">parameters::no_features()</a></code> prevents the representation of 0 and 1-dimensional features in the mesh. This is useful to get a smooth and rough approximation of a domain with features. </li>
</ul>
<h2><a class="anchor" id="Mesh_3TheMeshingCriteria"></a>
The Meshing Criteria</h2>
<p>The template parameter <code>MeshCriteria</code> must be a model of the concept <code><a class="el" href="classMeshCriteria__3.html" title="The Delaunay refinement process involved in the template functions make_mesh_3() and refine_mesh_3() ...">MeshCriteria_3</a></code>, or a model of the refined concept <code><a class="el" href="classMeshCriteriaWithFeatures__3.html" title="The concept MeshCriteriaWithFeatures_3 refines the concept MeshCriteria_3. The concept MeshCriteria_3...">MeshCriteriaWithFeatures_3</a></code> if the domain has exposed features. The argument of type <code>MeshCriteria</code> passed to the mesh generator specifies the size and shape requirements for the tetrahedra in the mesh and for the triangles in the boundary surface mesh. These criteria condition the rules that drive the refinement process. At the end of the refinement process, mesh elements satisfy the criteria. Note that this may not be strictly true anymore after the optimization phase, but this last phase is devised to only improve the mesh quality.</p>
<p>The criteria for surface facets are governed by the four following parameters: </p><ul>
<li>
<em><code>facet_angle</code>.</em> This parameter controls the shape of surface facets. Specifically, it is a lower bound for the angle (in degrees) of surface facets. When boundary surfaces are smooth, the termination of the meshing process is guaranteed if this angular bound is at most 30 degrees <a class="el" href="citelist.html#CITEREF_c-gqmgc-93">[9]</a>. </li>
<li>
<em><code>facet_size</code>.</em> This parameter controls the size of surface facets. Each surface facet has a surface Delaunay ball which is a ball circumscribing the surface facet and centered on the surface patch. The parameter <code>facet_size</code> is either a constant or a spatially variable scalar field, providing an upper bound for the radii of surface Delaunay balls. </li>
<li>
<em><code>facet_distance</code>.</em> This parameter controls the approximation error of boundary and subdivision surfaces. Specifically, it is either a constant or a spatially variable scalar field. It provides an upper bound for the distance between the circumcenter of a surface facet and the center of a surface Delaunay ball of this facet. </li>
<li>
<em><code>facet_topology</code>.</em> This parameters controls the set of topological constraints which have to be verified by each surface facet. By default, each vertex of a surface facet has to be located on a surface patch, on a curve, or on a corner. It can also be set to check whether the three vertices of a surface facet belongs to the same surface patch. This has to be done cautiously, as such a criterion needs that each intersection of input surface patches is an input 1-dimensional feature. </li>
</ul>
<p>The criteria for mesh cells are governed by two parameters: </p><ul>
<li>
<em><code>cell_radius_edge_ratio</code>.</em> This parameter controls the shape of mesh cells (but can't filter slivers, as we discussed earlier). It is an upper bound for the ratio between the circumradius of a mesh tetrahedron and its shortest edge. There is a theoretical bound for this parameter: the Delaunay refinement process is guaranteed to terminate for values of <code>cell_radius_edge_ratio</code> bigger than 2. </li>
<li>
<em><code>cell_size</code>.</em> This parameter controls the size of mesh tetrahedra. It is either a scalar or a spatially variable scalar field. It provides an upper bound on the circumradii of the mesh tetrahedra. </li>
</ul>
<p><a class="el" href="index.html#fig__figureparameters">Figure 55.4</a> shows how the mesh generation process behaves with respect to these parameters.</p>
<p><a class="anchor" id="fig__figureparameters"></a></p><center> <table border="0">
<tr>
<td></td><td><div class="image">
<img src="./implicit_domain.jpg" border="0" height="250px" />
</div>
   </td><td></td></tr>
<tr>
<td><div class="image">
<img src="./implicit_domain_3.jpg" border="0" height="250px" />
</div>
 </td><td><div class="image">
<img src="./implicit_domain_4.jpg" border="0" height="250px" />
</div>
 </td><td><div class="image">
<img src="./implicit_domain_5.jpg" border="0" height="250px" />
</div>
  </td></tr>
</table>
</center><p>  </p><div class="cgal_figure_caption">  <a class="el" href="index.html#fig__figureparameters">Figure 55.4</a> Top: the mesh is obtained using the parameters \( (25,0.15,0.05)\) for the angular bound, radius bound and distance bound of surface facets and \( (4,0.2) \) for the radius-edge bound and radius bound of mesh cells. The result is a uniform mesh which contains tetrahedra of about the same size. Bottom left : the mesh is obtained by relaxing the <em> size bound</em> of tetrahedra and facets. The result is a small coarse mesh. Bottom middle : the mesh is obtained from the previous one by tightening the <em>distance bound</em> of surface facets to \( 0.01\). The result is then a graded 3D mesh with a dense surface mesh achieving a precise approximation. Bottom right : the mesh is obtained from the previous one by fixing <em>radius bound</em> of surface facets to \( 0.01\). The surface mesh is then denser to achieve the size bound.  </div>  <br />

<p>If the domain has 1-dimensional exposed features, the <code>criteria</code> includes a sizing field to guide the sampling of 1-dimensional features with protecting balls centers. </p><ul>
<li>
<em><code>edge_size</code></em>. This constant or variable scalar field is used as an upper bound for the distance between two protecting ball centers that are consecutive on a 1-feature. This parameter has to be set to a positive value when 1-dimensional features protection is used. </li>
</ul>
<h2><a class="anchor" id="Mesh_3TheOptimizationParameters"></a>
The Optimization Parameters</h2>
<p>The four additional parameters are optimization parameters. They control which optimization processes are performed and allow the user to tune the parameters of the activated optimization processes. These parameters have internal types which are not described but the library provides global functions to generate appropriate values of these types: </p><ul>
<li>
<code><a class="el" href="group__PkgMesh__3Parameters.html#gaa7254c80bba62400f43f1e49506b975a" title="The function parameters::lloyd() allows the user to trigger a call of lloyd_optimize_mesh_3() in the ...">parameters::lloyd()</a></code> and <code><a class="el" href="group__PkgMesh__3Parameters.html#ga6abfd3773eeb47d88ce6cffb91f14d2f" title="The function parameters::no_lloyd() allows the user to tell the mesh generation functions make_mesh_3...">parameters::no_lloyd()</a></code> activate and deactivate the Lloyd smoother. </li>
<li>
<code><a class="el" href="group__PkgMesh__3Parameters.html#gafbecfd22651a08e6812d8a5ad9b49852" title="The function parameters::odt() allows the user to trigger a call to CGAL::odt_optimize_mesh_3() in CG...">parameters::odt()</a></code> and <code><a class="el" href="group__PkgMesh__3Parameters.html#ga1d041e8dbde3860cde3c20107225ecb1" title="The function parameters::no_odt() allows the user to tell the mesh generation functions make_mesh_3()...">parameters::no_odt()</a></code> activate and deactivate the ODT-smoother. </li>
<li>
<code><a class="el" href="group__PkgMesh__3Parameters.html#gaedf18f7f3c4647ec5fce5d67e435757a" title="The function parameters::perturb() allows the user to trigger a call to perturb_mesh_3() in make_mesh...">parameters::perturb()</a></code> and <code><a class="el" href="group__PkgMesh__3Parameters.html#ga5714d10decd9eecd30997572b785e03b" title="The function parameters::no_perturb() allows the user to tell mesh generation global functions make_m...">parameters::no_perturb()</a></code> activate and deactivate the perturber. </li>
<li>
<code><a class="el" href="group__PkgMesh__3Parameters.html#ga16694b09a2acc8ab3f26b7d57633ccb0" title="The function parameters::exude() allows the user to trigger a call to exude_mesh_3() in the make_mesh...">parameters::exude()</a></code> and <code><a class="el" href="group__PkgMesh__3Parameters.html#ga0b79c473082a4ec2a45ed1497f3ac873" title="The function parameters::no_exude() allows the user to tell the mesh generation functions make_mesh_3...">parameters::no_exude()</a></code> activate and deactivate the exuder. </li>
</ul>
<p>These parameters are optional and can be passed in any order. If one parameter is not passed the default value is used. By default, only the perturber and the exuder are activated. Note that whatever may be the optimization processes activated by <code><a class="el" href="group__PkgMesh__3Functions.html#ga1ee73dc372985c6aeef85f2415fac0ba" title="The function make_mesh_3() is a 3D mesh generator. ">make_mesh_3()</a></code> or <code><a class="el" href="group__PkgMesh__3Functions.html#gac5a80764f9615b55c9dc60ab055e06ba" title="The function refine_mesh_3() is a 3D mesh generator. ">refine_mesh_3()</a></code>, they are always launched in the order that is a suborder of the following: <em>ODT-smoother</em>, <em>Lloyd-smoother</em>, <em>perturber</em>, and <em>exuder</em>.</p>
<p>The package also provides four global functions to launch each optimization process independently. These functions are useful for advanced experimentation on the efficiency of each optimization method. Note however that the exuder adds on mesh vertices weights that are conditioned by vertices positions. Therefore an exudation process should never be run before a smoother or a perturber. For a maximum efficiency, whatever may be the optimization processes activated, they should be launched in the order that is a suborder of the following: <em>ODT-smoother</em>, <em>Lloyd-smoother</em>, <em>perturber</em>, and <em>exuder</em>.</p>
<div class="fragment"><div class="line"><span class="keyword">template</span>&lt; <span class="keyword">class</span> C3T3, <span class="keyword">class</span> MeshDomain &gt;</div><div class="line"><a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Mesh_2.tag:../Mesh_2/" href="../Mesh_2/group__PkgMesh2Enum.html#gab9fe60482a45120b3c061a8a4ec9018d">Mesh_optimization_return_code</a> <a class="code" href="group__PkgMesh__3Functions.html#gaa3a279f64022f2bc51935f946dd8a50e">lloyd_optimize_mesh_3</a>(C3T3&amp; c3t3, <span class="keyword">const</span> MeshDomain&amp; domain);</div><div class="line"></div><div class="line"><span class="keyword">template</span>&lt; <span class="keyword">class</span> C3T3, <span class="keyword">class</span> MeshDomain &gt;</div><div class="line"><a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Mesh_2.tag:../Mesh_2/" href="../Mesh_2/group__PkgMesh2Enum.html#gab9fe60482a45120b3c061a8a4ec9018d">Mesh_optimization_return_code</a> <a class="code" href="group__PkgMesh__3Functions.html#ga66300c76c2400ed4c847db71ab9c7906">odt_optimize_mesh_3</a>(C3T3&amp; c3t3, <span class="keyword">const</span> MeshDomain&amp; domain);</div><div class="line"></div><div class="line"><span class="keyword">template</span>&lt; <span class="keyword">class</span> C3T3, <span class="keyword">class</span> MeshDomain &gt;</div><div class="line"><a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Mesh_2.tag:../Mesh_2/" href="../Mesh_2/group__PkgMesh2Enum.html#gab9fe60482a45120b3c061a8a4ec9018d">Mesh_optimization_return_code</a> <a class="code" href="group__PkgMesh__3Functions.html#ga1663c4db53ad4fd91c889be96576842a">perturb_mesh_3</a>(C3T3&amp; c3t3, <span class="keyword">const</span> MeshDomain&amp; domain);</div><div class="line"></div><div class="line"><span class="keyword">template</span>&lt; <span class="keyword">class</span> C3T3 &gt;</div><div class="line"><a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Mesh_2.tag:../Mesh_2/" href="../Mesh_2/group__PkgMesh2Enum.html#gab9fe60482a45120b3c061a8a4ec9018d">Mesh_optimization_return_code</a> <a class="code" href="group__PkgMesh__3Functions.html#gabf09a95838226da018a742a631824af9">exude_mesh_3</a>(C3T3&amp; c3t3);</div></div><!-- fragment --><p>Note that the global functions activating the optimization processes or launching those processes have themselves parameters (see details in reference pages) to tune the optimization process.</p>
<h2><a class="anchor" id="Mesh_3ParallelAlgorithms"></a>
Parallel Algorithms</h2>
<p>Enabling parallel meshing and optimization algorithms is achieved through setting the third template parameter of the <code><a class="el" href="structCGAL_1_1Mesh__triangulation__3.html" title="The class Mesh_triangulation_3 is a class template which provides the triangulation type to be used f...">Mesh_triangulation_3</a></code> class to <code><a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/STL_Extension.tag:../STL_Extension/" href="../STL_Extension/structCGAL_1_1Parallel__tag.html">Parallel_tag</a></code>, when defining the triangulation type. Note that when the user provides his/her own vertex and cell base classes, the <code><a class="el" href="classMeshVertexBase__3.html" title="The concept MeshVertexBase_3 describes the requirements for the Vertex type of the triangulation used...">MeshVertexBase_3</a></code> and <code><a class="el" href="classMeshCellBase__3.html" title="The concept MeshCellBase_3 describes the requirements for the Cell type of the triangulation used in ...">MeshCellBase_3</a></code> concepts impose additional requirements.</p>
<p>Parallel algorithms require the executable to be linked against the <a href="http://www.threadingbuildingblocks.org">Intel TBB library</a>. To control the number of threads used, the user may use the tbb::task_scheduler_init class. See the <a href="http://www.threadingbuildingblocks.org/documentation">TBB documentation</a> for more details.</p>
<h1><a class="anchor" id="Mesh_3_section_examples"></a>
Examples</h1>
<h2><a class="anchor" id="Mesh_33DDomainsBoundedbyIsosurfaces"></a>
3D Domains Bounded by Isosurfaces</h2>
<h3><a class="anchor" id="Mesh_33DDomainsImplicitIsosurfaces"></a>
3D Domains Bounded by Implicit Isosurfaces</h3>
<p>The following code produces a 3D mesh for a domain whose boundary surface is an isosurface defined by an implicit function. <a class="el" href="index.html#fig__figureimplicit_domain">Figure 55.5</a> shows a cut view of the resulting mesh.</p>
<p>Note the use of named parameters (from Boost library) in the constructor of the <code>Mesh_criteria</code> instance.</p>
<p><br />
<b>File</b> <a class="el" href="Mesh_3_2mesh_implicit_sphere_8cpp-example.html">Mesh_3/mesh_implicit_sphere.cpp</a> </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;CGAL/Exact_predicates_inexact_constructions_kernel.h&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Mesh_triangulation_3.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Mesh_complex_3_in_triangulation_3.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Mesh_criteria_3.h&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Labeled_mesh_domain_3.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/make_mesh_3.h&gt;</span></div><div class="line"></div><div class="line"><span class="comment">// Domain</span></div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Kernel_23.tag:../Kernel_23/" href="../Kernel_23/classCGAL_1_1Exact__predicates__inexact__constructions__kernel.html">CGAL::Exact_predicates_inexact_constructions_kernel</a> K;</div><div class="line"><span class="keyword">typedef</span> K::FT FT;</div><div class="line"><span class="keyword">typedef</span> K::Point_3 Point;</div><div class="line"><span class="keyword">typedef</span> FT (Function)(<span class="keyword">const</span> Point&amp;);</div><div class="line"><span class="keyword">typedef</span> <a class="code" href="classCGAL_1_1Labeled__mesh__domain__3.html">CGAL::Labeled_mesh_domain_3&lt;K&gt;</a> Mesh_domain;</div><div class="line"></div><div class="line"><span class="preprocessor">#ifdef CGAL_CONCURRENT_MESH_3</span></div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/STL_Extension.tag:../STL_Extension/" href="../STL_Extension/structCGAL_1_1Parallel__tag.html">CGAL::Parallel_tag</a> Concurrency_tag;</div><div class="line"><span class="preprocessor">#else</span></div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/STL_Extension.tag:../STL_Extension/" href="../STL_Extension/structCGAL_1_1Sequential__tag.html">CGAL::Sequential_tag</a> Concurrency_tag;</div><div class="line"><span class="preprocessor">#endif</span></div><div class="line"></div><div class="line"><span class="comment">// Triangulation</span></div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Manual.tag:../Manual/" href="../Manual/classunspecified__type.html">CGAL::Mesh_triangulation_3&lt;Mesh_domain,CGAL::Default,Concurrency_tag&gt;::type</a> Tr;</div><div class="line"></div><div class="line"><span class="keyword">typedef</span> <a class="code" href="classCGAL_1_1Mesh__complex__3__in__triangulation__3.html">CGAL::Mesh_complex_3_in_triangulation_3&lt;Tr&gt;</a> C3t3;</div><div class="line"></div><div class="line"><span class="comment">// Criteria</span></div><div class="line"><span class="keyword">typedef</span> <a class="code" href="classCGAL_1_1Mesh__criteria__3.html">CGAL::Mesh_criteria_3&lt;Tr&gt;</a> Mesh_criteria;</div><div class="line"></div><div class="line"><span class="comment">// To avoid verbose function and named parameters call</span></div><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespaceCGAL_1_1parameters.html">CGAL::parameters</a>;</div><div class="line"></div><div class="line"><span class="comment">// Function</span></div><div class="line">FT sphere_function (<span class="keyword">const</span> Point&amp; p)</div><div class="line">{ <span class="keywordflow">return</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Kernel_23.tag:../Kernel_23/" href="../Kernel_23/group__squared__distance__grp.html#ga1ff73525660a052564d33fbdd61a4f71">CGAL::squared_distance</a>(p, Point(<a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Kernel_23.tag:../Kernel_23/" href="../Kernel_23/group__kernel__enums.html#ga9d272a8e3a8080b851741b6d3a44afdc">CGAL::ORIGIN</a>))-1; }</div><div class="line"></div><div class="line"><span class="keywordtype">int</span> main()</div><div class="line">{</div><div class="line">  Mesh_domain domain =</div><div class="line">    Mesh_domain::create_implicit_mesh_domain(sphere_function,</div><div class="line">                                             K::Sphere_3(<a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Kernel_23.tag:../Kernel_23/" href="../Kernel_23/group__kernel__enums.html#ga9d272a8e3a8080b851741b6d3a44afdc">CGAL::ORIGIN</a>, 2.));</div><div class="line"></div><div class="line">  <span class="comment">// Mesh criteria</span></div><div class="line">  Mesh_criteria criteria(facet_angle=30, facet_size=0.1, facet_distance=0.025,</div><div class="line">                         cell_radius_edge_ratio=2, cell_size=0.1);</div><div class="line">  </div><div class="line">  <span class="comment">// Mesh generation</span></div><div class="line">  C3t3 c3t3 = CGAL::make_mesh_3&lt;C3t3&gt;(domain, criteria);</div><div class="line"></div><div class="line">  <span class="comment">// Output</span></div><div class="line">  std::ofstream medit_file(<span class="stringliteral">"out.mesh"</span>);</div><div class="line">  c3t3.output_to_medit(medit_file);</div><div class="line"></div><div class="line">  <span class="keywordflow">return</span> 0;</div><div class="line">}</div><div class="line"></div></div><!-- fragment --><p><a class="anchor" id="fig__figureimplicit_domain"></a></p><div class="image">
<img src="implicit_domain.jpg" alt="implicit_domain.jpg" />
</div>
   <div class="cgal_figure_caption">  <a class="el" href="index.html#fig__figureimplicit_domain">Figure 55.5</a> Cut view of a 3D mesh produced from an implicit domain  </div>  <br />

<h3><a class="anchor" id="Mesh_33DDomainsGrayImageIsosurfaces"></a>
3D Domains Bounded by Isosurfaces in 3D Gray-Level Images</h3>
<p>The following example produces a 3D mesh for a domain whose boundary surface is the isosurface associated to an isovalue inside the input gray-level 3D image. In the distribution you can also find the example <a class="el" href="Mesh_3_2mesh_3D_gray_vtk_image_8cpp-example.html">Mesh_3/mesh_3D_gray_vtk_image.cpp</a> which can deal with DICOM files as input.</p>
<p><br />
<b>File</b> <a class="el" href="Mesh_3_2mesh_3D_gray_image_8cpp-example.html">Mesh_3/mesh_3D_gray_image.cpp</a> </p><div class="fragment"><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Exact_predicates_inexact_constructions_kernel.h&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Mesh_triangulation_3.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Mesh_complex_3_in_triangulation_3.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Mesh_criteria_3.h&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Labeled_mesh_domain_3.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/make_mesh_3.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Image_3.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;functional&gt;</span></div><div class="line"></div><div class="line"><span class="keyword">typedef</span> <span class="keywordtype">float</span> Image_word_type;</div><div class="line"></div><div class="line"><span class="comment">// Domain</span></div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Kernel_23.tag:../Kernel_23/" href="../Kernel_23/classCGAL_1_1Exact__predicates__inexact__constructions__kernel.html">CGAL::Exact_predicates_inexact_constructions_kernel</a> K;</div><div class="line"><span class="keyword">typedef</span> <a class="code" href="classCGAL_1_1Labeled__mesh__domain__3.html">CGAL::Labeled_mesh_domain_3&lt;K&gt;</a> Mesh_domain;</div><div class="line"></div><div class="line"><span class="comment">// Triangulation</span></div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Manual.tag:../Manual/" href="../Manual/classunspecified__type.html">CGAL::Mesh_triangulation_3&lt;Mesh_domain&gt;::type</a> Tr;</div><div class="line"><span class="keyword">typedef</span> <a class="code" href="classCGAL_1_1Mesh__complex__3__in__triangulation__3.html">CGAL::Mesh_complex_3_in_triangulation_3&lt;Tr&gt;</a> C3t3;</div><div class="line"></div><div class="line"><span class="comment">// Criteria</span></div><div class="line"><span class="keyword">typedef</span> <a class="code" href="classCGAL_1_1Mesh__criteria__3.html">CGAL::Mesh_criteria_3&lt;Tr&gt;</a> Mesh_criteria;</div><div class="line"></div><div class="line"><span class="comment">// To avoid verbose function and named parameters call</span></div><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespaceCGAL_1_1parameters.html">CGAL::parameters</a>;</div><div class="line"></div><div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>*argv[])</div><div class="line">{</div><div class="line">  <span class="keyword">const</span> <span class="keywordtype">char</span>* fname = (argc&gt;1)?argv[1]:<span class="stringliteral">"data/skull_2.9.inr"</span>;</div><div class="line">  <span class="comment">// Load image</span></div><div class="line">  <a class="code" href="classCGAL_1_1Image__3.html">CGAL::Image_3</a> image;</div><div class="line">  <span class="keywordflow">if</span>(!image.<a class="code" href="classCGAL_1_1Image__3.html#a6be029d7a0ee6dbd5eab1fd0adae42ba">read</a>(fname)){</div><div class="line">    std::cerr &lt;&lt; <span class="stringliteral">"Error: Cannot read file "</span> &lt;&lt;  fname &lt;&lt; std::endl;</div><div class="line">    <span class="keywordflow">return</span> EXIT_FAILURE;</div><div class="line">  }</div><div class="line">  Mesh_domain domain =</div><div class="line">    Mesh_domain::create_gray_image_mesh_domain(image, 2.9f, 0.f);</div><div class="line"></div><div class="line">  <span class="comment">// Mesh criteria</span></div><div class="line">  Mesh_criteria criteria(facet_angle=30, facet_size=6, facet_distance=2,</div><div class="line">                         cell_radius_edge_ratio=3, cell_size=8);</div><div class="line"></div><div class="line">  <span class="comment">// Meshing</span></div><div class="line">  C3t3 c3t3 = CGAL::make_mesh_3&lt;C3t3&gt;(domain, criteria);</div><div class="line"></div><div class="line">  <span class="comment">// Output</span></div><div class="line">  std::ofstream medit_file(<span class="stringliteral">"out.mesh"</span>);</div><div class="line">  c3t3.output_to_medit(medit_file);</div><div class="line"></div><div class="line">  <span class="keywordflow">return</span> 0;</div><div class="line">}</div></div><!-- fragment --><h2><a class="anchor" id="Mesh_3MeshingMultipleDomains"></a>
Meshing Multiple Domains</h2>
<p><a class="anchor" id="Mesh_3_subsection_examples_multi_domain"></a> </p>
<h3><a class="anchor" id="Mesh_3MeshingMultipleDomains_1"></a>
Construction from a Vector of Implicit Functions</h3>
<p>The following code produces a 3D mesh for a domain consisting of several subdomains. It uses <code><a class="el" href="classCGAL_1_1Implicit__multi__domain__to__labeling__function__wrapper.html" title="The class Implicit_multi_domain_to_labeling_function_wrapper is a helping class to get a function wit...">Implicit_multi_domain_to_labeling_function_wrapper</a></code> as model of <code><a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Surface_mesher.tag:../Surface_mesher/" href="../Surface_mesher/classImplicitFunction.html">ImplicitFunction</a></code> which is required by <code><a class="el" href="classCGAL_1_1Labeled__mesh__domain__3.html" title="The class Labeled_mesh_domain_3 implements indexed domains. ">Labeled_mesh_domain_3</a></code>.</p>
<p><a class="el" href="index.html#fig__figuremulti_domain">Figure 55.6</a> shows a view and a cut view of the resulting mesh.</p>
<p><br />
<b>File</b> <a class="el" href="Mesh_3_2mesh_implicit_domains_8cpp-example.html">Mesh_3/mesh_implicit_domains.cpp</a> </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;CGAL/Exact_predicates_inexact_constructions_kernel.h&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Mesh_triangulation_3.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Mesh_complex_3_in_triangulation_3.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Mesh_criteria_3.h&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Implicit_to_labeling_function_wrapper.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Labeled_mesh_domain_3.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/make_mesh_3.h&gt;</span></div><div class="line"><span class="preprocessor">#include "implicit_functions.h"</span></div><div class="line"></div><div class="line"><span class="comment">// IO</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/IO/File_medit.h&gt;</span></div><div class="line"></div><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespaceCGAL_1_1parameters.html">CGAL::parameters</a>;</div><div class="line"></div><div class="line"><span class="comment">// Domain</span></div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Kernel_23.tag:../Kernel_23/" href="../Kernel_23/classCGAL_1_1Exact__predicates__inexact__constructions__kernel.html">CGAL::Exact_predicates_inexact_constructions_kernel</a> K;</div><div class="line"><span class="keyword">typedef</span> FT_to_point_function_wrapper&lt;K::FT, K::Point_3&gt; Function;</div><div class="line"><span class="keyword">typedef</span> <a class="code" href="classCGAL_1_1Implicit__multi__domain__to__labeling__function__wrapper.html">CGAL::Implicit_multi_domain_to_labeling_function_wrapper&lt;Function&gt;</a></div><div class="line">                                                        Function_wrapper;</div><div class="line"><span class="keyword">typedef</span> Function_wrapper::Function_vector Function_vector;</div><div class="line"><span class="keyword">typedef</span> <a class="code" href="classCGAL_1_1Labeled__mesh__domain__3.html">CGAL::Labeled_mesh_domain_3&lt;K&gt;</a> Mesh_domain;</div><div class="line"></div><div class="line"><span class="comment">// Triangulation</span></div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Manual.tag:../Manual/" href="../Manual/classunspecified__type.html">CGAL::Mesh_triangulation_3&lt;Mesh_domain&gt;::type</a> Tr;</div><div class="line"><span class="keyword">typedef</span> <a class="code" href="classCGAL_1_1Mesh__complex__3__in__triangulation__3.html">CGAL::Mesh_complex_3_in_triangulation_3&lt;Tr&gt;</a> C3t3;</div><div class="line"></div><div class="line"><span class="comment">// Mesh Criteria</span></div><div class="line"><span class="keyword">typedef</span> <a class="code" href="classCGAL_1_1Mesh__criteria__3.html">CGAL::Mesh_criteria_3&lt;Tr&gt;</a> Mesh_criteria;</div><div class="line"><span class="keyword">typedef</span> Mesh_criteria::Facet_criteria    Facet_criteria;</div><div class="line"><span class="keyword">typedef</span> Mesh_criteria::Cell_criteria     Cell_criteria;</div><div class="line"></div><div class="line"></div><div class="line"><span class="keywordtype">int</span> main()</div><div class="line">{</div><div class="line">  <span class="comment">// Define functions</span></div><div class="line">  Function f1(&amp;torus_function);</div><div class="line">  Function f2(&amp;sphere_function&lt;3&gt;);</div><div class="line"></div><div class="line">  Function_vector v;</div><div class="line">  v.push_back(f1);</div><div class="line">  v.push_back(f2);</div><div class="line"></div><div class="line">  <span class="comment">// Domain (Warning: Sphere_3 constructor uses square radius !)</span></div><div class="line">  Mesh_domain domain(Function_wrapper(v), K::Sphere_3(<a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Kernel_23.tag:../Kernel_23/" href="../Kernel_23/group__kernel__enums.html#ga9d272a8e3a8080b851741b6d3a44afdc">CGAL::ORIGIN</a>, 5.*5.), 1e-6);</div><div class="line"></div><div class="line">  <span class="comment">// Set mesh criteria</span></div><div class="line">  Facet_criteria facet_criteria(30, 0.2, 0.02); <span class="comment">// angle, size, approximation</span></div><div class="line">  Cell_criteria cell_criteria(2., 0.4); <span class="comment">// radius-edge ratio, size</span></div><div class="line">  Mesh_criteria criteria(facet_criteria, cell_criteria);</div><div class="line"></div><div class="line">  <span class="comment">// Mesh generation</span></div><div class="line">  C3t3 c3t3 = CGAL::make_mesh_3&lt;C3t3&gt;(domain, criteria, <a class="code" href="group__PkgMesh__3Parameters.html#ga0b79c473082a4ec2a45ed1497f3ac873">no_exude</a>(), <a class="code" href="group__PkgMesh__3Parameters.html#ga5714d10decd9eecd30997572b785e03b">no_perturb</a>());</div><div class="line"></div><div class="line">  <span class="comment">// Perturbation (maximum cpu time: 10s, targeted dihedral angle: default)</span></div><div class="line">  <a class="code" href="group__PkgMesh__3Functions.html#ga1663c4db53ad4fd91c889be96576842a">CGAL::perturb_mesh_3</a>(c3t3, domain, time_limit = 10);</div><div class="line">  </div><div class="line">  <span class="comment">// Exudation</span></div><div class="line">  <a class="code" href="group__PkgMesh__3Functions.html#gabf09a95838226da018a742a631824af9">CGAL::exude_mesh_3</a>(c3t3,12);</div><div class="line">  </div><div class="line">  <span class="comment">// Output</span></div><div class="line">  std::ofstream medit_file(<span class="stringliteral">"out.mesh"</span>);</div><div class="line">  <a class="code" href="group__PkgMesh__3IOFunctions.html#ga2bae1cee3b149f4e9092195a1cd07232">CGAL::output_to_medit</a>(medit_file, c3t3);</div><div class="line"></div><div class="line">  <span class="keywordflow">return</span> 0;</div><div class="line">}</div></div><!-- fragment --><p> <a class="anchor" id="fig__figuremulti_domain"></a></p><center> <table border="0">
<tr>
<td><div class="image">
<img src="multi_domain.jpg" alt="multi_domain.jpg" />
</div>
   </td><td><div class="image">
<img src="multi_domain_cut.jpg" alt="multi_domain_cut.jpg" />
</div>
    </td></tr>
</table>
</center><p> </p><div class="cgal_figure_caption">   <a class="el" href="index.html#fig__figuremulti_domain">Figure 55.6</a> View (left) and cut view (right) of a 3D mesh of a torus intersecting sphere.  </div>  <br />

<h3><a class="anchor" id="Mesh_3MeshingMultipleDomains_2"></a>
Construction from a Vector of Implicit Functions and a Vector of Strings</h3>
<p>The following code produces a 3D mesh for a domain consisting of several subdomains too. Here, the set of subdomains is given by a vector of vector of signs, whereas the set was built automatically in the previous example. Each subdomain corresponds to a sign vector [s1, s2, ..., sn] where si is the sign of the function fi(p) at a point p of the subdomain.</p>
<p><a class="el" href="index.html#fig__figuremulti_domain2">Figure 55.7</a> shows a view of the resulting mesh.</p>
<p><br />
<b>File</b> <a class="el" href="Mesh_3_2mesh_implicit_domains_2_8cpp-example.html">Mesh_3/mesh_implicit_domains_2.cpp</a> </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;CGAL/Exact_predicates_inexact_constructions_kernel.h&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Mesh_triangulation_3.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Mesh_complex_3_in_triangulation_3.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Mesh_criteria_3.h&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Implicit_to_labeling_function_wrapper.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Labeled_mesh_domain_3.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/make_mesh_3.h&gt;</span></div><div class="line"><span class="preprocessor">#include "implicit_functions.h"</span></div><div class="line"></div><div class="line"><span class="comment">// IO</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/IO/File_medit.h&gt;</span></div><div class="line"></div><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespaceCGAL_1_1parameters.html">CGAL::parameters</a>;</div><div class="line"></div><div class="line"><span class="comment">// Domain</span></div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Kernel_23.tag:../Kernel_23/" href="../Kernel_23/classCGAL_1_1Exact__predicates__inexact__constructions__kernel.html">CGAL::Exact_predicates_inexact_constructions_kernel</a> K;</div><div class="line"><span class="keyword">typedef</span> FT_to_point_function_wrapper&lt;K::FT, K::Point_3&gt; Function;</div><div class="line"><span class="keyword">typedef</span> <a class="code" href="classCGAL_1_1Implicit__multi__domain__to__labeling__function__wrapper.html">CGAL::Implicit_multi_domain_to_labeling_function_wrapper&lt;Function&gt;</a></div><div class="line">                                                        Function_wrapper;</div><div class="line"><span class="keyword">typedef</span> Function_wrapper::Function_vector Function_vector;</div><div class="line"><span class="keyword">typedef</span> <a class="code" href="classCGAL_1_1Labeled__mesh__domain__3.html">CGAL::Labeled_mesh_domain_3&lt;K&gt;</a> Mesh_domain;</div><div class="line"></div><div class="line"><span class="comment">// Triangulation</span></div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Manual.tag:../Manual/" href="../Manual/classunspecified__type.html">CGAL::Mesh_triangulation_3&lt;Mesh_domain&gt;::type</a> Tr;</div><div class="line"><span class="keyword">typedef</span> <a class="code" href="classCGAL_1_1Mesh__complex__3__in__triangulation__3.html">CGAL::Mesh_complex_3_in_triangulation_3&lt;Tr&gt;</a> C3t3;</div><div class="line"></div><div class="line"><span class="comment">// Mesh Criteria</span></div><div class="line"><span class="keyword">typedef</span> <a class="code" href="classCGAL_1_1Mesh__criteria__3.html">CGAL::Mesh_criteria_3&lt;Tr&gt;</a> Mesh_criteria;</div><div class="line"><span class="keyword">typedef</span> Mesh_criteria::Facet_criteria    Facet_criteria;</div><div class="line"><span class="keyword">typedef</span> Mesh_criteria::Cell_criteria     Cell_criteria;</div><div class="line"></div><div class="line"></div><div class="line"><span class="keywordtype">int</span> main()</div><div class="line">{</div><div class="line">  <span class="comment">// Define functions</span></div><div class="line">  Function f1(&amp;torus_function);</div><div class="line">  Function f2(&amp;sphere_function&lt;3&gt;);</div><div class="line"></div><div class="line">  Function_vector v;</div><div class="line">  v.push_back(f1);</div><div class="line">  v.push_back(f2);</div><div class="line"></div><div class="line">  std::vector&lt;std::string&gt; vps;</div><div class="line">  vps.push_back(<span class="stringliteral">"+-"</span>);</div><div class="line"></div><div class="line">  <span class="keyword">namespace </span>param = <a class="code" href="namespaceCGAL_1_1parameters.html">CGAL::parameters</a>;</div><div class="line">  Mesh_domain domain(param::function = Function_wrapper(v, vps),</div><div class="line">                     param::bounding_object = K::Sphere_3(<a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Kernel_23.tag:../Kernel_23/" href="../Kernel_23/group__kernel__enums.html#ga9d272a8e3a8080b851741b6d3a44afdc">CGAL::ORIGIN</a>,</div><div class="line">                                                          5.*5.),</div><div class="line">                     param::relative_error_bound = 1e-6);</div><div class="line"></div><div class="line">  <span class="comment">// Set mesh criteria</span></div><div class="line">  Facet_criteria facet_criteria(30, 0.2, 0.02); <span class="comment">// angle, size, approximation</span></div><div class="line">  Cell_criteria cell_criteria(2., 0.4); <span class="comment">// radius-edge ratio, size</span></div><div class="line">  Mesh_criteria criteria(facet_criteria, cell_criteria);</div><div class="line"></div><div class="line">  <span class="comment">// Mesh generation</span></div><div class="line">  C3t3 c3t3 = CGAL::make_mesh_3&lt;C3t3&gt;(domain, criteria, <a class="code" href="group__PkgMesh__3Parameters.html#ga0b79c473082a4ec2a45ed1497f3ac873">no_exude</a>(), <a class="code" href="group__PkgMesh__3Parameters.html#ga5714d10decd9eecd30997572b785e03b">no_perturb</a>());</div><div class="line"></div><div class="line">  <span class="comment">// Perturbation (maximum cpu time: 10s, targeted dihedral angle: default)</span></div><div class="line">  <a class="code" href="group__PkgMesh__3Functions.html#ga1663c4db53ad4fd91c889be96576842a">CGAL::perturb_mesh_3</a>(c3t3, domain, time_limit = 10);</div><div class="line">  </div><div class="line">  <span class="comment">// Exudation</span></div><div class="line">  <a class="code" href="group__PkgMesh__3Functions.html#gabf09a95838226da018a742a631824af9">CGAL::exude_mesh_3</a>(c3t3,12);</div><div class="line">  </div><div class="line">  <span class="comment">// Output</span></div><div class="line">  std::ofstream medit_file(<span class="stringliteral">"out.mesh"</span>);</div><div class="line">  <a class="code" href="group__PkgMesh__3IOFunctions.html#ga2bae1cee3b149f4e9092195a1cd07232">CGAL::output_to_medit</a>(medit_file, c3t3);</div><div class="line"></div><div class="line">  <span class="keywordflow">return</span> 0;</div><div class="line">}</div></div><!-- fragment --><p> <a class="anchor" id="fig__figuremulti_domain2"></a></p><div class="image">
<img src="multi_domain_2.jpg" alt="multi_domain_2.jpg" />
</div>
   <div class="cgal_figure_caption">  <a class="el" href="index.html#fig__figuremulti_domain2">Figure 55.7</a> View of a 3D mesh of the relative complement of a torus in a sphere.  </div>  <br />

<h3><a class="anchor" id="Mesh_3MeshingMultipleDomains_3"></a>
Construction of a Hybrid Domain : From an Implicit and a Polyhedral Domain</h3>
<p>The example code of <a class="el" href="Mesh_3_2mesh_hybrid_mesh_domain_8cpp-example.html">Mesh_3/mesh_hybrid_mesh_domain.cpp</a> produces a 3D mesh for a domain consisting of several subdomains too. Here, the set of subdomains is given by two subdomains of different types : a domain defined by an implicit sphere, and a domain defined by the triangulated surface of a cube.</p>
<p><a class="el" href="index.html#fig__mesh3HybridDomainExample">Figure 55.8</a> shows the results with or without the protection of the 1D-features.</p>
<p><a class="anchor" id="fig__mesh3HybridDomainExample"></a></p><center> <table border="0">
<tr>
<td><div class="image">
<img src="./hybrid_domain.jpg" border="0" />
</div>
 </td><td><div class="image">
<img src="./hybrid_domain_mesh_no_protection.jpg" border="0" />
</div>
 </td><td><div class="image">
<img src="./hybrid_domain_mesh_protection.jpg" border="0" />
</div>
  </td></tr>
</table>
</center><p>  </p><div class="cgal_figure_caption">  <a class="el" href="index.html#fig__mesh3HybridDomainExample">Figure 55.8</a> Left: the input hybrid domain.
<p>Middle : the output mesh without any call to <code>add_features()</code>.</p>
<p>Right : the output mesh with added 1D-features at the intersection of subdomains.  </p></div>  <br />

<h2><a class="anchor" id="Mesh_3PolyhedralDomains"></a>
Polyhedral Domains</h2>
<p><a class="anchor" id="Mesh_3_subsection_examples_polyhedral"></a> </p>
<h3><a class="anchor" id="Mesh_33DPolyhedralDomains"></a>
3D Polyhedral Domains</h3>
<p>The following code produces a 3D mesh for a domain defined by a polyhedral surface. <a class="el" href="index.html#fig__figurepolyhedral_domain">Figure 55.9</a> shows the resulting mesh.</p>
<p><br />
<b>File</b> <a class="el" href="Mesh_3_2mesh_polyhedral_domain_8cpp-example.html">Mesh_3/mesh_polyhedral_domain.cpp</a> </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;CGAL/Exact_predicates_inexact_constructions_kernel.h&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Mesh_triangulation_3.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Mesh_complex_3_in_triangulation_3.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Mesh_criteria_3.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Polyhedron_3.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/boost/graph/helpers.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Polyhedral_mesh_domain_3.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/make_mesh_3.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/refine_mesh_3.h&gt;</span></div><div class="line"></div><div class="line"><span class="comment">// Domain</span></div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Kernel_23.tag:../Kernel_23/" href="../Kernel_23/classCGAL_1_1Exact__predicates__inexact__constructions__kernel.html">CGAL::Exact_predicates_inexact_constructions_kernel</a> K;</div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Polyhedron.tag:../Polyhedron/" href="../Polyhedron/classCGAL_1_1Polyhedron__3.html">CGAL::Polyhedron_3&lt;K&gt;</a> Polyhedron;</div><div class="line"><span class="keyword">typedef</span> <a class="code" href="classCGAL_1_1Polyhedral__mesh__domain__3.html">CGAL::Polyhedral_mesh_domain_3&lt;Polyhedron, K&gt;</a> Mesh_domain;</div><div class="line"></div><div class="line"><span class="preprocessor">#ifdef CGAL_CONCURRENT_MESH_3</span></div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/STL_Extension.tag:../STL_Extension/" href="../STL_Extension/structCGAL_1_1Parallel__tag.html">CGAL::Parallel_tag</a> Concurrency_tag;</div><div class="line"><span class="preprocessor">#else</span></div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/STL_Extension.tag:../STL_Extension/" href="../STL_Extension/structCGAL_1_1Sequential__tag.html">CGAL::Sequential_tag</a> Concurrency_tag;</div><div class="line"><span class="preprocessor">#endif</span></div><div class="line"></div><div class="line"><span class="comment">// Triangulation</span></div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Manual.tag:../Manual/" href="../Manual/classunspecified__type.html">CGAL::Mesh_triangulation_3&lt;Mesh_domain,CGAL::Default,Concurrency_tag&gt;::type</a> Tr;</div><div class="line"></div><div class="line"><span class="keyword">typedef</span> <a class="code" href="classCGAL_1_1Mesh__complex__3__in__triangulation__3.html">CGAL::Mesh_complex_3_in_triangulation_3&lt;Tr&gt;</a> C3t3;</div><div class="line"></div><div class="line"><span class="comment">// Criteria</span></div><div class="line"><span class="keyword">typedef</span> <a class="code" href="classCGAL_1_1Mesh__criteria__3.html">CGAL::Mesh_criteria_3&lt;Tr&gt;</a> Mesh_criteria;</div><div class="line"></div><div class="line"><span class="comment">// To avoid verbose function and named parameters call</span></div><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespaceCGAL_1_1parameters.html">CGAL::parameters</a>;</div><div class="line"></div><div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>*argv[])</div><div class="line">{</div><div class="line">  <span class="keyword">const</span> <span class="keywordtype">char</span>* fname = (argc&gt;1)?argv[1]:<span class="stringliteral">"data/elephant.off"</span>;</div><div class="line">  <span class="comment">// Create input polyhedron</span></div><div class="line">  Polyhedron polyhedron;</div><div class="line">  std::ifstream input(fname);</div><div class="line">  input &gt;&gt; polyhedron;</div><div class="line">  <span class="keywordflow">if</span>(input.fail()){</div><div class="line">    std::cerr &lt;&lt; <span class="stringliteral">"Error: Cannot read file "</span> &lt;&lt;  fname &lt;&lt; std::endl;</div><div class="line">    <span class="keywordflow">return</span> EXIT_FAILURE;</div><div class="line">  }</div><div class="line">  input.close();</div><div class="line">  </div><div class="line">  <span class="keywordflow">if</span> (!<a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/BGL.tag:../BGL/" href="../BGL/group__PkgBGLHelperFct.html#ga11883d231eec1b58f37efe4acedd9588">CGAL::is_triangle_mesh</a>(polyhedron)){</div><div class="line">    std::cerr &lt;&lt; <span class="stringliteral">"Input geometry is not triangulated."</span> &lt;&lt; std::endl;</div><div class="line">    <span class="keywordflow">return</span> EXIT_FAILURE;</div><div class="line">  }</div><div class="line"></div><div class="line">  <span class="comment">// Create domain</span></div><div class="line">  Mesh_domain domain(polyhedron);</div><div class="line">  </div><div class="line">  <span class="comment">// Mesh criteria (no cell_size set)</span></div><div class="line">  Mesh_criteria criteria(facet_angle=25, facet_size=0.15, facet_distance=0.008,</div><div class="line">                         cell_radius_edge_ratio=3);</div><div class="line">  </div><div class="line">  <span class="comment">// Mesh generation</span></div><div class="line">  C3t3 c3t3 = CGAL::make_mesh_3&lt;C3t3&gt;(domain, criteria, <a class="code" href="group__PkgMesh__3Parameters.html#ga5714d10decd9eecd30997572b785e03b">no_perturb</a>(), <a class="code" href="group__PkgMesh__3Parameters.html#ga0b79c473082a4ec2a45ed1497f3ac873">no_exude</a>());</div><div class="line"></div><div class="line">  <span class="comment">// Output</span></div><div class="line">  std::ofstream medit_file(<span class="stringliteral">"out_1.mesh"</span>);</div><div class="line">  c3t3.output_to_medit(medit_file);</div><div class="line">  medit_file.close();</div><div class="line"></div><div class="line">  <span class="comment">// Set tetrahedron size (keep cell_radius_edge_ratio), ignore facets</span></div><div class="line">  Mesh_criteria new_criteria(cell_radius_edge_ratio=3, cell_size=0.03);</div><div class="line"></div><div class="line">  <span class="comment">// Mesh refinement (and make the output manifold)</span></div><div class="line">  <a class="code" href="group__PkgMesh__3Functions.html#gac5a80764f9615b55c9dc60ab055e06ba">CGAL::refine_mesh_3</a>(c3t3, domain, new_criteria, <a class="code" href="group__PkgMesh__3Parameters.html#ga67c9c42cfafc22044cc74c704c29aa76">manifold</a>());</div><div class="line"></div><div class="line">  <span class="comment">// Output</span></div><div class="line">  medit_file.open(<span class="stringliteral">"out_2.mesh"</span>);</div><div class="line">  c3t3.output_to_medit(medit_file);</div><div class="line"></div><div class="line">  <span class="keywordflow">return</span> EXIT_SUCCESS;</div><div class="line">}</div></div><!-- fragment --><p><a class="anchor" id="fig__figurepolyhedral_domain"></a></p><center> <table border="0">
<tr>
<td><div class="image">
<img src="polyhedral_domain.jpg" alt="polyhedral_domain.jpg" />
</div>
   </td><td><div class="image">
<img src="polyhedral_domain_2.jpg" alt="polyhedral_domain_2.jpg" />
</div>
    </td></tr>
</table>
</center><p> </p><div class="cgal_figure_caption">   <a class="el" href="index.html#fig__figurepolyhedral_domain">Figure 55.9</a> View of 3D meshes produced from a polyhedral domain. (i) is a view of file out_1.mesh and (ii) is a view of file out_2.mesh. Code from subsection <a class="el" href="index.html#Mesh_3_subsection_examples_polyhedral">Mesh_3_subsection_examples_polyhedral</a> generates these files.  </div>  <br />

<h3><a class="anchor" id="Mesh_33DSurfaceInsidePolyhedralDomain"></a>
Remeshing a Polyhedral Domain with Surfaces</h3>
<p>In the following example we have a "bounding polyhedron" which defines the meshing domain and two surfaces inside this domain. The surfaces inside the domain may be closed surfaces as well as surfaces with boundaries. In the case of a closed surface the volume delimited by this surface is also considered as inside the domain. previous subsection.</p>
<p><br />
<b>File</b> <a class="el" href="Mesh_3_2mesh_polyhedral_domain_with_surface_inside_8cpp-example.html">Mesh_3/mesh_polyhedral_domain_with_surface_inside.cpp</a> </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;CGAL/Exact_predicates_inexact_constructions_kernel.h&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Mesh_triangulation_3.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Mesh_complex_3_in_triangulation_3.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Mesh_criteria_3.h&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Polyhedron_3.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Polyhedral_mesh_domain_with_features_3.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/make_mesh_3.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Timer.h&gt;</span></div><div class="line"></div><div class="line"><span class="comment">// Domain </span></div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Kernel_23.tag:../Kernel_23/" href="../Kernel_23/classCGAL_1_1Exact__predicates__inexact__constructions__kernel.html">CGAL::Exact_predicates_inexact_constructions_kernel</a> K;</div><div class="line"></div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Manual.tag:../Manual/" href="../Manual/classunspecified__type.html">CGAL::Mesh_polyhedron_3&lt;K&gt;::type</a> Polyhedron;</div><div class="line"></div><div class="line"><span class="keyword">typedef</span> <a class="code" href="classCGAL_1_1Polyhedral__mesh__domain__with__features__3.html">CGAL::Polyhedral_mesh_domain_with_features_3&lt;K&gt;</a> Mesh_domain;</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">// Triangulation</span></div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Manual.tag:../Manual/" href="../Manual/classunspecified__type.html">CGAL::Mesh_triangulation_3&lt;Mesh_domain,CGAL::Default,CGAL::Sequential_tag&gt;::type</a> Tr;</div><div class="line"></div><div class="line"><span class="keyword">typedef</span> <a class="code" href="classCGAL_1_1Mesh__complex__3__in__triangulation__3.html">CGAL::Mesh_complex_3_in_triangulation_3</a>&lt;</div><div class="line">  Tr,Mesh_domain::Corner_index,Mesh_domain::Curve_index&gt; C3t3;</div><div class="line"></div><div class="line"><span class="comment">// Criteria</span></div><div class="line"><span class="keyword">typedef</span> <a class="code" href="classCGAL_1_1Mesh__criteria__3.html">CGAL::Mesh_criteria_3&lt;Tr&gt;</a> Mesh_criteria;</div><div class="line"></div><div class="line"><span class="comment">// To avoid verbose function and named parameters call</span></div><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespaceCGAL_1_1parameters.html">CGAL::parameters</a>;</div><div class="line"></div><div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>*argv[])</div><div class="line">{</div><div class="line">  std::cout.precision(17);</div><div class="line">  std::cerr.precision(17);</div><div class="line">  <span class="keyword">const</span> <span class="keywordtype">char</span>* fname = (argc&gt;1)?argv[1]:<span class="stringliteral">"data/horizons.off"</span>;</div><div class="line">  std::ifstream input(fname);</div><div class="line">  <span class="keyword">const</span> <span class="keywordtype">char</span>* fname2 = (argc&gt;2)?argv[2]:<span class="stringliteral">"data/horizons-domain.off"</span>;</div><div class="line">  std::ifstream input2(fname2);</div><div class="line">  Polyhedron sm, smbounding;</div><div class="line">  input &gt;&gt; sm;</div><div class="line">  input2 &gt;&gt; smbounding;</div><div class="line">  <span class="keywordflow">if</span>(input.fail()){</div><div class="line">    std::cerr &lt;&lt; <span class="stringliteral">"Error: Cannot read file "</span> &lt;&lt;  fname &lt;&lt; std::endl;</div><div class="line">    <span class="keywordflow">return</span> EXIT_FAILURE;</div><div class="line">  }</div><div class="line">  <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Miscellany.tag:../Miscellany/" href="../Miscellany/classCGAL_1_1Timer.html">CGAL::Timer</a> t;</div><div class="line">  t.<a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Miscellany.tag:../Miscellany/" href="../Miscellany/classCGAL_1_1Timer.html#a6a017f275336b7bac43ba48c4d86331b">start</a>();</div><div class="line">  <span class="comment">// Create domain</span></div><div class="line">  Mesh_domain domain(sm, smbounding);</div><div class="line"></div><div class="line">  <span class="comment">// Get sharp features</span></div><div class="line">  domain.detect_features();</div><div class="line"></div><div class="line">  <span class="comment">// Mesh criteria</span></div><div class="line">  Mesh_criteria criteria(edge_size = 0.025,</div><div class="line">                         facet_angle = 25, facet_size = 0.05, facet_distance = 0.005,</div><div class="line">                         cell_radius_edge_ratio = 3, cell_size = 0.05);</div><div class="line">  </div><div class="line">  <span class="comment">// Mesh generation</span></div><div class="line">  C3t3 c3t3 = CGAL::make_mesh_3&lt;C3t3&gt;(domain, criteria,</div><div class="line">                                      <a class="code" href="group__PkgMesh__3Parameters.html#ga5714d10decd9eecd30997572b785e03b">no_perturb</a>(), <a class="code" href="group__PkgMesh__3Parameters.html#ga0b79c473082a4ec2a45ed1497f3ac873">no_exude</a>());</div><div class="line"></div><div class="line">  std::cerr &lt;&lt; t.<a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Miscellany.tag:../Miscellany/" href="../Miscellany/classCGAL_1_1Timer.html#a393807d2b9639442c12d65497d56ff97">time</a>() &lt;&lt; <span class="stringliteral">" sec."</span> &lt;&lt; std::endl;</div><div class="line">  <span class="comment">// Output</span></div><div class="line">  dump_c3t3(c3t3, <span class="stringliteral">"out"</span>);</div><div class="line">}</div></div><!-- fragment --><p><a class="anchor" id="fig__figurepolyhedral_domain_with_surface"></a></p><div class="image">
<img src="polyhedral_domain_with_surface.jpg" alt="polyhedral_domain_with_surface.jpg" />
</div>
   <div class="cgal_figure_caption">  <a class="el" href="index.html#fig__figurepolyhedral_domain_with_surface">Figure 55.10</a> View of 3D meshes produced from a polyhedral domain with a nested surface.  </div>  <br />

<h3><a class="anchor" id="Mesh_3RemeshingPolyhedralSurface"></a>
Remeshing a Polyhedral Surface</h3>
<p>The following code creates a polyhedral domain, with only one polyhedron, and no "bounding polyhedron", so the volumetric part of the domain will be empty. This allows to remesh a surface, and is equivalent to the function <code><a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Surface_mesher.tag:../Surface_mesher/" href="../Surface_mesher/group__PkgSurfaceMesher3FunctionsMakeMesh.html#ga7e188adef5bfadaafd08db82c8a25dc1">make_surface_mesh()</a></code>.</p>
<p><br />
<b>File</b> <a class="el" href="Mesh_3_2remesh_polyhedral_surface_8cpp-example.html">Mesh_3/remesh_polyhedral_surface.cpp</a> </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;CGAL/Exact_predicates_inexact_constructions_kernel.h&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Mesh_triangulation_3.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Mesh_complex_3_in_triangulation_3.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Mesh_criteria_3.h&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Polyhedral_mesh_domain_with_features_3.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/make_mesh_3.h&gt;</span></div><div class="line"></div><div class="line"><span class="comment">// Domain </span></div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Kernel_23.tag:../Kernel_23/" href="../Kernel_23/classCGAL_1_1Exact__predicates__inexact__constructions__kernel.html">CGAL::Exact_predicates_inexact_constructions_kernel</a> K;</div><div class="line"><span class="keyword">typedef</span> <a class="code" href="classCGAL_1_1Polyhedral__mesh__domain__with__features__3.html">CGAL::Polyhedral_mesh_domain_with_features_3&lt;K&gt;</a> Mesh_domain;</div><div class="line"></div><div class="line"><span class="comment">// Polyhedron type</span></div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Manual.tag:../Manual/" href="../Manual/classunspecified__type.html">CGAL::Mesh_polyhedron_3&lt;K&gt;::type</a> Polyhedron;</div><div class="line"></div><div class="line"><span class="comment">// Triangulation</span></div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Manual.tag:../Manual/" href="../Manual/classunspecified__type.html">CGAL::Mesh_triangulation_3&lt;Mesh_domain&gt;::type</a> Tr;</div><div class="line"><span class="keyword">typedef</span> <a class="code" href="classCGAL_1_1Mesh__complex__3__in__triangulation__3.html">CGAL::Mesh_complex_3_in_triangulation_3</a>&lt;</div><div class="line">  Tr,Mesh_domain::Corner_index,Mesh_domain::Curve_index&gt; C3t3;</div><div class="line"></div><div class="line"><span class="comment">// Criteria</span></div><div class="line"><span class="keyword">typedef</span> <a class="code" href="classCGAL_1_1Mesh__criteria__3.html">CGAL::Mesh_criteria_3&lt;Tr&gt;</a> Mesh_criteria;</div><div class="line"></div><div class="line"><span class="comment">// To avoid verbose function and named parameters call</span></div><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespaceCGAL_1_1parameters.html">CGAL::parameters</a>;</div><div class="line"></div><div class="line"><span class="keywordtype">int</span> main()</div><div class="line">{</div><div class="line">  <span class="comment">// Load a polyhedron</span></div><div class="line">  Polyhedron poly;</div><div class="line">  std::ifstream input(<span class="stringliteral">"data/lion-head.off"</span>);</div><div class="line">  input &gt;&gt; poly;</div><div class="line"></div><div class="line">  <span class="keywordflow">if</span> (!<a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/BGL.tag:../BGL/" href="../BGL/group__PkgBGLHelperFct.html#ga11883d231eec1b58f37efe4acedd9588">CGAL::is_triangle_mesh</a>(poly)){</div><div class="line">    std::cerr &lt;&lt; <span class="stringliteral">"Input geometry is not triangulated."</span> &lt;&lt; std::endl;</div><div class="line">    <span class="keywordflow">return</span> EXIT_FAILURE;</div><div class="line">  }</div><div class="line"></div><div class="line">  <span class="comment">// Create a vector with only one element: the pointer to the polyhedron.</span></div><div class="line">  std::vector&lt;Polyhedron*&gt; poly_ptrs_vector(1, &amp;poly);</div><div class="line"></div><div class="line">  <span class="comment">// Create a polyhedral domain, with only one polyhedron,</span></div><div class="line">  <span class="comment">// and no "bounding polyhedron", so the volumetric part of the domain will be</span></div><div class="line">  <span class="comment">// empty.</span></div><div class="line">  Mesh_domain domain(poly_ptrs_vector.begin(), poly_ptrs_vector.end());</div><div class="line">  </div><div class="line">  <span class="comment">// Get sharp features</span></div><div class="line">  domain.detect_features(); <span class="comment">//includes detection of borders</span></div><div class="line"></div><div class="line">  <span class="comment">// Mesh criteria</span></div><div class="line">  Mesh_criteria criteria(edge_size = 0.025,</div><div class="line">                         facet_angle = 25,</div><div class="line">                         facet_size = 0.1,</div><div class="line">                         facet_distance = 0.001);</div><div class="line">  </div><div class="line">  <span class="comment">// Mesh generation</span></div><div class="line">  C3t3 c3t3 = CGAL::make_mesh_3&lt;C3t3&gt;(domain, criteria, <a class="code" href="group__PkgMesh__3Parameters.html#ga5714d10decd9eecd30997572b785e03b">no_perturb</a>(), <a class="code" href="group__PkgMesh__3Parameters.html#ga0b79c473082a4ec2a45ed1497f3ac873">no_exude</a>());</div><div class="line"></div><div class="line">  <span class="comment">// Output the facets of the c3t3 to an OFF file. The facets will not be</span></div><div class="line">  <span class="comment">// oriented.</span></div><div class="line">  std::ofstream off_file(<span class="stringliteral">"out.off"</span>);</div><div class="line">  c3t3.output_boundary_to_off(off_file);</div><div class="line"></div><div class="line">  <span class="keywordflow">return</span> off_file.fail() ? EXIT_FAILURE : EXIT_SUCCESS;</div><div class="line">}</div></div><!-- fragment --><p><a class="anchor" id="fig__figureremeshing"></a></p><div class="image">
<img src="remeshing.jpg" alt="remeshing.jpg" />
</div>
   <div class="cgal_figure_caption">  <a class="el" href="index.html#fig__figureremeshing">Figure 55.11</a> View of a remeshed surface. (Left) input mesh (Right) output mesh. Code from subsection <a class="el" href="index.html#Mesh_3RemeshingPolyhedralSurface">Remeshing a Polyhedral Surface</a> generates the file.  </div>  <br />

<h2><a class="anchor" id="Mesh_3DomainsFromSegmented3DImages"></a>
Domains From Segmented 3D Images</h2>
<p><a class="anchor" id="Mesh_3_subsection_examples_3d_image"></a>The following code produces a 3D mesh from a 3D image. The image is a segmented medical image in which each voxel is associated a label in accordance with the tissue the voxel belongs to. The domain is therefore a multi-domain where each subdomain corresponds to a specific tissue.</p>
<p>In the following example, the image is read from the file <code>liver.inr.gz</code> which is encoded in the format of the library Inrimage <code><a href="http://inrimage.gforge.inria.fr/">http://inrimage.gforge.inria.fr/</a></code>. The resulting mesh is shown in <a class="el" href="index.html#fig__figureliver_3d_image_mesh">Figure 55.12</a>.</p>
<p><br />
<b>File</b> <a class="el" href="Mesh_3_2mesh_3D_image_8cpp-example.html">Mesh_3/mesh_3D_image.cpp</a> </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;CGAL/Exact_predicates_inexact_constructions_kernel.h&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Mesh_triangulation_3.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Mesh_complex_3_in_triangulation_3.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Mesh_criteria_3.h&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Labeled_mesh_domain_3.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/make_mesh_3.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Image_3.h&gt;</span></div><div class="line"></div><div class="line"><span class="comment">// Domain</span></div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Kernel_23.tag:../Kernel_23/" href="../Kernel_23/classCGAL_1_1Exact__predicates__inexact__constructions__kernel.html">CGAL::Exact_predicates_inexact_constructions_kernel</a> K;</div><div class="line"><span class="keyword">typedef</span> <a class="code" href="classCGAL_1_1Labeled__mesh__domain__3.html">CGAL::Labeled_mesh_domain_3&lt;K&gt;</a> Mesh_domain;</div><div class="line"></div><div class="line"><span class="preprocessor">#ifdef CGAL_CONCURRENT_MESH_3</span></div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/STL_Extension.tag:../STL_Extension/" href="../STL_Extension/structCGAL_1_1Parallel__tag.html">CGAL::Parallel_tag</a> Concurrency_tag;</div><div class="line"><span class="preprocessor">#else</span></div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/STL_Extension.tag:../STL_Extension/" href="../STL_Extension/structCGAL_1_1Sequential__tag.html">CGAL::Sequential_tag</a> Concurrency_tag;</div><div class="line"><span class="preprocessor">#endif</span></div><div class="line"></div><div class="line"><span class="comment">// Triangulation</span></div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Manual.tag:../Manual/" href="../Manual/classunspecified__type.html">CGAL::Mesh_triangulation_3&lt;Mesh_domain,CGAL::Default,Concurrency_tag&gt;::type</a> Tr;</div><div class="line"></div><div class="line"><span class="keyword">typedef</span> <a class="code" href="classCGAL_1_1Mesh__complex__3__in__triangulation__3.html">CGAL::Mesh_complex_3_in_triangulation_3&lt;Tr&gt;</a> C3t3;</div><div class="line"></div><div class="line"><span class="comment">// Criteria</span></div><div class="line"><span class="keyword">typedef</span> <a class="code" href="classCGAL_1_1Mesh__criteria__3.html">CGAL::Mesh_criteria_3&lt;Tr&gt;</a> Mesh_criteria;</div><div class="line"></div><div class="line"><span class="comment">// To avoid verbose function and named parameters call</span></div><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespaceCGAL_1_1parameters.html">CGAL::parameters</a>;</div><div class="line"></div><div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>* argv[])</div><div class="line">{</div><div class="line">  <span class="keyword">const</span> <span class="keywordtype">char</span>* fname = (argc&gt;1)?argv[1]:<span class="stringliteral">"data/liver.inr.gz"</span>;</div><div class="line">  <a class="code" href="classCGAL_1_1Image__3.html">CGAL::Image_3</a> image;</div><div class="line">  <span class="keywordflow">if</span>(!image.<a class="code" href="classCGAL_1_1Image__3.html#a6be029d7a0ee6dbd5eab1fd0adae42ba">read</a>(fname)){</div><div class="line">    std::cerr &lt;&lt; <span class="stringliteral">"Error: Cannot read file "</span> &lt;&lt;  fname &lt;&lt; std::endl;</div><div class="line">    <span class="keywordflow">return</span> EXIT_FAILURE;</div><div class="line">  }</div><div class="line"></div><div class="line">  Mesh_domain domain = Mesh_domain::create_labeled_image_mesh_domain(image);</div><div class="line"></div><div class="line">  <span class="comment">// Mesh criteria</span></div><div class="line">  Mesh_criteria criteria(facet_angle=30, facet_size=6, facet_distance=4,</div><div class="line">                         cell_radius_edge_ratio=3, cell_size=8);</div><div class="line"></div><div class="line">  C3t3 c3t3 = CGAL::make_mesh_3&lt;C3t3&gt;(domain, criteria);</div><div class="line"></div><div class="line">  <span class="comment">// Output</span></div><div class="line">  std::ofstream medit_file(<span class="stringliteral">"out.mesh"</span>);</div><div class="line">  c3t3.output_to_medit(medit_file);</div><div class="line"></div><div class="line">  <span class="keywordflow">return</span> 0;</div><div class="line">}</div></div><!-- fragment --><p><a class="anchor" id="fig__figureliver_3d_image_mesh"></a></p><div class="image">
<img src="liver.jpg" alt="liver.jpg" />
</div>
   <div class="cgal_figure_caption">  <a class="el" href="index.html#fig__figureliver_3d_image_mesh">Figure 55.12</a> Cut view of a 3D mesh produced from a segmented liver image. Code from subsection <a class="el" href="index.html#Mesh_3_subsection_examples_3d_image">Mesh_3_subsection_examples_3d_image</a> generates this file.  </div>  <br />

<h3><a class="anchor" id="Mesh_3DomainsFromSegmented3DImagesWithCustomInitialization"></a>
Domains From Segmented 3D Images, with a Custom Initialization</h3>
<p>The example <a class="el" href="Mesh_3_2mesh_3D_image_with_custom_initialization_8cpp-example.html">Mesh_3/mesh_3D_image_with_custom_initialization.cpp</a> is a modification of <a class="el" href="Mesh_3_2mesh_3D_image_8cpp-example.html">Mesh_3/mesh_3D_image.cpp</a>. The goal of that example is to show how the default initialization of the triangulation, using random rays, can be replaced by a new implementation. In this case, the initialization detects all connected components in the 3D segmented image, and inserts points in the triangulation for each connected component.</p>
<p>For the meshing, in the previous example (<a class="el" href="Mesh_3_2mesh_3D_image_8cpp-example.html">Mesh_3/mesh_3D_image.cpp</a>), we called <code><a class="el" href="group__PkgMesh__3Functions.html#ga1ee73dc372985c6aeef85f2415fac0ba" title="The function make_mesh_3() is a 3D mesh generator. ">make_mesh_3()</a></code> as follows.</p>
<div class="fragment"><div class="line">  C3t3 c3t3 = CGAL::make_mesh_3&lt;C3t3&gt;(domain, criteria);</div></div><!-- fragment --><p> In the example <a class="el" href="Mesh_3_2mesh_3D_image_with_custom_initialization_8cpp-example.html">Mesh_3/mesh_3D_image_with_custom_initialization.cpp</a>, that call is replaced by:</p><ol type="1">
<li>the creation of an empty <code>c3t3</code> object,</li>
<li>a call to a non-documented function <code>initialize_triangulation_from_labeled_image()</code> that inserts points in the triangulation,</li>
<li>then the call to <code><a class="el" href="group__PkgMesh__3Functions.html#gac5a80764f9615b55c9dc60ab055e06ba" title="The function refine_mesh_3() is a 3D mesh generator. ">refine_mesh_3()</a></code>.</li>
</ol>
<div class="fragment"><div class="line">  C3t3 c3t3;</div><div class="line">  initialize_triangulation_from_labeled_image(c3t3,</div><div class="line">                                              domain,</div><div class="line">                                              image,</div><div class="line">                                              criteria,</div><div class="line">                                              (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>)0);</div><div class="line">  CGAL::refine_mesh_3&lt;C3t3&gt;(c3t3, domain, criteria);</div></div><!-- fragment --><p> The code of the function <code>initialize_triangulation_from_labeled_image()</code> is in the non-documented header <a class="el" href="CGAL_2Mesh_3_2initialize_triangulation_from_labeled_image_8h-example.html">CGAL/Mesh_3/initialize_triangulation_from_labeled_image.h</a>. As it is undocumented and may be removed or modified at any time, if you wish to use it then you should copy-paste it to your user code. The code of that function is rather complicated. The following lines show how to insert new points in the <code>c3t3</code> object, with the calls to <code><a class="el" href="classMeshVertexBase__3.html#a9fe48efb87f7ee8fe294f2053be1eb26" title="Sets the dimension of the lowest dimensional face of the input 3D complex that contains the vertex...">MeshVertexBase_3::set_dimension()</a></code> and <code><a class="el" href="classMeshVertexBase__3.html#a3604c8c08cbb9d0b1f02dc53901fbd63" title="Sets the index of the lowest dimensional face of the input 3D complex that contains the vertex...">MeshVertexBase_3::set_index()</a></code>.</p>
<div class="fragment"><div class="line">        Vertex_handle v = tr.insert(pi);</div><div class="line"></div><div class="line">        <span class="comment">// `v` could be null if `pi` is hidden by other vertices of `tr`.</span></div><div class="line">        CGAL_assertion(v != Vertex_handle());</div><div class="line"></div><div class="line">        c3t3.set_dimension(v, 2); <span class="comment">// by construction, points are on surface</span></div><div class="line">        c3t3.set_index(v, index);</div></div><!-- fragment --><p> The value of <code>index</code> must be consistent with the possible values of <code>Mesh_domain::Index</code>. In <a class="el" href="CGAL_2Mesh_3_2initialize_triangulation_from_labeled_image_8h-example.html">CGAL/Mesh_3/initialize_triangulation_from_labeled_image.h</a>, it is constructed using the API of the mesh domain, as follows. First the functor <code>construct_intersect</code> is created</p>
 <div class="fragment"><div class="line">    <span class="keyword">typename</span> Mesh_domain::Construct_intersection construct_intersection =</div><div class="line">      domain.construct_intersection_object();</div></div><!-- fragment --> then the <code>Mesh_domain::Intersection</code> object (a <code>tuple</code> with three elements) is constructed using a call to the functor <code>construct_intersection</code> <div class="fragment"><div class="line">      <span class="keyword">const</span> <span class="keyword">typename</span> Mesh_domain::Intersection intersect =</div><div class="line">        construct_intersection(Segment_3(it-&gt;first, test));</div></div><!-- fragment --> and eventually <code>index</code> is the element #1 of <code>intersect</code>. <div class="fragment"><div class="line">        <span class="keyword">const</span> <span class="keyword">typename</span> Mesh_domain::Index index = CGAL::cpp11::get&lt;1&gt;(intersect);</div></div><!-- fragment -->
<p>The result of the custom initialization can be seen in <a class="el" href="index.html#fig__mesh3custominitimage3D">Figure 55.13</a>. The generated 3D image contains a big sphere at the center, and 50 smaller spheres, generated randomly. Without the custom initialization, only the biggest component (the sphere at the center) was initialized and meshed. With the custom initialization, the initial <code>c3t3</code> object contains points on all connected components, and all spheres are meshed.</p>
<p><a class="anchor" id="fig__mesh3custominitimage3D"></a></p><center> <table border="0">
<tr>
<td><div class="image">
<img src="./no-custom-init.png" border="0" />
</div>
 </td><td><div class="image">
<img src="./with-custom-init.png" border="0" />
</div>
  </td></tr>
</table>
</center><p>  </p><div class="cgal_figure_caption">  <a class="el" href="index.html#fig__mesh3custominitimage3D">Figure 55.13</a> Left: the mesh without the custom initialization, only the big sphere at the center is meshed
<p>Right: the mesh generated after the initialization of all connected components  </p></div>  <br />

<p>Note that the example <a class="el" href="Mesh_3_2mesh_3D_image_with_custom_initialization_8cpp-example.html">Mesh_3/mesh_3D_image_with_custom_initialization.cpp</a> also shows how to create a 3D image using the undocumented API of CGAL_ImageIO.</p>
<div class="fragment"><div class="line">  <a class="code" href="classCGAL_1_1Image__3.html">CGAL::Image_3</a> image = random_labeled_image();</div></div><!-- fragment --><p> The code of the function <code>random_labeled_image()</code> is in the header file <a class="el" href="Mesh_3_2random_labeled_image_8h-example.html">Mesh_3/random_labeled_image.h</a>.</p>
<h2><a class="anchor" id="Mesh_3UsingVariableSizingField"></a>
Using Variable Sizing Field</h2>
<h3><a class="anchor" id="Mesh_3SizingFieldasanAnalyticalFunction"></a>
Sizing Field as an Analytical Function</h3>
<p><a class="anchor" id="Mesh_3_subsubsection_examples_sphere_variable"></a> The following example shows how to use an analytical function as sizing field.</p>
<p><br />
<b>File</b> <a class="el" href="Mesh_3_2mesh_implicit_sphere_variable_size_8cpp-example.html">Mesh_3/mesh_implicit_sphere_variable_size.cpp</a> </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;CGAL/Exact_predicates_inexact_constructions_kernel.h&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Mesh_triangulation_3.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Mesh_complex_3_in_triangulation_3.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Mesh_criteria_3.h&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Labeled_mesh_domain_3.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/make_mesh_3.h&gt;</span></div><div class="line"></div><div class="line"><span class="comment">// Domain</span></div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Kernel_23.tag:../Kernel_23/" href="../Kernel_23/classCGAL_1_1Exact__predicates__inexact__constructions__kernel.html">CGAL::Exact_predicates_inexact_constructions_kernel</a> K;</div><div class="line"><span class="keyword">typedef</span> K::FT FT;</div><div class="line"><span class="keyword">typedef</span> K::Point_3 Point;</div><div class="line"><span class="keyword">typedef</span> FT (Function)(<span class="keyword">const</span> Point&amp;);</div><div class="line"><span class="keyword">typedef</span> <a class="code" href="classCGAL_1_1Labeled__mesh__domain__3.html">CGAL::Labeled_mesh_domain_3&lt;K&gt;</a> Mesh_domain;</div><div class="line"></div><div class="line"><span class="preprocessor">#ifdef CGAL_CONCURRENT_MESH_3</span></div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/STL_Extension.tag:../STL_Extension/" href="../STL_Extension/structCGAL_1_1Parallel__tag.html">CGAL::Parallel_tag</a> Concurrency_tag;</div><div class="line"><span class="preprocessor">#else</span></div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/STL_Extension.tag:../STL_Extension/" href="../STL_Extension/structCGAL_1_1Sequential__tag.html">CGAL::Sequential_tag</a> Concurrency_tag;</div><div class="line"><span class="preprocessor">#endif</span></div><div class="line"></div><div class="line"><span class="comment">// Triangulation</span></div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Manual.tag:../Manual/" href="../Manual/classunspecified__type.html">CGAL::Mesh_triangulation_3&lt;Mesh_domain,CGAL::Default,Concurrency_tag&gt;::type</a> Tr;</div><div class="line"></div><div class="line"><span class="keyword">typedef</span> <a class="code" href="classCGAL_1_1Mesh__complex__3__in__triangulation__3.html">CGAL::Mesh_complex_3_in_triangulation_3&lt;Tr&gt;</a> C3t3;</div><div class="line"></div><div class="line"><span class="comment">// Criteria</span></div><div class="line"><span class="keyword">typedef</span> <a class="code" href="classCGAL_1_1Mesh__criteria__3.html">CGAL::Mesh_criteria_3&lt;Tr&gt;</a> Mesh_criteria;</div><div class="line"></div><div class="line"><span class="comment">// Sizing field</span></div><div class="line"><span class="keyword">struct </span>Spherical_sizing_field</div><div class="line">{</div><div class="line">  typedef ::FT FT;</div><div class="line">  <span class="keyword">typedef</span> Point Point_3;</div><div class="line">  <span class="keyword">typedef</span> Mesh_domain::Index <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/STL_Extension.tag:../STL_Extension/" href="../STL_Extension/classIndex.html">Index</a>;</div><div class="line">  </div><div class="line">  FT operator()(<span class="keyword">const</span> Point_3&amp; p, <span class="keyword">const</span> <span class="keywordtype">int</span>, <span class="keyword">const</span> Index&amp;)<span class="keyword"> const</span></div><div class="line"><span class="keyword">  </span>{</div><div class="line">    FT sq_d_to_origin = <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Kernel_23.tag:../Kernel_23/" href="../Kernel_23/group__squared__distance__grp.html#ga1ff73525660a052564d33fbdd61a4f71">CGAL::squared_distance</a>(p, Point(<a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Kernel_23.tag:../Kernel_23/" href="../Kernel_23/group__kernel__enums.html#ga9d272a8e3a8080b851741b6d3a44afdc">CGAL::ORIGIN</a>));</div><div class="line">    <span class="keywordflow">return</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Algebraic_foundations.tag:../Algebraic_foundations/" href="../Algebraic_foundations/group__PkgAlgebraicFoundations.html#ga1d5106cf8be16adb4c4dc8b1ec3a5a92">CGAL::abs</a>( <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Algebraic_foundations.tag:../Algebraic_foundations/" href="../Algebraic_foundations/group__PkgAlgebraicFoundations.html#gab922269072ee9ee99ba8c541418b2e11">CGAL::sqrt</a>(sq_d_to_origin)-0.5 ) / 5. + 0.025; </div><div class="line">  }</div><div class="line">};</div><div class="line"></div><div class="line"><span class="comment">// To avoid verbose function and named parameters call</span></div><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespaceCGAL_1_1parameters.html">CGAL::parameters</a>;</div><div class="line"></div><div class="line"><span class="comment">// Function</span></div><div class="line">FT sphere_function (<span class="keyword">const</span> Point&amp; p)</div><div class="line">{ <span class="keywordflow">return</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Kernel_23.tag:../Kernel_23/" href="../Kernel_23/group__squared__distance__grp.html#ga1ff73525660a052564d33fbdd61a4f71">CGAL::squared_distance</a>(p, Point(<a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Kernel_23.tag:../Kernel_23/" href="../Kernel_23/group__kernel__enums.html#ga9d272a8e3a8080b851741b6d3a44afdc">CGAL::ORIGIN</a>))-1; }</div><div class="line"></div><div class="line"><span class="keywordtype">int</span> main()</div><div class="line">{</div><div class="line">  <span class="keyword">namespace </span>p = <a class="code" href="namespaceCGAL_1_1parameters.html">CGAL::parameters</a>;</div><div class="line">  Mesh_domain domain = Mesh_domain::create_implicit_mesh_domain</div><div class="line">    (p::function = &amp;sphere_function,</div><div class="line">     p::bounding_object = K::Sphere_3(<a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Kernel_23.tag:../Kernel_23/" href="../Kernel_23/group__kernel__enums.html#ga9d272a8e3a8080b851741b6d3a44afdc">CGAL::ORIGIN</a>, 2.)</div><div class="line">     );</div><div class="line"></div><div class="line">  <span class="comment">// Mesh criteria</span></div><div class="line">  Spherical_sizing_field size;</div><div class="line">  Mesh_criteria criteria(facet_angle=30, facet_size=0.1, facet_distance=0.025,</div><div class="line">                         cell_radius_edge_ratio=2, cell_size=size);</div><div class="line">  </div><div class="line">  <span class="comment">// Mesh generation</span></div><div class="line">  C3t3 c3t3 = CGAL::make_mesh_3&lt;C3t3&gt;(domain, criteria, <a class="code" href="group__PkgMesh__3Parameters.html#ga0b79c473082a4ec2a45ed1497f3ac873">no_exude</a>(), <a class="code" href="group__PkgMesh__3Parameters.html#ga5714d10decd9eecd30997572b785e03b">no_perturb</a>());</div><div class="line"></div><div class="line">  <span class="comment">// Output</span></div><div class="line">  std::ofstream medit_file(<span class="stringliteral">"out.mesh"</span>);</div><div class="line">  c3t3.output_to_medit(medit_file);</div><div class="line"></div><div class="line">  <span class="keywordflow">return</span> 0;</div><div class="line">}</div><div class="line"></div></div><!-- fragment --><p><a class="anchor" id="fig__figuresphere_variable_mesh"></a></p><div class="image">
<img src="sphere_variable.jpg" alt="sphere_variable.jpg" />
</div>
   <div class="cgal_figure_caption">  <a class="el" href="index.html#fig__figuresphere_variable_mesh">Figure 55.14</a> Cut view of a 3D mesh produced from an implicit sphere with non-constant sizing field. Code from subsection <a class="el" href="index.html#Mesh_3_subsubsection_examples_sphere_variable">Mesh_3_subsubsection_examples_sphere_variable</a> generates this file.  </div>  <br />

<h3><a class="anchor" id="Mesh_3DifferentSizingFieldforDifferentSubdomains"></a>
Different Sizing Field for Different Subdomains</h3>
<p><a class="anchor" id="Mesh_3_subsubsection_examples_3d_image_variable"></a> The following example shows how to use different size for different organs in a 3D medical image.</p>
<p><br />
<b>File</b> <a class="el" href="Mesh_3_2mesh_3D_image_variable_size_8cpp-example.html">Mesh_3/mesh_3D_image_variable_size.cpp</a> </p><div class="fragment"><div class="line"><span class="preprocessor">#define CGAL_MESH_3_VERBOSE</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Exact_predicates_inexact_constructions_kernel.h&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Mesh_triangulation_3.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Mesh_complex_3_in_triangulation_3.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Mesh_criteria_3.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Mesh_constant_domain_field_3.h&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Labeled_mesh_domain_3.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/make_mesh_3.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Image_3.h&gt;</span></div><div class="line"></div><div class="line"><span class="comment">// Domain</span></div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Kernel_23.tag:../Kernel_23/" href="../Kernel_23/classCGAL_1_1Exact__predicates__inexact__constructions__kernel.html">CGAL::Exact_predicates_inexact_constructions_kernel</a> K;</div><div class="line"><span class="keyword">typedef</span> <a class="code" href="classCGAL_1_1Labeled__mesh__domain__3.html">CGAL::Labeled_mesh_domain_3&lt;K&gt;</a> Mesh_domain;</div><div class="line"></div><div class="line"><span class="preprocessor">#ifdef CGAL_CONCURRENT_MESH_3</span></div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/STL_Extension.tag:../STL_Extension/" href="../STL_Extension/structCGAL_1_1Parallel__tag.html">CGAL::Parallel_tag</a> Concurrency_tag;</div><div class="line"><span class="preprocessor">#else</span></div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/STL_Extension.tag:../STL_Extension/" href="../STL_Extension/structCGAL_1_1Sequential__tag.html">CGAL::Sequential_tag</a> Concurrency_tag;</div><div class="line"><span class="preprocessor">#endif</span></div><div class="line"></div><div class="line"><span class="comment">// Triangulation</span></div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Manual.tag:../Manual/" href="../Manual/classunspecified__type.html">CGAL::Mesh_triangulation_3&lt;Mesh_domain,CGAL::Default,Concurrency_tag&gt;::type</a> Tr;</div><div class="line"></div><div class="line"><span class="keyword">typedef</span> <a class="code" href="classCGAL_1_1Mesh__complex__3__in__triangulation__3.html">CGAL::Mesh_complex_3_in_triangulation_3&lt;Tr&gt;</a> C3t3;</div><div class="line"></div><div class="line"><span class="comment">// Criteria</span></div><div class="line"><span class="keyword">typedef</span> <a class="code" href="classCGAL_1_1Mesh__criteria__3.html">CGAL::Mesh_criteria_3&lt;Tr&gt;</a> Mesh_criteria;</div><div class="line"><span class="keyword">typedef</span> <a class="code" href="classCGAL_1_1Mesh__constant__domain__field__3.html">CGAL::Mesh_constant_domain_field_3</a>&lt;Mesh_domain::R,</div><div class="line">                                           Mesh_domain::Index&gt; Sizing_field;</div><div class="line"></div><div class="line"><span class="comment">// To avoid verbose function and named parameters call</span></div><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespaceCGAL_1_1parameters.html">CGAL::parameters</a>;</div><div class="line"></div><div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>* argv[])</div><div class="line">{</div><div class="line">  <span class="keyword">const</span> <span class="keywordtype">char</span>* fname = (argc&gt;1)?argv[1]:<span class="stringliteral">"data/liver.inr.gz"</span>;</div><div class="line">  <span class="comment">// Loads image</span></div><div class="line">  <a class="code" href="classCGAL_1_1Image__3.html">CGAL::Image_3</a> image;</div><div class="line">  <span class="keywordflow">if</span>(!image.<a class="code" href="classCGAL_1_1Image__3.html#a6be029d7a0ee6dbd5eab1fd0adae42ba">read</a>(fname)){</div><div class="line">    std::cerr &lt;&lt; <span class="stringliteral">"Error: Cannot read file "</span> &lt;&lt;  fname &lt;&lt; std::endl;</div><div class="line">    <span class="keywordflow">return</span> EXIT_FAILURE;</div><div class="line">  }</div><div class="line"></div><div class="line">  <span class="comment">// Domain</span></div><div class="line">  Mesh_domain domain = Mesh_domain::create_labeled_image_mesh_domain(image);</div><div class="line"></div><div class="line">  <span class="comment">// Sizing field: set global size to 8 and kidney size (label 127) to 3</span></div><div class="line">  <span class="keywordtype">double</span> kidney_size = 3.;</div><div class="line">  <span class="keywordtype">int</span> volume_dimension = 3;</div><div class="line">  Sizing_field size(8);</div><div class="line">  size.set_size(kidney_size, volume_dimension, </div><div class="line">                domain.index_from_subdomain_index(127));</div><div class="line">  </div><div class="line">  <span class="comment">// Mesh criteria</span></div><div class="line">  Mesh_criteria criteria(facet_angle=30, facet_size=6, facet_distance=2,</div><div class="line">                         cell_radius_edge_ratio=3, cell_size=size);</div><div class="line"></div><div class="line">  <span class="comment">// Meshing</span></div><div class="line">  C3t3 c3t3 = CGAL::make_mesh_3&lt;C3t3&gt;(domain, criteria);</div><div class="line"></div><div class="line">  <span class="comment">// Output</span></div><div class="line">  std::ofstream medit_file(<span class="stringliteral">"out.mesh"</span>);</div><div class="line">  c3t3.output_to_medit(medit_file);</div><div class="line"></div><div class="line">  <span class="keywordflow">return</span> 0;</div><div class="line">}</div></div><!-- fragment --><p><a class="anchor" id="fig__figureliver_variable_mesh"></a></p><div class="image">
<img src="liver_variable.jpg" alt="liver_variable.jpg" />
</div>
   <div class="cgal_figure_caption">  <a class="el" href="index.html#fig__figureliver_variable_mesh">Figure 55.15</a> View of a 3D mesh produced from a 3D image with different size for different organs. Code from subsection <a class="el" href="index.html#Mesh_3_subsubsection_examples_3d_image_variable">Mesh_3_subsubsection_examples_3d_image_variable</a> generates this file.  </div>  <br />

<h3><a class="anchor" id="Mesh_3LipschitzSizingField"></a>
Lipschitz Sizing Field</h3>
<p><a class="anchor" id="Mesh_3_subsubsection_examples_3d_image_lip_sizing"></a> The following example shows how to use another custom sizing function, that is <code>k</code>-Lipschitz. For each subdomain, the user provides the parameter <code>k</code>, a minimal size and maximal size for cells.</p>
<p><br />
<b>File</b> <a class="el" href="Mesh_3_2mesh_polyhedral_domain_with_lipschitz_sizing_8cpp-example.html">Mesh_3/mesh_polyhedral_domain_with_lipschitz_sizing.cpp</a> </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;CGAL/Exact_predicates_inexact_constructions_kernel.h&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Mesh_triangulation_3.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Mesh_complex_3_in_triangulation_3.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Mesh_criteria_3.h&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Polyhedral_mesh_domain_with_features_3.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/make_mesh_3.h&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Mesh_3/experimental/Lipschitz_sizing_polyhedron.h&gt;</span></div><div class="line"></div><div class="line"><span class="comment">//Kernel</span></div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Kernel_23.tag:../Kernel_23/" href="../Kernel_23/classCGAL_1_1Exact__predicates__inexact__constructions__kernel.html">CGAL::Exact_predicates_inexact_constructions_kernel</a> K;</div><div class="line"><span class="keyword">typedef</span> K::FT FT;</div><div class="line"></div><div class="line"><span class="comment">// Domain </span></div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Manual.tag:../Manual/" href="../Manual/classunspecified__type.html">CGAL::Mesh_polyhedron_3&lt;K&gt;::type</a> Polyhedron;</div><div class="line"><span class="keyword">typedef</span> <a class="code" href="classCGAL_1_1Polyhedral__mesh__domain__with__features__3.html">CGAL::Polyhedral_mesh_domain_with_features_3&lt;K&gt;</a> Mesh_domain;</div><div class="line"></div><div class="line"><span class="preprocessor">#ifdef CGAL_CONCURRENT_MESH_3</span></div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/STL_Extension.tag:../STL_Extension/" href="../STL_Extension/structCGAL_1_1Parallel__tag.html">CGAL::Parallel_tag</a> Concurrency_tag;</div><div class="line"><span class="preprocessor">#else</span></div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/STL_Extension.tag:../STL_Extension/" href="../STL_Extension/structCGAL_1_1Sequential__tag.html">CGAL::Sequential_tag</a> Concurrency_tag;</div><div class="line"><span class="preprocessor">#endif</span></div><div class="line"></div><div class="line"><span class="comment">// Triangulation</span></div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Manual.tag:../Manual/" href="../Manual/classunspecified__type.html">CGAL::Mesh_triangulation_3&lt;Mesh_domain,CGAL::Default,Concurrency_tag&gt;::type</a> Tr;</div><div class="line"><span class="keyword">typedef</span> <a class="code" href="classCGAL_1_1Mesh__complex__3__in__triangulation__3.html">CGAL::Mesh_complex_3_in_triangulation_3</a>&lt;</div><div class="line">  Tr,Mesh_domain::Corner_index,Mesh_domain::Curve_index&gt; C3t3;</div><div class="line"></div><div class="line"><span class="comment">// Criteria</span></div><div class="line"><span class="keyword">typedef</span> <a class="code" href="classCGAL_1_1Mesh__criteria__3.html">CGAL::Mesh_criteria_3&lt;Tr&gt;</a> Mesh_criteria;</div><div class="line"></div><div class="line"><span class="comment">// Sizing field</span></div><div class="line"><span class="keyword">typedef</span> CGAL::Mesh_3::Lipschitz_sizing&lt;K, Mesh_domain, Mesh_domain::AABB_tree&gt; Lip_sizing;</div><div class="line"></div><div class="line"><span class="comment">// To avoid verbose function and named parameters call</span></div><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespaceCGAL_1_1parameters.html">CGAL::parameters</a>;</div><div class="line"></div><div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>*argv[])</div><div class="line">{</div><div class="line">  <span class="keyword">const</span> <span class="keywordtype">char</span>* fname = (argc&gt;1) ? argv[1] : <span class="stringliteral">"data/fandisk.off"</span>;</div><div class="line">  std::ifstream input(fname);</div><div class="line">  Polyhedron polyhedron;</div><div class="line">  input &gt;&gt; polyhedron;</div><div class="line">  <span class="keywordflow">if</span> (input.fail()){</div><div class="line">    std::cerr &lt;&lt; <span class="stringliteral">"Error: Cannot read file "</span> &lt;&lt; fname &lt;&lt; std::endl;</div><div class="line">    <span class="keywordflow">return</span> EXIT_FAILURE;</div><div class="line">  }</div><div class="line"></div><div class="line">  <span class="keywordflow">if</span> (!<a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/BGL.tag:../BGL/" href="../BGL/group__PkgBGLHelperFct.html#ga11883d231eec1b58f37efe4acedd9588">CGAL::is_triangle_mesh</a>(polyhedron)){</div><div class="line">    std::cerr &lt;&lt; <span class="stringliteral">"Input geometry is not triangulated."</span> &lt;&lt; std::endl;</div><div class="line">    <span class="keywordflow">return</span> EXIT_FAILURE;</div><div class="line">  }</div><div class="line"></div><div class="line">  <span class="comment">// Create domain</span></div><div class="line">  Mesh_domain domain(polyhedron);</div><div class="line"></div><div class="line">  <span class="comment">// Get sharp features</span></div><div class="line">  domain.detect_features();</div><div class="line"></div><div class="line">  <span class="comment">// Create Lipschitz sizing field</span></div><div class="line">  Lip_sizing lip_sizing(domain, &amp;domain.aabb_tree());</div><div class="line"></div><div class="line">  FT min_size = 0.02;</div><div class="line">  lip_sizing.add_parameters_for_subdomain(1,       <span class="comment">//subdomain id</span></div><div class="line">                                          0.3,     <span class="comment">//k</span></div><div class="line">                                          min_size,<span class="comment">//min_size</span></div><div class="line">                                          0.5);    <span class="comment">//max_size</span></div><div class="line"></div><div class="line">  <span class="comment">// Mesh criteria</span></div><div class="line">  Mesh_criteria criteria(edge_size = min_size,</div><div class="line">                         facet_angle = 25,</div><div class="line">                         facet_size = min_size,</div><div class="line">                         facet_distance = 0.005,</div><div class="line">                         cell_radius_edge_ratio = 3,</div><div class="line">                         cell_size = lip_sizing);</div><div class="line">  <span class="comment">// Mesh generation</span></div><div class="line">  C3t3 c3t3 = CGAL::make_mesh_3&lt;C3t3&gt;(domain, criteria);</div><div class="line"></div><div class="line">  <span class="comment">// Output</span></div><div class="line">  std::ofstream medit_file(<span class="stringliteral">"out.mesh"</span>);</div><div class="line">  c3t3.output_to_medit(medit_file);</div><div class="line"></div><div class="line">  <span class="keywordflow">return</span> EXIT_SUCCESS;</div><div class="line">}</div></div><!-- fragment --><p><a class="anchor" id="fig__figurefandisk_lip_sizing"></a></p><div class="image">
<img src="fandisk_lip.jpg" alt="fandisk_lip.jpg" />
</div>
   <div class="cgal_figure_caption">  <a class="el" href="index.html#fig__figurefandisk_lip_sizing">Figure 55.16</a> View of a 3D mesh produced with a Lipschitz sizing field, for a single subdomain. Code from subsection <a class="el" href="index.html#Mesh_3_subsubsection_examples_3d_image_lip_sizing">Mesh_3_subsubsection_examples_3d_image_lip_sizing</a> generates this mesh.  </div>  <br />

<h2><a class="anchor" id="Mesh_3MeshingDomainswithSharpFeatures"></a>
Meshing Domains with Sharp Features</h2>
<p><a class="anchor" id="Mesh_3_subsection_example_polyhedral_with_edges"></a> </p>
<h3><a class="anchor" id="Mesh_33DPolyhedralDomainwithEdges"></a>
3D Polyhedral Domain with Edges</h3>
<p>The following example shows how to generate a mesh from a polyhedral surface. The output mesh conforms to the sharp features of the input surface.</p>
<p><br />
<b>File</b> <a class="el" href="Mesh_3_2mesh_polyhedral_domain_with_features_8cpp-example.html">Mesh_3/mesh_polyhedral_domain_with_features.cpp</a> </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;CGAL/Exact_predicates_inexact_constructions_kernel.h&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Mesh_triangulation_3.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Mesh_complex_3_in_triangulation_3.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Mesh_criteria_3.h&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Polyhedral_mesh_domain_with_features_3.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/make_mesh_3.h&gt;</span></div><div class="line"></div><div class="line"><span class="comment">// Domain </span></div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Kernel_23.tag:../Kernel_23/" href="../Kernel_23/classCGAL_1_1Exact__predicates__inexact__constructions__kernel.html">CGAL::Exact_predicates_inexact_constructions_kernel</a> K;</div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Manual.tag:../Manual/" href="../Manual/classunspecified__type.html">CGAL::Mesh_polyhedron_3&lt;K&gt;::type</a> Polyhedron;</div><div class="line"><span class="keyword">typedef</span> <a class="code" href="classCGAL_1_1Polyhedral__mesh__domain__with__features__3.html">CGAL::Polyhedral_mesh_domain_with_features_3&lt;K&gt;</a> Mesh_domain;</div><div class="line"></div><div class="line"></div><div class="line"><span class="preprocessor">#ifdef CGAL_CONCURRENT_MESH_3</span></div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/STL_Extension.tag:../STL_Extension/" href="../STL_Extension/structCGAL_1_1Parallel__tag.html">CGAL::Parallel_tag</a> Concurrency_tag;</div><div class="line"><span class="preprocessor">#else</span></div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/STL_Extension.tag:../STL_Extension/" href="../STL_Extension/structCGAL_1_1Sequential__tag.html">CGAL::Sequential_tag</a> Concurrency_tag;</div><div class="line"><span class="preprocessor">#endif</span></div><div class="line"></div><div class="line"><span class="comment">// Triangulation</span></div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Manual.tag:../Manual/" href="../Manual/classunspecified__type.html">CGAL::Mesh_triangulation_3&lt;Mesh_domain,CGAL::Default,Concurrency_tag&gt;::type</a> Tr;</div><div class="line"></div><div class="line"><span class="keyword">typedef</span> <a class="code" href="classCGAL_1_1Mesh__complex__3__in__triangulation__3.html">CGAL::Mesh_complex_3_in_triangulation_3</a>&lt;</div><div class="line">  Tr,Mesh_domain::Corner_index,Mesh_domain::Curve_index&gt; C3t3;</div><div class="line"></div><div class="line"><span class="comment">// Criteria</span></div><div class="line"><span class="keyword">typedef</span> <a class="code" href="classCGAL_1_1Mesh__criteria__3.html">CGAL::Mesh_criteria_3&lt;Tr&gt;</a> Mesh_criteria;</div><div class="line"></div><div class="line"><span class="comment">// To avoid verbose function and named parameters call</span></div><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespaceCGAL_1_1parameters.html">CGAL::parameters</a>;</div><div class="line"></div><div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>*argv[])</div><div class="line">{</div><div class="line">  <span class="keyword">const</span> <span class="keywordtype">char</span>* fname = (argc&gt;1)?argv[1]:<span class="stringliteral">"data/fandisk.off"</span>;</div><div class="line">  std::ifstream input(fname);</div><div class="line">  Polyhedron polyhedron;</div><div class="line">  input &gt;&gt; polyhedron;</div><div class="line">  <span class="keywordflow">if</span>(input.fail()){</div><div class="line">    std::cerr &lt;&lt; <span class="stringliteral">"Error: Cannot read file "</span> &lt;&lt;  fname &lt;&lt; std::endl;</div><div class="line">    <span class="keywordflow">return</span> EXIT_FAILURE;</div><div class="line">  }</div><div class="line"></div><div class="line">  <span class="keywordflow">if</span> (!<a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/BGL.tag:../BGL/" href="../BGL/group__PkgBGLHelperFct.html#ga11883d231eec1b58f37efe4acedd9588">CGAL::is_triangle_mesh</a>(polyhedron)){</div><div class="line">    std::cerr &lt;&lt; <span class="stringliteral">"Input geometry is not triangulated."</span> &lt;&lt; std::endl;</div><div class="line">    <span class="keywordflow">return</span> EXIT_FAILURE;</div><div class="line">  }</div><div class="line"></div><div class="line">  <span class="comment">// Create domain</span></div><div class="line">  Mesh_domain domain(polyhedron);</div><div class="line">  </div><div class="line">  <span class="comment">// Get sharp features</span></div><div class="line">  domain.detect_features();</div><div class="line"></div><div class="line">  <span class="comment">// Mesh criteria</span></div><div class="line">  Mesh_criteria criteria(edge_size = 0.025,</div><div class="line">                         facet_angle = 25, facet_size = 0.05, facet_distance = 0.005,</div><div class="line">                         cell_radius_edge_ratio = 3, cell_size = 0.05);</div><div class="line">  </div><div class="line">  <span class="comment">// Mesh generation</span></div><div class="line">  C3t3 c3t3 = CGAL::make_mesh_3&lt;C3t3&gt;(domain, criteria);</div><div class="line"></div><div class="line">  <span class="comment">// Output</span></div><div class="line">  std::ofstream medit_file(<span class="stringliteral">"out.mesh"</span>);</div><div class="line">  c3t3.output_to_medit(medit_file);</div><div class="line"></div><div class="line">  <span class="keywordflow">return</span> EXIT_SUCCESS;</div><div class="line">}</div></div><!-- fragment --><p><a class="anchor" id="fig__figurefandisk_mesh"></a></p><div class="image">
<img src="fandisk.jpg" alt="fandisk.jpg" />
</div>
   <div class="cgal_figure_caption">  <a class="el" href="index.html#fig__figurefandisk_mesh">Figure 55.17</a> View of a 3D mesh with sharp features. Code from subsection <a class="el" href="index.html#Mesh_3_subsection_example_polyhedral_with_edges">Mesh_3_subsection_example_polyhedral_with_edges</a> generates this mesh.  </div>  <br />

<h3><a class="anchor" id="Mesh_3ImplicitDomainWith1DFeatures"></a>
Implicit Domain With 1D Features</h3>
<p>The following example shows how to generate a mesh from an implicit domain. We add by hand the intersection of the spheres as a sharp feature.</p>
<p><br />
<b>File</b> <a class="el" href="Mesh_3_2mesh_two_implicit_spheres_with_balls_8cpp-example.html">Mesh_3/mesh_two_implicit_spheres_with_balls.cpp</a> </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;CGAL/Exact_predicates_inexact_constructions_kernel.h&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Mesh_triangulation_3.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Mesh_complex_3_in_triangulation_3.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Mesh_criteria_3.h&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Labeled_mesh_domain_3.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Mesh_domain_with_polyline_features_3.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/make_mesh_3.h&gt;</span></div><div class="line"></div><div class="line"><span class="comment">// Kernel</span></div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Kernel_23.tag:../Kernel_23/" href="../Kernel_23/classCGAL_1_1Exact__predicates__inexact__constructions__kernel.html">CGAL::Exact_predicates_inexact_constructions_kernel</a> K;</div><div class="line"></div><div class="line"><span class="comment">// Domain</span></div><div class="line"><span class="keyword">typedef</span> K::FT FT;</div><div class="line"><span class="keyword">typedef</span> K::Point_3 Point;</div><div class="line"><span class="keyword">typedef</span> FT (Function)(<span class="keyword">const</span> Point&amp;);</div><div class="line"><span class="keyword">typedef</span> <a class="code" href="classCGAL_1_1Mesh__domain__with__polyline__features__3.html">CGAL::Mesh_domain_with_polyline_features_3</a>&lt;</div><div class="line">  <a class="code" href="classCGAL_1_1Labeled__mesh__domain__3.html">CGAL::Labeled_mesh_domain_3&lt;K&gt;</a> &gt; Mesh_domain;</div><div class="line"></div><div class="line"><span class="comment">// Polyline</span></div><div class="line"><span class="keyword">typedef</span> std::vector&lt;Point&gt;        Polyline_3;</div><div class="line"><span class="keyword">typedef</span> std::list&lt;Polyline_3&gt;       Polylines;</div><div class="line"></div><div class="line"><span class="preprocessor">#ifdef CGAL_CONCURRENT_MESH_3</span></div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/STL_Extension.tag:../STL_Extension/" href="../STL_Extension/structCGAL_1_1Parallel__tag.html">CGAL::Parallel_tag</a> Concurrency_tag;</div><div class="line"><span class="preprocessor">#else</span></div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/STL_Extension.tag:../STL_Extension/" href="../STL_Extension/structCGAL_1_1Sequential__tag.html">CGAL::Sequential_tag</a> Concurrency_tag;</div><div class="line"><span class="preprocessor">#endif</span></div><div class="line"></div><div class="line"><span class="comment">// Triangulation</span></div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Manual.tag:../Manual/" href="../Manual/classunspecified__type.html">CGAL::Mesh_triangulation_3&lt;Mesh_domain,CGAL::Default,Concurrency_tag&gt;::type</a> Tr;</div><div class="line"></div><div class="line"><span class="keyword">typedef</span> <a class="code" href="classCGAL_1_1Mesh__complex__3__in__triangulation__3.html">CGAL::Mesh_complex_3_in_triangulation_3</a>&lt;</div><div class="line">  Tr,Mesh_domain::Corner_index,Mesh_domain::Curve_index&gt; C3t3;</div><div class="line"></div><div class="line"><span class="comment">// Criteria</span></div><div class="line"><span class="keyword">typedef</span> <a class="code" href="classCGAL_1_1Mesh__criteria__3.html">CGAL::Mesh_criteria_3&lt;Tr&gt;</a> Mesh_criteria;</div><div class="line"></div><div class="line"><span class="comment">// To avoid verbose function and named parameters call</span></div><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespaceCGAL_1_1parameters.html">CGAL::parameters</a>;</div><div class="line"></div><div class="line"><span class="comment">// Function</span></div><div class="line">FT sphere_function1 (<span class="keyword">const</span> Point&amp; p)</div><div class="line">{ <span class="keywordflow">return</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Kernel_23.tag:../Kernel_23/" href="../Kernel_23/group__squared__distance__grp.html#ga1ff73525660a052564d33fbdd61a4f71">CGAL::squared_distance</a>(p, Point(<a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Kernel_23.tag:../Kernel_23/" href="../Kernel_23/group__kernel__enums.html#ga9d272a8e3a8080b851741b6d3a44afdc">CGAL::ORIGIN</a>))-2; }</div><div class="line"></div><div class="line">FT sphere_function2 (<span class="keyword">const</span> Point&amp; p)</div><div class="line">{ <span class="keywordflow">return</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Kernel_23.tag:../Kernel_23/" href="../Kernel_23/group__squared__distance__grp.html#ga1ff73525660a052564d33fbdd61a4f71">CGAL::squared_distance</a>(p, Point(2, 0, 0))-2; }</div><div class="line"></div><div class="line">FT sphere_function (<span class="keyword">const</span> Point&amp; p)</div><div class="line">{</div><div class="line">  <span class="keywordflow">if</span>(sphere_function1(p) &lt; 0 || sphere_function2(p) &lt; 0)</div><div class="line">    <span class="keywordflow">return</span> -1;</div><div class="line">  <span class="keywordflow">else</span></div><div class="line">    <span class="keywordflow">return</span> 1;</div><div class="line">}</div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;cmath&gt;</span></div><div class="line"></div><div class="line"><span class="keywordtype">int</span> main()</div><div class="line">{</div><div class="line">  <span class="comment">// Domain (Warning: Sphere_3 constructor uses squared radius !)</span></div><div class="line">  Mesh_domain domain =</div><div class="line">    Mesh_domain::create_implicit_mesh_domain(sphere_function,</div><div class="line">                                             K::Sphere_3(Point(1, 0, 0), 6.));</div><div class="line"></div><div class="line">  <span class="comment">// Mesh criteria</span></div><div class="line">  Mesh_criteria criteria(edge_size = 0.15,</div><div class="line">                         facet_angle = 25, facet_size = 0.15,</div><div class="line">                         cell_radius_edge_ratio = 2, cell_size = 0.15);</div><div class="line"></div><div class="line">  <span class="comment">// Create edge that we want to preserve</span></div><div class="line">  Polylines polylines (1);</div><div class="line">  Polyline_3&amp; polyline = polylines.front();</div><div class="line"></div><div class="line">  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; 360; ++i)</div><div class="line">  {</div><div class="line">    Point p (1, std::cos(i*CGAL_PI/180), std::sin(i*CGAL_PI/180));</div><div class="line">    polyline.push_back(p);</div><div class="line">  }</div><div class="line">  polyline.push_back(polyline.front()); <span class="comment">// close the line</span></div><div class="line"></div><div class="line">  <span class="comment">// Insert edge in domain</span></div><div class="line">  domain.add_features(polylines.begin(), polylines.end());</div><div class="line"></div><div class="line">  <span class="comment">// Mesh generation without feature preservation</span></div><div class="line">  C3t3 c3t3 = CGAL::make_mesh_3&lt;C3t3&gt;(domain, criteria,</div><div class="line">                                      <a class="code" href="group__PkgMesh__3Parameters.html#gaa3eb2cb65200b0331ef9d5f14b4a0535">CGAL::parameters::no_features</a>());</div><div class="line"></div><div class="line">  std::ofstream medit_file(<span class="stringliteral">"out-no-protection.mesh"</span>);</div><div class="line">  c3t3.output_to_medit(medit_file);</div><div class="line">  medit_file.close();</div><div class="line">  c3t3.clear();</div><div class="line"></div><div class="line">  <span class="comment">// Mesh generation with feature preservation</span></div><div class="line">  c3t3 = CGAL::make_mesh_3&lt;C3t3&gt;(domain, criteria);</div><div class="line"></div><div class="line">  <span class="comment">// Output</span></div><div class="line">  medit_file.open(<span class="stringliteral">"out-with-protection.mesh"</span>);</div><div class="line">  c3t3.output_to_medit(medit_file);</div><div class="line">  medit_file.close();</div><div class="line"></div><div class="line">  <span class="keywordflow">return</span> 0;</div><div class="line">}</div></div><!-- fragment --><p><a class="anchor" id="fig__figuretwo_spheres_mesh"></a></p><div class="image">
<img src="twospheres.jpg" alt="twospheres.jpg" />
</div>
   <div class="cgal_figure_caption">  <a class="el" href="index.html#fig__figuretwo_spheres_mesh">Figure 55.18</a> View of a 3D mesh with sharp features generated from two intersected implicit spheres. On the left, one can see the mesh without feature preservation, and on the right the mesh with feature preservation.  </div>  <br />

<h3><a class="anchor" id="Mesh_3DomainsFromSegmented3DImagesWithFeatures"></a>
Domains from Segmented 3D Images, with 1D Features</h3>
<p>The example <a class="el" href="Mesh_3_2mesh_3D_image_with_features_8cpp-example.html">Mesh_3/mesh_3D_image_with_features.cpp</a> is a modification of <a class="el" href="Mesh_3_2mesh_3D_image_8cpp-example.html">Mesh_3/mesh_3D_image.cpp</a>. That example shows how to generate a mesh from a 3D labeled image (also known as "a segmented image"), that has 2D surfaces that intersect the box corresponding to the boundary of the image. The intersection of the 2D surface with the bounding box of the image is composed of 1D curves, and must be defined as 1D-features in the domain.</p>
<p>The first modification is the type of the mesh domain. Instead of being <code><a class="el" href="classCGAL_1_1Labeled__mesh__domain__3.html" title="The class Labeled_mesh_domain_3 implements indexed domains. ">Labeled_mesh_domain_3</a></code>, it is a <code><a class="el" href="classCGAL_1_1Mesh__domain__with__polyline__features__3.html" title="The class Mesh_domain_with_polyline_features_3 is designed to allow the user to add some 0- and 1-dim...">Mesh_domain_with_polyline_features_3</a></code> templated by a <code><a class="el" href="classCGAL_1_1Labeled__mesh__domain__3.html" title="The class Labeled_mesh_domain_3 implements indexed domains. ">Labeled_mesh_domain_3</a></code>.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;CGAL/Exact_predicates_inexact_constructions_kernel.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Mesh_domain_with_polyline_features_3.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Labeled_mesh_domain_3.h&gt;</span></div><div class="line"></div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Kernel_23.tag:../Kernel_23/" href="../Kernel_23/classCGAL_1_1Exact__predicates__inexact__constructions__kernel.html">CGAL::Exact_predicates_inexact_constructions_kernel</a> K;</div><div class="line"><span class="keyword">typedef</span> <a class="code" href="classCGAL_1_1Labeled__mesh__domain__3.html">CGAL::Labeled_mesh_domain_3&lt;K&gt;</a> Image_domain;</div><div class="line"><span class="keyword">typedef</span> <a class="code" href="classCGAL_1_1Mesh__domain__with__polyline__features__3.html">CGAL::Mesh_domain_with_polyline_features_3&lt;Image_domain&gt;</a> Mesh_domain;</div></div><!-- fragment --><p> Then, in the function <code>main()</code>, after the <code>domain</code> object has been created, a dedicated function computes the 1D-features, and adds them to the domain.</p>
<div class="fragment"><div class="line">  <span class="keyword">const</span> <span class="keywordtype">char</span>* lines_fname = (argc&gt;2)?argv[2]:<span class="stringliteral">"data/420.polylines.txt"</span>;</div><div class="line"></div><div class="line">  <span class="keywordflow">if</span>(!add_1D_features(image, domain, lines_fname)) {</div><div class="line">    <span class="keywordflow">return</span> EXIT_FAILURE;</div><div class="line">  }</div></div><!-- fragment --><p> The function template <code>add_1D_features()</code> is defined in the example file. It uses non-documented code from CGAL, that should be copy-pasted in any user-code willing to use similar code. It uses the undocumented function template <code>CGAL::polylines_to_protect</code> that computes the 1D-features that correspond to the intersection of the bounding box of the image with the surfaces defined by the image. At the same time, a few other polylines are added as 1D-features, to protect 1D curves in the interior of the image. Then, the method <code><a class="el" href="classCGAL_1_1Mesh__domain__with__polyline__features__3.html#a364109e2a07e005e27cab30cfa334f02" title="Add 1-dimensional features in the domain. ">CGAL::Mesh_domain_with_polyline_features_3::add_features</a></code> is called twice to add the computed 1D-features to the mesh domain.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include "read_polylines.h"</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Mesh_3/polylines_to_protect.h&gt;</span> <span class="comment">// undocumented header</span></div><div class="line"></div><div class="line"><span class="comment">// Protect the intersection of the object with the box of the image,</span></div><div class="line"><span class="comment">// by declaring 1D-features. Note that `CGAL::polylines_to_protect` is</span></div><div class="line"><span class="comment">// not documented.</span></div><div class="line"><span class="keywordtype">bool</span> add_1D_features(<span class="keyword">const</span> <a class="code" href="classCGAL_1_1Image__3.html">CGAL::Image_3</a>&amp; image,</div><div class="line">                     Mesh_domain&amp; domain,</div><div class="line">                     <span class="keyword">const</span> <span class="keywordtype">char</span>* lines_fname)</div><div class="line">{</div><div class="line">  <span class="keyword">typedef</span> K::Point_3 Point_3;</div><div class="line">  <span class="keyword">typedef</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> Word_type;</div><div class="line"></div><div class="line">  std::vector&lt;std::vector&lt;Point_3&gt; &gt; features_inside;</div><div class="line">  <span class="keywordflow">if</span>(!read_polylines(lines_fname, features_inside)) <span class="comment">// see file "read_polylines.h"</span></div><div class="line">  {</div><div class="line">    std::cerr &lt;&lt; <span class="stringliteral">"Error: Cannot read file "</span> &lt;&lt;  lines_fname &lt;&lt; std::endl;</div><div class="line">    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line">  }</div><div class="line"></div><div class="line">  std::vector&lt;std::vector&lt;Point_3&gt; &gt; polylines_on_bbox;</div><div class="line">  CGAL::polylines_to_protect&lt;Point_3, Word_type&gt;(image, polylines_on_bbox,</div><div class="line">                                                 features_inside.begin(),</div><div class="line">                                                 features_inside.end());</div><div class="line"></div><div class="line">  domain.add_features(polylines_on_bbox.begin(), polylines_on_bbox.end());</div><div class="line"></div><div class="line">  <span class="comment">// It is very important that the polylines from the file `lines_fname`</span></div><div class="line">  <span class="comment">// contain only polylines in the inside of the box of the image.</span></div><div class="line">  domain.add_features(features_inside.begin(), features_inside.end());</div><div class="line">  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line">}</div></div><!-- fragment --><p> In the meshing criteria, if 1D features are added to the domain, the user can define the parameter <code>edge_size</code> of the criteria class <code><a class="el" href="classCGAL_1_1Mesh__criteria__3.html" title="The class Mesh_criteria_3 is a model of both concepts MeshCriteria_3 and MeshCriteriaWithFeatures_3. ">Mesh_criteria_3</a></code>, as follows, to set up an upper bound on the length of the edges of the 1D-mesh corresponding to the 1D-features.</p>
<div class="fragment"><div class="line">  Mesh_criteria criteria(edge_size=6,</div><div class="line">                         facet_angle=30, facet_size=6, facet_distance=4,</div><div class="line">                         cell_radius_edge_ratio=3, cell_size=8);</div></div><!-- fragment --><p> The rest of the example is similar to <a class="el" href="Mesh_3_2mesh_3D_image_8cpp-example.html">Mesh_3/mesh_3D_image.cpp</a>.</p>
<p><a class="el" href="index.html#fig__mesh3protectionimage3D">Figure 55.19</a> shows the results without or with the protection of the 1D-features.</p>
<p><a class="anchor" id="fig__mesh3protectionimage3D"></a></p><center> <table border="0">
<tr>
<td><div class="image">
<img src="./no-protection.png" border="0" />
</div>
 </td><td><div class="image">
<img src="./protection-box.png" border="0" />
</div>
 </td><td><div class="image">
<img src="./protection-all.png" border="0" />
</div>
  </td></tr>
</table>
</center><p>  </p><div class="cgal_figure_caption">  <a class="el" href="index.html#fig__mesh3protectionimage3D">Figure 55.19</a> Left: the mesh without any call to <code>add_features()</code>.
<p>Middle: the mesh with only the 1D-features computed by <code>CGAL::polylines_to_protect()</code>.</p>
<p>Right: the mesh with added 1D-features in the interior of the bounding box of the image.  </p></div>  <br />

<h3><a class="anchor" id="Mesh_3PolyhedralComplex"></a>
Polyhedral Complex</h3>
<p>The following example shows how to generate a mesh from a polyhedral complex that forms a bounded domain. The domain is defined by a group of polyhedral surfaces that are conformal. For each facet of the input polyhedral surfaces, the ids of incident subdomains are known. The input surfaces intersect along polylines that are considered as sharp features, and protected as for all domain types in this Section.</p>
<p><br />
<b>File</b> <a class="el" href="Mesh_3_2mesh_polyhedral_complex_8cpp-example.html">Mesh_3/mesh_polyhedral_complex.cpp</a> </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;CGAL/Exact_predicates_inexact_constructions_kernel.h&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Mesh_triangulation_3.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Mesh_complex_3_in_triangulation_3.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Mesh_criteria_3.h&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Polyhedral_complex_mesh_domain_3.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/make_mesh_3.h&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;cstdlib&gt;</span></div><div class="line"></div><div class="line"><span class="comment">// Domain</span></div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Kernel_23.tag:../Kernel_23/" href="../Kernel_23/classCGAL_1_1Exact__predicates__inexact__constructions__kernel.html">CGAL::Exact_predicates_inexact_constructions_kernel</a> K;</div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Manual.tag:../Manual/" href="../Manual/classunspecified__type.html">CGAL::Mesh_polyhedron_3&lt;K&gt;::type</a> Polyhedron;</div><div class="line"><span class="keyword">typedef</span> <a class="code" href="classCGAL_1_1Polyhedral__complex__mesh__domain__3.html">CGAL::Polyhedral_complex_mesh_domain_3&lt;K&gt;</a> Mesh_domain;</div><div class="line"></div><div class="line"></div><div class="line"><span class="preprocessor">#ifdef CGAL_CONCURRENT_MESH_3</span></div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/STL_Extension.tag:../STL_Extension/" href="../STL_Extension/structCGAL_1_1Parallel__tag.html">CGAL::Parallel_tag</a> Concurrency_tag;</div><div class="line"><span class="preprocessor">#else</span></div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/STL_Extension.tag:../STL_Extension/" href="../STL_Extension/structCGAL_1_1Sequential__tag.html">CGAL::Sequential_tag</a> Concurrency_tag;</div><div class="line"><span class="preprocessor">#endif</span></div><div class="line"></div><div class="line"><span class="comment">// Triangulation</span></div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Manual.tag:../Manual/" href="../Manual/classunspecified__type.html">CGAL::Mesh_triangulation_3&lt;Mesh_domain,CGAL::Default,Concurrency_tag&gt;::type</a> Tr;</div><div class="line"></div><div class="line"><span class="keyword">typedef</span> <a class="code" href="classCGAL_1_1Mesh__complex__3__in__triangulation__3.html">CGAL::Mesh_complex_3_in_triangulation_3</a>&lt;</div><div class="line">  Tr,Mesh_domain::Corner_index,Mesh_domain::Curve_index&gt; C3t3;</div><div class="line"></div><div class="line"><span class="comment">// Criteria</span></div><div class="line"><span class="keyword">typedef</span> <a class="code" href="classCGAL_1_1Mesh__criteria__3.html">CGAL::Mesh_criteria_3&lt;Tr&gt;</a> Mesh_criteria;</div><div class="line"></div><div class="line"><span class="comment">// To avoid verbose function and named parameters call</span></div><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespaceCGAL_1_1parameters.html">CGAL::parameters</a>;</div><div class="line"></div><div class="line"><span class="keyword">const</span> <span class="keywordtype">char</span>* <span class="keyword">const</span> filenames[] = {</div><div class="line">  <span class="stringliteral">"data/patches/patch-01.off"</span>,</div><div class="line">  <span class="stringliteral">"data/patches/patch-13.off"</span>,</div><div class="line">  <span class="stringliteral">"data/patches/patch-20.off"</span>,</div><div class="line">  <span class="stringliteral">"data/patches/patch-21.off"</span>,</div><div class="line">  <span class="stringliteral">"data/patches/patch-23.off"</span>,</div><div class="line">  <span class="stringliteral">"data/patches/patch-30.off"</span>,</div><div class="line">};</div><div class="line"></div><div class="line"><span class="keyword">const</span> std::pair&lt;int, int&gt; incident_subdomains[] = {</div><div class="line">  std::make_pair(0, 1),</div><div class="line">  std::make_pair(1, 3),</div><div class="line">  std::make_pair(2, 0),</div><div class="line">  std::make_pair(2, 1),</div><div class="line">  std::make_pair(2, 3),</div><div class="line">  std::make_pair(3, 0),</div><div class="line">};</div><div class="line"></div><div class="line"><span class="keywordtype">int</span> main()</div><div class="line">{</div><div class="line">  <span class="keyword">const</span> std::size_t nb_patches = <span class="keyword">sizeof</span>(filenames) / <span class="keyword">sizeof</span>(<span class="keyword">const</span> <span class="keywordtype">char</span>*);</div><div class="line">  CGAL_assertion(<span class="keyword">sizeof</span>(incident_subdomains) ==</div><div class="line">                 nb_patches * <span class="keyword">sizeof</span>(std::pair&lt;int, int&gt;));</div><div class="line">  std::vector&lt;Polyhedron&gt; patches(nb_patches);</div><div class="line">  <span class="keywordflow">for</span>(std::size_t i = 0; i &lt; nb_patches; ++i) {</div><div class="line">    std::ifstream input(filenames[i]);</div><div class="line">    <span class="keywordflow">if</span>(!(input &gt;&gt; patches[i])) {</div><div class="line">      std::cerr &lt;&lt; <span class="stringliteral">"Error reading "</span> &lt;&lt; filenames[i] &lt;&lt; <span class="stringliteral">" as a polyhedron!\n"</span>;</div><div class="line">      <span class="keywordflow">return</span> EXIT_FAILURE;</div><div class="line">    }</div><div class="line">  }</div><div class="line">  <span class="comment">// Create domain</span></div><div class="line">  Mesh_domain domain(patches.begin(), patches.end(),</div><div class="line">                     incident_subdomains, incident_subdomains+nb_patches);</div><div class="line"></div><div class="line">  domain.detect_features(); <span class="comment">//includes detection of borders</span></div><div class="line"></div><div class="line">  <span class="comment">// Mesh criteria</span></div><div class="line">  Mesh_criteria criteria(edge_size = 8,</div><div class="line">                         facet_angle = 25, facet_size = 8, facet_distance = 0.2,</div><div class="line">                         cell_radius_edge_ratio = 3, cell_size = 10);</div><div class="line"></div><div class="line">  <span class="comment">// Mesh generation</span></div><div class="line">  C3t3 c3t3 = CGAL::make_mesh_3&lt;C3t3&gt;(domain, criteria);</div><div class="line"></div><div class="line">  <span class="comment">// Output</span></div><div class="line">  std::ofstream medit_file(<span class="stringliteral">"out.mesh"</span>);</div><div class="line">  c3t3.output_to_medit(medit_file);</div><div class="line"></div><div class="line">  <span class="keywordflow">return</span> EXIT_SUCCESS;</div><div class="line">}</div></div><!-- fragment --><p><a class="el" href="index.html#fig__mesh3protectionComplex">Figure 55.20</a> shows the results without or with the protection of the 1D-features.</p>
<p><a class="anchor" id="fig__mesh3protectionComplex"></a></p><center> <table border="0">
<tr>
<td><div class="image">
<img src="./no-protection-complex.png" border="0" />
</div>
 </td><td><div class="image">
<img src="./protection-complex.png" border="0" />
</div>
  </td></tr>
</table>
</center><p>  </p><div class="cgal_figure_caption">  <a class="el" href="index.html#fig__mesh3protectionComplex">Figure 55.20</a> Left: the mesh without any call to <code>detect_features()</code>. The mesh is overrefined next to sharp features, because the mesher tries to reach the target <code>facet_distance</code>, by inserting centers of surface Delaunay balls, that are not likely to be on sharp edges.
<p>Right: the mesh with added 1D-features along sharp edges and edges shared by at least two of the input polyhedral surfaces forming the complex.  </p></div>  <br />

<h2><a class="anchor" id="Mesh_3TuningMeshOptimization"></a>
Tuning Mesh Optimization</h2>
<p><a class="anchor" id="Mesh_3_subsection_examples_optimization"></a> In the previous examples, the mesh generation is launched through a call <code><a class="el" href="group__PkgMesh__3Functions.html#ga1ee73dc372985c6aeef85f2415fac0ba" title="The function make_mesh_3() is a 3D mesh generator. ">make_mesh_3()</a></code> with a minimal number of parameters. In such cases, the default optimization strategy is applied: after the Delaunay refinement process two optimization steps are performed, a perturbation and a sliver exudation. The following examples show how to disable default optimization steps and how to tune the parameters of optimization steps.</p>
<h3><a class="anchor" id="Mesh_3DisablingExudationandTuningPerturbation"></a>
Disabling Exudation and Tuning Perturbation</h3>
<p>In this first example, we show how to disable the exudation step. The optimization phase after the refinement includes only a perturbation phase which is launched with no time bound and an objective of 10 degrees for the minimum dihedral angle of the mesh. The example shows two ways of achieving the same result. The first way issues a single call to <code><a class="el" href="group__PkgMesh__3Functions.html#ga1ee73dc372985c6aeef85f2415fac0ba" title="The function make_mesh_3() is a 3D mesh generator. ">make_mesh_3()</a></code> with the required optimization process activated and tuned. In the second way, <code><a class="el" href="group__PkgMesh__3Functions.html#ga1ee73dc372985c6aeef85f2415fac0ba" title="The function make_mesh_3() is a 3D mesh generator. ">make_mesh_3()</a></code> is first called without any optimization process and the resulting mesh is next optimized through a call to <code><a class="el" href="group__PkgMesh__3Functions.html#ga1663c4db53ad4fd91c889be96576842a" title="The function perturb_mesh_3() is a mesh optimizer that improves the quality of a Delaunay mesh by cha...">perturb_mesh_3()</a></code> with tuned parameters.</p>
<p><br />
<b>File</b> <a class="el" href="Mesh_3_2mesh_optimization_example_8cpp-example.html">Mesh_3/mesh_optimization_example.cpp</a> </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;CGAL/Exact_predicates_inexact_constructions_kernel.h&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Mesh_triangulation_3.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Mesh_complex_3_in_triangulation_3.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Mesh_criteria_3.h&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Labeled_mesh_domain_3.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/make_mesh_3.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Image_3.h&gt;</span></div><div class="line"></div><div class="line"><span class="comment">// Domain</span></div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Kernel_23.tag:../Kernel_23/" href="../Kernel_23/classCGAL_1_1Exact__predicates__inexact__constructions__kernel.html">CGAL::Exact_predicates_inexact_constructions_kernel</a> K;</div><div class="line"><span class="keyword">typedef</span> <a class="code" href="classCGAL_1_1Labeled__mesh__domain__3.html">CGAL::Labeled_mesh_domain_3&lt;K&gt;</a> Mesh_domain;</div><div class="line"></div><div class="line"><span class="preprocessor">#ifdef CGAL_CONCURRENT_MESH_3</span></div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/STL_Extension.tag:../STL_Extension/" href="../STL_Extension/structCGAL_1_1Parallel__tag.html">CGAL::Parallel_tag</a> Concurrency_tag;</div><div class="line"><span class="preprocessor">#else</span></div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/STL_Extension.tag:../STL_Extension/" href="../STL_Extension/structCGAL_1_1Sequential__tag.html">CGAL::Sequential_tag</a> Concurrency_tag;</div><div class="line"><span class="preprocessor">#endif</span></div><div class="line"></div><div class="line"><span class="comment">// Triangulation</span></div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Manual.tag:../Manual/" href="../Manual/classunspecified__type.html">CGAL::Mesh_triangulation_3&lt;Mesh_domain,CGAL::Default,Concurrency_tag&gt;::type</a> Tr;</div><div class="line"></div><div class="line"><span class="keyword">typedef</span> <a class="code" href="classCGAL_1_1Mesh__complex__3__in__triangulation__3.html">CGAL::Mesh_complex_3_in_triangulation_3&lt;Tr&gt;</a> C3t3;</div><div class="line"></div><div class="line"><span class="comment">// Mesh Criteria</span></div><div class="line"><span class="keyword">typedef</span> <a class="code" href="classCGAL_1_1Mesh__criteria__3.html">CGAL::Mesh_criteria_3&lt;Tr&gt;</a> Mesh_criteria;</div><div class="line"></div><div class="line"><span class="comment">// To avoid verbose function and named parameters call</span></div><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespaceCGAL_1_1parameters.html">CGAL::parameters</a>;</div><div class="line"></div><div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>* argv[])</div><div class="line">{</div><div class="line">  <span class="keyword">const</span> <span class="keywordtype">char</span>* fname = (argc&gt;1)?argv[1]:<span class="stringliteral">"data/liver.inr.gz"</span>;</div><div class="line">  <span class="comment">// Domain</span></div><div class="line">  <a class="code" href="classCGAL_1_1Image__3.html">CGAL::Image_3</a> image;</div><div class="line">  <span class="keywordflow">if</span>(!image.<a class="code" href="classCGAL_1_1Image__3.html#a6be029d7a0ee6dbd5eab1fd0adae42ba">read</a>(fname)){</div><div class="line">    std::cerr &lt;&lt; <span class="stringliteral">"Error: Cannot read file "</span> &lt;&lt;  fname &lt;&lt; std::endl;</div><div class="line">    <span class="keywordflow">return</span> EXIT_FAILURE;</div><div class="line">  }</div><div class="line"></div><div class="line">  Mesh_domain domain = Mesh_domain::create_labeled_image_mesh_domain(image);</div><div class="line"></div><div class="line">  <span class="comment">// Mesh criteria</span></div><div class="line">  Mesh_criteria criteria(facet_angle=30, facet_size=5, facet_distance=1.5,</div><div class="line">                         cell_radius_edge_ratio=2, cell_size=7);</div><div class="line"></div><div class="line">  <span class="comment">// Mesh generation and optimization in one call (sliver_bound is the</span></div><div class="line">  <span class="comment">// targeted dihedral angle in degrees)</span></div><div class="line">  C3t3 c3t3 = CGAL::make_mesh_3&lt;C3t3&gt;(domain, criteria,</div><div class="line">                                      <a class="code" href="group__PkgMesh__3Parameters.html#ga0b79c473082a4ec2a45ed1497f3ac873">no_exude</a>(),</div><div class="line">                                      <a class="code" href="group__PkgMesh__3Parameters.html#gaedf18f7f3c4647ec5fce5d67e435757a">perturb</a>(sliver_bound=10, time_limit=15));</div><div class="line"></div><div class="line">  <span class="comment">// Mesh generation and optimization in several call</span></div><div class="line">  C3t3 c3t3_bis = CGAL::make_mesh_3&lt;C3t3&gt;(domain, criteria,</div><div class="line">                                          <a class="code" href="group__PkgMesh__3Parameters.html#ga5714d10decd9eecd30997572b785e03b">no_perturb</a>(), <a class="code" href="group__PkgMesh__3Parameters.html#ga0b79c473082a4ec2a45ed1497f3ac873">no_exude</a>());</div><div class="line"></div><div class="line">  <a class="code" href="group__PkgMesh__3Functions.html#ga1663c4db53ad4fd91c889be96576842a">CGAL::perturb_mesh_3</a>(c3t3_bis, domain, time_limit=15);</div><div class="line"></div><div class="line">  <span class="comment">// Output</span></div><div class="line">  std::ofstream medit_file(<span class="stringliteral">"out.mesh"</span>);</div><div class="line">  c3t3.output_to_medit(medit_file);</div><div class="line"></div><div class="line">  std::ofstream medit_file_bis(<span class="stringliteral">"out_bis.mesh"</span>);</div><div class="line">  c3t3_bis.output_to_medit(medit_file_bis);</div><div class="line"></div><div class="line">  <span class="keywordflow">return</span> 0;</div><div class="line">}</div></div><!-- fragment --><h3><a class="anchor" id="Mesh_3UsingLloydGlobalOptimization"></a>
Using Lloyd Global Optimization</h3>
<p>In this second example, we show how to call the Lloyd optimization on the mesh, followed by a call to exudation. We set a time bound of 30s for the Lloyd optimization. We set a time bound of 10s and a sliver bound of 10 degrees for the exuder.</p>
<p><br />
<b>File</b> <a class="el" href="Mesh_3_2mesh_optimization_lloyd_example_8cpp-example.html">Mesh_3/mesh_optimization_lloyd_example.cpp</a> </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;CGAL/Exact_predicates_inexact_constructions_kernel.h&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Mesh_triangulation_3.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Mesh_complex_3_in_triangulation_3.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Mesh_criteria_3.h&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Labeled_mesh_domain_3.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/make_mesh_3.h&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;CGAL/Image_3.h&gt;</span></div><div class="line"></div><div class="line"><span class="comment">// Domain</span></div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Kernel_23.tag:../Kernel_23/" href="../Kernel_23/classCGAL_1_1Exact__predicates__inexact__constructions__kernel.html">CGAL::Exact_predicates_inexact_constructions_kernel</a> K;</div><div class="line"><span class="keyword">typedef</span> <a class="code" href="classCGAL_1_1Labeled__mesh__domain__3.html">CGAL::Labeled_mesh_domain_3&lt;K&gt;</a> Mesh_domain;</div><div class="line"></div><div class="line"><span class="preprocessor">#ifdef CGAL_CONCURRENT_MESH_3</span></div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/STL_Extension.tag:../STL_Extension/" href="../STL_Extension/structCGAL_1_1Parallel__tag.html">CGAL::Parallel_tag</a> Concurrency_tag;</div><div class="line"><span class="preprocessor">#else</span></div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/STL_Extension.tag:../STL_Extension/" href="../STL_Extension/structCGAL_1_1Sequential__tag.html">CGAL::Sequential_tag</a> Concurrency_tag;</div><div class="line"><span class="preprocessor">#endif</span></div><div class="line"></div><div class="line"><span class="comment">// Triangulation</span></div><div class="line"><span class="keyword">typedef</span> <a class="codeRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Manual.tag:../Manual/" href="../Manual/classunspecified__type.html">CGAL::Mesh_triangulation_3&lt;Mesh_domain,CGAL::Default,Concurrency_tag&gt;::type</a> Tr;</div><div class="line"></div><div class="line"><span class="keyword">typedef</span> <a class="code" href="classCGAL_1_1Mesh__complex__3__in__triangulation__3.html">CGAL::Mesh_complex_3_in_triangulation_3&lt;Tr&gt;</a> C3t3;</div><div class="line"></div><div class="line"><span class="comment">// Mesh Criteria</span></div><div class="line"><span class="keyword">typedef</span> <a class="code" href="classCGAL_1_1Mesh__criteria__3.html">CGAL::Mesh_criteria_3&lt;Tr&gt;</a> Mesh_criteria;</div><div class="line"></div><div class="line"><span class="comment">// To avoid verbose function and named parameters call</span></div><div class="line"><span class="keyword">using namespace </span><a class="code" href="namespaceCGAL_1_1parameters.html">CGAL::parameters</a>;</div><div class="line"></div><div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>*argv[])</div><div class="line">{</div><div class="line">  <span class="keyword">const</span> <span class="keywordtype">char</span>* fname = (argc&gt;1)?argv[1]:<span class="stringliteral">"data/liver.inr.gz"</span>;</div><div class="line">  <span class="comment">// Domain</span></div><div class="line">  <a class="code" href="classCGAL_1_1Image__3.html">CGAL::Image_3</a> image;</div><div class="line">  <span class="keywordflow">if</span>(!image.<a class="code" href="classCGAL_1_1Image__3.html#a6be029d7a0ee6dbd5eab1fd0adae42ba">read</a>(fname)){</div><div class="line">    std::cerr &lt;&lt; <span class="stringliteral">"Error: Cannot read file "</span> &lt;&lt;  fname &lt;&lt; std::endl;</div><div class="line">    <span class="keywordflow">return</span> EXIT_FAILURE;</div><div class="line">  }</div><div class="line">  Mesh_domain domain = Mesh_domain::create_labeled_image_mesh_domain(image);</div><div class="line"></div><div class="line">  <span class="comment">// Mesh criteria</span></div><div class="line">  Mesh_criteria criteria(facet_angle=30, facet_distance=1.2,</div><div class="line">                         cell_radius_edge_ratio=2);</div><div class="line"></div><div class="line">  <span class="comment">// Mesh generation and optimization in one call</span></div><div class="line">  C3t3 c3t3 = CGAL::make_mesh_3&lt;C3t3&gt;(domain, criteria,</div><div class="line">                                      <a class="code" href="group__PkgMesh__3Parameters.html#gaa7254c80bba62400f43f1e49506b975a">lloyd</a>(time_limit=30),</div><div class="line">                                      <a class="code" href="group__PkgMesh__3Parameters.html#ga5714d10decd9eecd30997572b785e03b">no_perturb</a>(),</div><div class="line">                                      <a class="code" href="group__PkgMesh__3Parameters.html#ga16694b09a2acc8ab3f26b7d57633ccb0">exude</a>(time_limit=10, sliver_bound=10));</div><div class="line">  </div><div class="line">  <span class="comment">// Mesh generation and optimization in several call</span></div><div class="line">  C3t3 c3t3_bis = CGAL::make_mesh_3&lt;C3t3&gt;(domain, criteria,</div><div class="line">                                          <a class="code" href="group__PkgMesh__3Parameters.html#ga5714d10decd9eecd30997572b785e03b">no_perturb</a>(), <a class="code" href="group__PkgMesh__3Parameters.html#ga0b79c473082a4ec2a45ed1497f3ac873">no_exude</a>());</div><div class="line">  </div><div class="line">  <a class="code" href="group__PkgMesh__3Functions.html#gaa3a279f64022f2bc51935f946dd8a50e">CGAL::lloyd_optimize_mesh_3</a>(c3t3_bis, domain, time_limit=30);</div><div class="line">  <a class="code" href="group__PkgMesh__3Functions.html#gabf09a95838226da018a742a631824af9">CGAL::exude_mesh_3</a>(c3t3_bis, sliver_bound=10, time_limit=10);</div><div class="line">  </div><div class="line">  <span class="comment">// Output</span></div><div class="line">  std::ofstream medit_file(<span class="stringliteral">"out.mesh"</span>);</div><div class="line">  c3t3.output_to_medit(medit_file);</div><div class="line">  </div><div class="line">  std::ofstream medit_file_bis(<span class="stringliteral">"out_bis.mesh"</span>);</div><div class="line">  c3t3_bis.output_to_medit(medit_file_bis);</div><div class="line"></div><div class="line">  <span class="keywordflow">return</span> 0;</div><div class="line">}</div></div><!-- fragment --><h1><a class="anchor" id="Mesh_3Performances"></a>
Performance</h1>
<p>We provide here some benchmarks of the performance of the mesh generation algorithms.</p>
<h2><a class="anchor" id="Mesh_3DelaunayRefinement_1"></a>
Delaunay Refinement</h2>
<p>The computer used for benchmarking is a PC running Linux64 with two Intel Xeon CPU X5450 clocked at 3.00 GHz with 32GB of RAM. The program has been compiled with g++ v4.3.2 with the -O3 option. These benchmarks have been done using <span style="font-variant: small-caps;">CGAL</span> v3.8. Note that these benchmarks were obtained with the sequential version of the algorithm, which does not take advantage of multi-core architectures. See the next section for performance of parallel algorithms.</p>
<p>We study the refinement part of the mesh generation engine in this section. We give the CPU time (measured by <code><a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/Miscellany.tag:../Miscellany/" href="../Miscellany/classCGAL_1_1Timer.html">Timer</a></code>) using the 3 provided oracles. In all experiments, we produce well shaped elements: we set the facet angle bound and the radius edge bound to their theoretical limit (resp. 30 degrees and 2). We also use the same uniform sizing field for facets and cells.</p>
<h3><a class="anchor" id="Mesh_3ImplicitFunction"></a>
Implicit Function</h3>
<p>We mesh an analytical sphere of radius 1.</p>
<center> <table cellspacing="5">
<tr>
<td align="LEFT" colspan="6"><hr />
 </td></tr>
<tr>
<td align="LEFT">Size bound </td><td align="LEFT">vertices nb </td><td align="LEFT">facets nb </td><td align="LEFT">tetrahedra nb </td><td align="CENTER">CPU Time (s) </td><td align="CENTER">vertices/second </td></tr>
<tr>
<td align="LEFT" colspan="6"><hr />
 </td></tr>
<tr>
<td align="LEFT">0.2 </td><td align="LEFT">499 </td><td align="LEFT">488 </td><td align="LEFT">2,299 </td><td align="CENTER">0.0240 </td><td align="CENTER">20,800 </td></tr>
<tr>
<td align="LEFT">0.1 </td><td align="LEFT">3,480 </td><td align="LEFT">2,046 </td><td align="LEFT">18,756 </td><td align="CENTER">0.146 </td><td align="CENTER">23,800 </td></tr>
<tr>
<td align="LEFT">0.05 </td><td align="LEFT">25,556 </td><td align="LEFT">8,274 </td><td align="LEFT">149,703 </td><td align="CENTER">1.50 </td><td align="CENTER">17,000 </td></tr>
<tr>
<td align="LEFT">0.025 </td><td align="LEFT">195,506 </td><td align="LEFT">33,212 </td><td align="LEFT">1,194,727 </td><td align="CENTER">17.4 </td><td align="CENTER">11,200 </td></tr>
<tr>
<td align="LEFT">0.0125 </td><td align="LEFT">1,528,636 </td><td align="LEFT">134,810 </td><td align="LEFT">9,547,772 </td><td align="CENTER">179 </td><td align="CENTER">8,530 </td></tr>
<tr>
<td align="LEFT" colspan="6"><hr />
 </td></tr>
</table>
</center><center></center><h3><a class="anchor" id="Mesh_3PolyhedralDomain"></a>
Polyhedral Domain</h3>
<p><a class="anchor" id="fig__figuremesh_3_benchmark_polyhedral"></a></p><div class="image">
<img src="bench_polyhedral.jpg" alt="bench_polyhedral.jpg" />
</div>
   <div class="cgal_figure_caption">  <a class="el" href="index.html#fig__figuremesh_3_benchmark_polyhedral">Figure 55.21</a> View of polyhedral mesh generation result (size = 0.005).  </div>  <br />

<p>We mesh a volume bounded by a closed triangulated surface made of about 50,000 vertices and 100,000 triangles. <a class="el" href="index.html#fig__figuremesh_3_benchmark_polyhedral">Figure 55.21</a> shows the mesh obtained when size is set to 0.005.</p>
<center> <table cellspacing="5">
<tr>
<td align="LEFT" colspan="6"><hr />
 </td></tr>
<tr>
<td align="LEFT">Size bound </td><td align="LEFT">vertices nb </td><td align="LEFT">facets nb </td><td align="LEFT">tetrahedra nb </td><td align="CENTER">CPU Time (s) </td><td align="CENTER">vertices/second </td></tr>
<tr>
<td align="LEFT" colspan="6"><hr />
 </td></tr>
<tr>
<td align="LEFT">0.04 </td><td align="LEFT">423 </td><td align="LEFT">717 </td><td align="LEFT">1,332 </td><td align="CENTER">0.488 </td><td align="CENTER">866 </td></tr>
<tr>
<td align="LEFT">0.02 </td><td align="LEFT">2,638 </td><td align="LEFT">3,414 </td><td align="LEFT">10,957 </td><td align="CENTER">2.64 </td><td align="CENTER">998 </td></tr>
<tr>
<td align="LEFT">0.01 </td><td align="LEFT">18,168 </td><td align="LEFT">15,576 </td><td align="LEFT">90,338 </td><td align="CENTER">13.9 </td><td align="CENTER">1,310 </td></tr>
<tr>
<td align="LEFT">0.005 </td><td align="LEFT">129,442 </td><td align="LEFT">64,645 </td><td align="LEFT">722,018 </td><td align="CENTER">66.7 </td><td align="CENTER">1,940 </td></tr>
<tr>
<td align="LEFT">0.0025 </td><td align="LEFT">967,402 </td><td align="LEFT">263,720 </td><td align="LEFT">5,756,491 </td><td align="CENTER">348 </td><td align="CENTER">2,780 </td></tr>
<tr>
<td align="LEFT" colspan="6"><hr />
 </td></tr>
</table>
</center><center></center><h3><a class="anchor" id="Mesh_33DImage"></a>
3D Image</h3>
<p><a class="anchor" id="fig__figuremesh_3_benchmark_3d_image"></a></p><div class="image">
<img src="bench_3d.jpg" alt="bench_3d.jpg" />
</div>
   <div class="cgal_figure_caption">  <a class="el" href="index.html#fig__figuremesh_3_benchmark_3d_image">Figure 55.22</a> View of 3d image mesh generation result (size = 4).  </div>  <br />

<p>We mesh image number 2 from the 3D-IRCADb-01 (available at <a href="http://www.ircad.fr/softwares/3Dircadb/3Dircadb1/index.php">http://www.ircad.fr/softwares/3Dircadb/3Dircadb1/index.php</a>) public database. The size of this image is 512x512x172 voxels (about 45M voxels). The size of the voxels is 0.78mm x 0.78mm x 1.6mm. <a class="el" href="index.html#fig__figuremesh_3_benchmark_3d_image">Figure 55.22</a> shows the mesh obtained for size set to 4.</p>
<center> <table cellspacing="5">
<tr>
<td align="LEFT" colspan="6"><hr />
 </td></tr>
<tr>
<td align="LEFT">Size bound (mm) </td><td align="LEFT">vertices nb </td><td align="LEFT">facets nb </td><td align="LEFT">tetrahedra nb </td><td align="CENTER">CPU Time (s) </td><td align="CENTER">vertices/second </td></tr>
<tr>
<td align="LEFT" colspan="6"><hr />
 </td></tr>
<tr>
<td align="LEFT">16 </td><td align="LEFT">3,898 </td><td align="LEFT">4,099 </td><td align="LEFT">20,692 </td><td align="CENTER">0.344 </td><td align="CENTER">11,300 </td></tr>
<tr>
<td align="LEFT">8 </td><td align="LEFT">34,117 </td><td align="LEFT">27,792 </td><td align="LEFT">199,864 </td><td align="CENTER">3.09 </td><td align="CENTER">11,000 </td></tr>
<tr>
<td align="LEFT">4 </td><td align="LEFT">206,566 </td><td align="LEFT">86,180 </td><td align="LEFT">1,253,694 </td><td align="CENTER">22.4 </td><td align="CENTER">9,230 </td></tr>
<tr>
<td align="LEFT">2 </td><td align="LEFT">1,546,196 </td><td align="LEFT">329,758 </td><td align="LEFT">9,617,278 </td><td align="CENTER">199 </td><td align="CENTER">7,780 </td></tr>
<tr>
<td align="LEFT" colspan="6"><hr />
 </td></tr>
</table>
</center><center></center><h2><a class="anchor" id="Mesh_3Parallel_performance_1"></a>
Parallel Performance</h2>
<p>We provide below speed-up charts generated using the parallel version of the meshing algorithms of <span style="font-variant: small-caps;">CGAL</span> 4.5. The machine used is a PC running Windows 7 64-bits with two 6-core Intel Xeon CPU X5660 clocked at 2.80 GHz with 32GB of RAM. The program has been compiled with Microsoft Visual C++ 2012 in Release mode.</p>
<p>Figure <a class="el" href="index.html#fig__figure_refinement_speedup">Figure 55.23</a> shows mesh refinement speed-up, and figure <a class="el" href="index.html#fig__figure_lloyd_speedup">Figure 55.24</a> shows Lloyd optimization speed-up. ODT optimization exhibits similar speed-up.</p>
<p><a class="anchor" id="fig__figure_refinement_speedup"></a></p><div class="image">
<img src="refinement_speedup.png" alt="refinement_speedup.png" />
</div>
   <div class="cgal_figure_caption">  <a class="el" href="index.html#fig__figure_refinement_speedup">Figure 55.23</a> Facet refinement speed-up (left) and cell refinement speed-up (right), compared to the sequential version of the algorithm.  </div>  <br />

<p><a class="anchor" id="fig__figure_lloyd_speedup"></a></p><div class="image">
<img src="lloyd_speedup.png" alt="lloyd_speedup.png" />
</div>
   <div class="cgal_figure_caption">  <a class="el" href="index.html#fig__figure_lloyd_speedup">Figure 55.24</a> Lloyd optimization speed-up, compared to the sequential version of the algorithm. Parallel ODT exhibits similar performance.  </div>  <br />

<h1><a class="anchor" id="Mesh_3DesignAndImpl"></a>
Design and Implementation History</h1>
<h2><a class="anchor" id="Mesh_3TheoreticalFoundations"></a>
Theoretical Foundations</h2>
<p>The <span style="font-variant: small-caps;">CGAL</span> mesh generation package implements a meshing engine based on the method of Delaunay refinement introduced by Chew <a class="el" href="citelist.html#CITEREF_c-gqmgc-93">[9]</a> and Ruppert <a class="el" href="citelist.html#CITEREF_r-draq2d-95">[15]</a> and pioneered in 3D by Shewchuk <a class="el" href="citelist.html#CITEREF_s-tmgdr-98">[16]</a>. It uses the notion of restricted Delaunay triangulation to approximate 1-dimensional curved features and curved surface patches and rely on the work of Boissonnat and Oudot <a class="el" href="citelist.html#CITEREF_cgal:bo-pgsms-05">[2]</a> and Oudot et al. <a class="el" href="citelist.html#CITEREF_cgal:ory-mvbss-05">[13]</a> to achieve accurate representation of boundary and subdividing surfaces in the mesh. The mechanism of protecting balls, used to ensure a fair representation of 1-dimensional features, if any, and the termination of the refinement process whatever may be the input geometry, in particular whatever small dihedral angles may form the boundary and subdivision surface patches, was pioneered by Cheng et al. <a class="el" href="citelist.html#CITEREF_cgal:cdr-drpsc-07">[8]</a> and further experimented by Dey, Levine et al. <a class="el" href="citelist.html#CITEREF_cgal:cdl-pdma-07">[7]</a>. The optimization phase involves global optimization processes, a perturbation process and a sliver exudation process. The global optimizers are based on Lloyd smoothing <a class="el" href="citelist.html#CITEREF_cgal:dfg-cvtaa-99t">[11]</a>, <a class="el" href="citelist.html#CITEREF_cgal:dw-tmgob-02">[10]</a> and odt smoothing <a class="el" href="citelist.html#CITEREF_cgal::c-mssbo-04">[5]</a>, <a class="el" href="citelist.html#CITEREF_cgal:acyd-vtm-05">[1]</a>, where odt means <em>optimal Delaunay triangulation</em>. The perturbation process is mainly based on the work of Tournois <a class="el" href="citelist.html#CITEREF_cgal:t-om-09">[19]</a> and Tournois et al. <a class="el" href="citelist.html#CITEREF_cgal:twad-iropitmg-09">[18]</a>, while the exudation process is, the now famous, optimization by weighting described in Edelsbrunner et al. <a class="el" href="citelist.html#CITEREF_cgal:cdeft-slive-00">[6]</a>.</p>
<h2><a class="anchor" id="Mesh_3ImplementationHistory"></a>
Implementation History</h2>
<p>Work on the package <code>Mesh_3</code> started during the PhD thesis of Laurent Rineau advised by Mariette Yvinec. A code prototype, together with a first version of design and specifications <a class="el" href="citelist.html#CITEREF_cgal:ry-gsddrm-06">[14]</a> came out of their collaboration.</p>
<p>From the beginning of 2009, most of the work has been performed by Stéphane Tayeb, in collaboration with Mariette Yvinec, Laurent Rineau, Pierre Alliez and Jane Tournois. First, Stéphane released the first public version of the package, implementing the specifications written by Laurent and Mariette.</p>
<p>The optimization processes are heavily based on the work of Jane Tournois and Pierre Alliez during the PhD of Jane advised by Pierre. The optimization phase was imported in the mesh generation package by Stéphane Tayeb and appeared first in release 3.6 of <span style="font-variant: small-caps;">CGAL</span>.</p>
<p>In collaboration with Laurent Rineau, Stéphane also added demos and examples. After some experiments on medical imaging data performed by Dobrina Boltcheva et al. <a class="el" href="citelist.html#CITEREF_cgal:byb-mgmmi-09">[4]</a>, <a class="el" href="citelist.html#CITEREF_cgal:-byb-fpdmgmmi-09">[3]</a>, the handling of 1-dimensional features was worked out by Laurent Rineau, Stéphane Tayeb and Mariette Yvinec. It appeared first in the release 3.8 of <span style="font-variant: small-caps;">CGAL</span>.</p>
<p>In 2013, Clément Jamin made the meshing and optimization algorithms parallel on multi-core shared-memory architectures.  </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<!-- The footer div is not part of the default but we require it to
move the footer to the bottom of the page. -->
<div id="footer">
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Mon Oct 1 2018 11:58:51 for CGAL 4.13 - 3D Mesh Generation by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen" /></a> 1.8.13 </li>
  </ul>
</div>
</div>
</body>


</html>
