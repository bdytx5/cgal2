<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="canonical" href="https://doc.cgal.org/latest/Manual/devman_memory_management.html"/>

<link rel="icon" type="image/png" href="../Manual/g-196x196-doc.png" />
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8" />
<meta http-equiv="X-UA-Compatible" content="IE=9" />
<meta name="generator" content="Doxygen 1.8.13" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>CGAL 4.13 - Manual: Memory Management</title>
<!-- <link href="../Manual/tabs.css" rel="stylesheet" type="text/css"/> -->
<script type="text/javascript" src="../Manual/jquery.js"></script>
<script type="text/javascript" src="../Manual/dynsections.js"></script>
<script src="../Manual/hacks.js" type="text/javascript"></script>
<link href="navtree.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js"></script>
<link href="stylesheet.css" rel="stylesheet" type="text/css" />
<!-- This should probably be an extrastylesheet instead of hardcoded. -->
<link href="../Manual/cgal_stylesheet.css" rel="stylesheet" type="text/css" />
</head>
<body>
<!-- Custom mathjax -->
<!-- TODO: Remove this with MATHJAX_CODEFILE -->
<span style="display:none">\( \newcommand{\E}{\mathrm{E}} \) \( \newcommand{\A}{\mathrm{A}} \)
\( \newcommand{\R}{\mathrm{R}} \) \( \newcommand{\N}{\mathrm{N}} \) \( \newcommand{\Q}{\mathrm{Q}} \) \( \newcommand{\Z}{\mathrm{Z}} \)
\(
\def\ccSum #1#2#3{
  \sum_{#1}^{#2}{#3}
}
\def\ccProd #1#2#3{
  \sum_{#1}^{#2}{#3}
}\)
</span>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="back-nav">
  <ul>
    <li><a href="https://www.cgal.org/">cgal.org</a></li>
    <li><a href="../Manual/index.html">Top</a></li>
    <li><a href="../Manual/general_intro.html">Getting Started</a></li>
    <li><a href="../Manual/tutorials.html">Tutorials</a></li>
    <li><a href="../Manual/packages.html">Package Overview</a></li>
    <li><a href="../Manual/how_to_cite_cgal.html">Acknowledging CGAL</a></li>
  </ul>
          <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png" onmouseover="return searchBox.OnSearchSelectShow()" onmouseout="return searchBox.OnSearchSelectHide()" alt="" />
          <input type="text" id="MSearchField" value="Search" accesskey="S" onfocus="searchBox.OnSearchFieldFocus(true)" onblur="searchBox.OnSearchFieldFocus(false)" onkeyup="searchBox.OnSearchFieldChange(event)" />
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt="" /></a>
          </span>
        </div>
</div>
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">CGAL 4.13 - Manual
   </div>
  </td>
  <!-- We disable the search box because we have added it in the
  back-nav for stylistic reasons. -->
  <!-- <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td> -->
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync" style="display: none"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('devman_memory_management.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow" onmouseover="return searchBox.OnSearchSelectShow()" onmouseout="return searchBox.OnSearchSelectHide()" onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Memory Management </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><dl class="section author"><dt>Authors</dt><dd>Michael Seel (<code><a href="#" onclick="location.href='mai'+'lto:'+'see'+'l@'+'mpi'+'-s'+'b.m'+'pg'+'.de'; return false;">seel@<span style="display: none;">.nosp@m.</span>mpi-<span style="display: none;">.nosp@m.</span>sb.mp<span style="display: none;">.nosp@m.</span>g.de</a></code>) </dd>
<dd>
Efi Fogel (<code><a href="#" onclick="location.href='mai'+'lto:'+'efi'+'f@'+'pos'+'t.'+'tau'+'.a'+'c.i'+'l'; return false;">efif@<span style="display: none;">.nosp@m.</span>post<span style="display: none;">.nosp@m.</span>.tau.<span style="display: none;">.nosp@m.</span>ac.i<span style="display: none;">.nosp@m.</span>l</a></code>)</dd></dl>
<p>One of the design goals of <span style="font-variant: small-caps;">CGAL</span> (Section <a class="el" href="devman_intro.html#secdesign_goals">Primary design goals</a> ) is efficiency, and this means not only implementing efficient algorithms but also implementing them efficiently. One way to improve the efficiency of an implementation is through efficient memory management. This can be done by making the library data structures independent of the underlying memory model. However, to avoid unacceptable efficiency degradations complete abstraction of the memory model should be avoided. Here we describe one way to address this using allocators. An allocator encapsulates the information about an allocation model.</p>
<p>We adopted the definition of the Standard <span style="font-variant: small-caps;">C++</span> allocator <a class="el" href="citelist.html#CITEREF_cgal:ansi-is14882-98">[3]</a>. The <code>std::allocator</code> is the only predefined and required allocator imposed by [<span style="font-variant: small-caps;">C++</span>] on all <span style="font-variant: small-caps;">C++</span> compiler implementations. The exact specification can also be found at <a href="http://en.wikipedia.org/wiki/Allocator_(C++)"><code>http://en.wikipedia.org/wiki/Allocator_(C++)</code></a>.</p>
<p>Objects of type <code>std::allocator&lt;T&gt;</code> can be used to obtain small, typed chunks of memory to be used, for example, as static members of a class. This is especially interesting with classes of a constant size that are frequently allocated and deallocated (e.g., points, lines, circles), since a memory allocator can maintain the corresponding memory chunks in local blocks and thus can answer allocation and deallocation calls much faster than the corresponding system calls.</p>
<h1><a class="anchor" id="secallocator_macro"></a>
The allocator macro</h1>
<p>The macro <code><a class="elRef" doxygen="/home/cgal-testsuite/cgal_doc_build/CGAL-4.13-I-128/doc/scripts/doc_1_8_13/doc_tags/STL_Extension.tag:../STL_Extension/" href="../STL_Extension/group__PkgStlExtension.html#ga859086d0e8d189c8c967229e024e5e82">CGAL_ALLOCATOR(T)</a></code> is defined as <code>std::allocator&lt;T&gt;</code> in the file <code>&lt;CGAL/memory.h&gt;</code>. <code>CGAL_ALLOCATOR</code> is used as the default allocator for all <span style="font-variant: small-caps;">CGAL</span> components. You can redefine it, for example, if <span style="font-variant: small-caps;">LEDA</span> is present, you can define it (before including any <span style="font-variant: small-caps;">CGAL</span> header file) as follows:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;LEDA/allocator.h&gt;</span></div><div class="line"><span class="preprocessor">#define CGAL_ALLOCATOR(t) leda_allocator&lt;t&gt;</span></div></div><!-- fragment --><h1><a class="anchor" id="secusing_memory_allocator"></a>
Using the allocator</h1>
<p>How should a data structure use the allocator mechanism? Just make the allocator one of the template arguments of the data structure. Then use a static member object to allocate items on the heap that you want to keep optimized regarding allocation and deallocation. We show an example using a trivial list structure:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;CGAL/memory.h&gt;</span></div><div class="line"></div><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; </div><div class="line"><span class="keyword">class </span>dlink </div><div class="line">{ T some_member; };</div><div class="line"></div><div class="line"><span class="keyword">template</span> &lt; <span class="keyword">typename</span> T, <span class="keyword">typename</span> Alloc = CGAL_ALLOCATOR(dlink&lt;T&gt;) &gt;</div><div class="line"><span class="keyword">class </span>list </div><div class="line">{</div><div class="line"><span class="keyword">public</span>:</div><div class="line">  <span class="keyword">typedef</span> dlink&lt;T&gt;* dlink_ptr;</div><div class="line">  <span class="keyword">typedef</span> Alloc list_allocator;</div><div class="line"></div><div class="line">  <span class="keyword">static</span> list_allocator M;</div><div class="line"></div><div class="line">list() {</div><div class="line">  p = M.allocate(1);          <span class="comment">// allocation of space for one dlink</span></div><div class="line">  M.construct(p,dlink&lt;T&gt;());  <span class="comment">// inplace construction of object</span></div><div class="line">}</div><div class="line"></div><div class="line">~list() {</div><div class="line">  M.destroy(p);      <span class="comment">// destroy object</span></div><div class="line">  M.deallocate(p,1); <span class="comment">// deallocate memory</span></div><div class="line">}</div><div class="line"></div><div class="line"><span class="keyword">private</span>:</div><div class="line">  dlink_ptr p;</div><div class="line">};</div><div class="line"></div><div class="line"><span class="comment">// init static member allocator object:</span></div><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span> Alloc&gt;</div><div class="line"><span class="keyword">typename</span> list&lt;T,Alloc&gt;::list_allocator list&lt;T,Alloc&gt;::M =</div><div class="line">             <span class="keyword">typename</span> list&lt;T,Alloc&gt;::list_allocator();</div><div class="line"></div><div class="line"><span class="keywordtype">int</span> main()</div><div class="line">{</div><div class="line">  list&lt;int&gt; L;</div><div class="line">  <span class="keywordflow">return</span> 0;</div><div class="line">}</div></div><!-- fragment --><h1><a class="anchor" id="secmemory_req_and_rec"></a>
Requirements and recommendations</h1>
<p>Recommendations: </p><ul>
<li>
Use an allocator template parameter (which defaults to <code>CGAL_ALLOCATOR</code>) for data structures for which an optimization with regard to allocation and deallocation is beneficial. </li>
</ul>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<!-- The footer div is not part of the default but we require it to
move the footer to the bottom of the page. -->
<div id="footer">
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Mon Oct 1 2018 11:58:49 for CGAL 4.13 - Manual by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen" /></a> 1.8.13 </li>
  </ul>
</div>
</div>
</body>

</html>
